[
  {
    "qid": "Problemone",
    "subid": null,
    "subquestion": "A single die is tossed; then n coins are tossed where n is the number shown on the die. Show that the probability of exactly two heads is close to 0.2578.",
    "full_question": "A single die is tossed; then n coins are tossed where n is the number shown on the die. Show that the probability of exactly two heads is close to 0.2578.",
    "steps": [
      {
        "step": 1,
        "desc": "Calculate the probability of rolling each number on a die",
        "expr": "P(die = k) = 1/6 for k = 1, 2, 3, 4, 5, 6",
        "value": "1/6"
      },
      {
        "step": 2,
        "desc": "Calculate the probability of getting exactly 2 heads when n = 2",
        "expr": "P(2 heads | n = 2) = C(2, 2) * (1/2)^2 * (1/2)^0",
        "value": "1/4"
      },
      {
        "step": 3,
        "desc": "Calculate the probability of getting exactly 2 heads when n = 3",
        "expr": "P(2 heads | n = 3) = C(3, 2) * (1/2)^2 * (1/2)^1",
        "value": "3/8"
      },
      {
        "step": 4,
        "desc": "Calculate the probability of getting exactly 2 heads when n = 4",
        "expr": "P(2 heads | n = 4) = C(4, 2) * (1/2)^2 * (1/2)^2",
        "value": "3/8"
      },
      {
        "step": 5,
        "desc": "Calculate the probability of getting exactly 2 heads when n = 5",
        "expr": "P(2 heads | n = 5) = C(5, 2) * (1/2)^2 * (1/2)^3",
        "value": "5/16"
      },
      {
        "step": 6,
        "desc": "Calculate the probability of getting exactly 2 heads when n = 6",
        "expr": "P(2 heads | n = 6) = C(6, 2) * (1/2)^2 * (1/2)^4",
        "value": "15/64"
      },
      {
        "step": 7,
        "desc": "Calculate the total probability of getting exactly 2 heads",
        "expr": "P(2 heads) = sum(P(2 heads | n = k) * P(die = k) for k = 2 to 6)",
        "value": "1/6 * (1/4 + 3/8 + 3/8 + 5/16 + 15/64)"
      },
      {
        "step": 8,
        "desc": "Compute the final probability",
        "expr": "P(2 heads) = 1/6 * (16/64 + 24/64 + 24/64 + 20/64 + 15/64)",
        "value": "1/6 * 99/64"
      },
      {
        "step": "final",
        "desc": "Compute the final probability",
        "expr": "P(2 heads) = 99/384",
        "value": "0.2578125"
      }
    ]
  },
  {
    "qid": "Problemtwo",
    "subid": "1",
    "subquestion": "Verify that F_X(x) = 1 - 1/x² (x ≥ 1) is a valid cumulative distribution function.",
    "full_question": "A certain river floods every year. Suppose that the low-water mark is set at 1 and the high-water mark X has a distribution function:\n\n    F_X(x) = P(X ≤ x) = 1 - 1/x²,    for 1 ≤ x < ∞.\n\n1. Verify that F_X(x) is a cumulative distribution function.\n2. Find the density f_X(x) (specify it on the whole real axis).\n3. If the (same) low-water mark is reset at 0 and we use a unit of measurement that is 1/10 of that used previously, express the random variable Z for the new measurement as a function of X. Then find precisely the cumulative distribution function and the density of Z.",
    "steps": [
      {
        "step": 1,
        "desc": "Check if F_X(x) is non-decreasing for x ≥ 1",
        "expr": "F_X'(x) = d/dx (1 - 1/x²)",
        "value": "2/x³"
      },
      {
        "step": 2,
        "desc": "Evaluate the derivative to ensure it's non-negative for x ≥ 1",
        "expr": "2/x³ ≥ 0 for x ≥ 1",
        "value": true
      },
      {
        "step": 3,
        "desc": "Check if F_X(x) approaches 0 as x approaches 1 from the right",
        "expr": "lim (x -> 1+) F_X(x)",
        "value": 0
      },
      {
        "step": 4,
        "desc": "Check if F_X(x) approaches 1 as x approaches infinity",
        "expr": "lim (x -> ∞) F_X(x)",
        "value": 1
      },
      {
        "step": 5,
        "desc": "Verify F_X(x) is right-continuous",
        "expr": "F_X(x) is continuous for x ≥ 1",
        "value": true
      },
      {
        "step": "final",
        "desc": "Conclude F_X(x) is a valid cumulative distribution function",
        "expr": "F_X(x) is valid",
        "value": true
      }
    ]
  },
  {
    "qid": "Problemtwo",
    "subid": "2",
    "subquestion": "Find the probability density function f_X(x), and specify it on the entire real axis.",
    "full_question": "A certain river floods every year. Suppose that the low-water mark is set at 1 and the high-water mark X has a distribution function:\n\n    F_X(x) = P(X ≤ x) = 1 - 1/x²,    for 1 ≤ x < ∞.\n\n1. Verify that F_X(x) is a cumulative distribution function.\n2. Find the density f_X(x) (specify it on the whole real axis).\n3. If the (same) low-water mark is reset at 0 and we use a unit of measurement that is 1/10 of that used previously, express the random variable Z for the new measurement as a function of X. Then find precisely the cumulative distribution function and the density of Z.",
    "steps": [
      {
        "step": 1,
        "desc": "Differentiate the cumulative distribution function F_X(x) to find the probability density function f_X(x).",
        "expr": "f_X(x) = d/dx [1 - 1/x^2]",
        "value": null
      },
      {
        "step": 2,
        "desc": "Compute the derivative of F_X(x) with respect to x.",
        "expr": "f_X(x) = 0 + 2/x^3",
        "value": "2/x^3"
      },
      {
        "step": 3,
        "desc": "Specify the probability density function f_X(x) on the entire real axis.",
        "expr": "f_X(x) = 2/x^3 for x >= 1; f_X(x) = 0 otherwise",
        "value": null
      },
      {
        "step": "final",
        "desc": "The probability density function f_X(x) is specified on the entire real axis.",
        "expr": "f_X(x) = 2/x^3 for x >= 1; f_X(x) = 0 for x < 1",
        "value": null
      }
    ]
  },
  {
    "qid": "Problemtwo",
    "subid": "3",
    "subquestion": "Let the low-water mark be reset to 0, and define Z = 10(X - 1). Find the CDF and PDF of Z.",
    "full_question": "A certain river floods every year. Suppose that the low-water mark is set at 1 and the high-water mark X has a distribution function:\n\n    F_X(x) = P(X ≤ x) = 1 - 1/x²,    for 1 ≤ x < ∞.\n\n1. Verify that F_X(x) is a cumulative distribution function.\n2. Find the density f_X(x) (specify it on the whole real axis).\n3. If the (same) low-water mark is reset at 0 and we use a unit of measurement that is 1/10 of that used previously, express the random variable Z for the new measurement as a function of X. Then find precisely the cumulative distribution function and the density of Z.",
    "steps": [
      {
        "step": 1,
        "desc": "Define the transformation from X to Z",
        "expr": "Z = 10(X - 1)",
        "value": null
      },
      {
        "step": 2,
        "desc": "Express X in terms of Z",
        "expr": "X = Z/10 + 1",
        "value": null
      },
      {
        "step": 3,
        "desc": "Find the CDF of Z using the transformation",
        "expr": "F_Z(z) = P(Z ≤ z) = P(10(X - 1) ≤ z)",
        "value": null
      },
      {
        "step": 4,
        "desc": "Substitute X in terms of Z",
        "expr": "P(10(X - 1) ≤ z) = P(X ≤ z/10 + 1)",
        "value": null
      },
      {
        "step": 5,
        "desc": "Use the CDF of X to find F_Z(z)",
        "expr": "F_Z(z) = F_X(z/10 + 1) = 1 - 1/(z/10 + 1)^2",
        "value": null
      },
      {
        "step": 6,
        "desc": "Simplify the expression for F_Z(z)",
        "expr": "F_Z(z) = 1 - 100/(z + 10)^2",
        "value": null
      },
      {
        "step": 7,
        "desc": "Find the PDF of Z by differentiating F_Z(z)",
        "expr": "f_Z(z) = d/dz [F_Z(z)]",
        "value": null
      },
      {
        "step": 8,
        "desc": "Differentiate F_Z(z) to find f_Z(z)",
        "expr": "f_Z(z) = 200/(z + 10)^3",
        "value": null
      },
      {
        "step": "final",
        "desc": "CDF and PDF of Z",
        "expr": "F_Z(z) = 1 - 100/(z + 10)^2, f_Z(z) = 200/(z + 10)^3",
        "value": null
      }
    ]
  },
  {
    "qid": "Problemthree",
    "subid": "a",
    "subquestion": "Find the posterior distribution for θ given prior Gamma(α, β) and i.i.d. Poisson(θ) data.",
    "full_question": "Suppose X = (X₁, ..., Xₙ) are i.i.d. Poisson(θ) with a probability mass function:\n    f(x; θ) = (e^{-θ} θ^x) / x!,    x ∈ {0,1,2,...},    θ > 0.\n\nThe prior on the unknown parameter θ is assumed to be Gamma(α, β) with density:\n    τ(θ) = (1 / (Γ(α) β^α)) * θ^{α−1} * e^{-θ/β},    with α, β > 0 and θ > 0.\n\na) Find the posterior distribution for θ.\nb) Hence or otherwise determine the Bayes estimator of θ with respect to the quadratic loss L(a, θ) = (a − θ)².\nc) Suppose the following ten observations were observed: 4, 0, 1, 0, 0, 2, 3, 1, 1, 0.\n   Using a zero-one loss with α = 2 and β = 1 for the prior, what is your decision when testing H₀: θ ≤ 1.2 vs H₁: θ > 1.2. (You may use the integrate function in R or another numerical integration routine to answer the question.)",
    "steps": [
      {
        "step": 1,
        "desc": "Write the likelihood function for the Poisson data",
        "expr": "L(θ; X) = Π (e^{-θ} θ^{X_i}) / X_i!",
        "value": null
      },
      {
        "step": 2,
        "desc": "Simplify the likelihood function",
        "expr": "L(θ; X) = e^{-nθ} θ^{ΣX_i} / Π X_i!",
        "value": null
      },
      {
        "step": 3,
        "desc": "Write the prior distribution for θ",
        "expr": "τ(θ) = (1 / (Γ(α) β^α)) * θ^{α−1} * e^{-θ/β}",
        "value": null
      },
      {
        "step": 4,
        "desc": "Write the unnormalized posterior distribution using Bayes' theorem",
        "expr": "π(θ | X) ∝ L(θ; X) * τ(θ)",
        "value": null
      },
      {
        "step": 5,
        "desc": "Substitute the expressions for L(θ; X) and τ(θ)",
        "expr": "π(θ | X) ∝ (e^{-nθ} θ^{ΣX_i} / Π X_i!) * (1 / (Γ(α) β^α)) * θ^{α−1} * e^{-θ/β)",
        "value": null
      },
      {
        "step": 6,
        "desc": "Combine the terms in the expression",
        "expr": "π(θ | X) ∝ θ^{ΣX_i + α - 1} * e^{-θ(n + 1/β)}",
        "value": null
      },
      {
        "step": 7,
        "desc": "Identify the form of the posterior distribution",
        "expr": "π(θ | X) is Gamma(ΣX_i + α, 1 / (n + 1/β))",
        "value": null
      },
      {
        "step": "final",
        "desc": "The posterior distribution for θ is a Gamma distribution",
        "expr": "Gamma(ΣX_i + α, 1 / (n + 1/β))",
        "value": null
      }
    ]
  },
  {
    "qid": "Problemthree",
    "subid": "b",
    "subquestion": "Determine the Bayes estimator of θ under quadratic loss L(a, θ) = (a − θ)².",
    "full_question": "Suppose X = (X₁, ..., Xₙ) are i.i.d. Poisson(θ) with a probability mass function:\n    f(x; θ) = (e^{-θ} θ^x) / x!,    x ∈ {0,1,2,...},    θ > 0.\n\nThe prior on the unknown parameter θ is assumed to be Gamma(α, β) with density:\n    τ(θ) = (1 / (Γ(α) β^α)) * θ^{α−1} * e^{-θ/β},    with α, β > 0 and θ > 0.\n\na) Find the posterior distribution for θ.\nb) Hence or otherwise determine the Bayes estimator of θ with respect to the quadratic loss L(a, θ) = (a − θ)².\nc) Suppose the following ten observations were observed: 4, 0, 1, 0, 0, 2, 3, 1, 1, 0.\n   Using a zero-one loss with α = 2 and β = 1 for the prior, what is your decision when testing H₀: θ ≤ 1.2 vs H₁: θ > 1.2. (You may use the integrate function in R or another numerical integration routine to answer the question.)",
    "steps": [
      {
        "step": 1,
        "desc": "Identify the form of the posterior distribution",
        "expr": "Posterior ∝ Likelihood * Prior",
        "value": null
      },
      {
        "step": 2,
        "desc": "Write the likelihood function for Poisson data",
        "expr": "L(θ; X) = Π (e^{-θ} θ^{x_i}) / x_i!",
        "value": null
      },
      {
        "step": 3,
        "desc": "Write the prior distribution for θ",
        "expr": "τ(θ) = (1 / (Γ(α) β^α)) * θ^{α−1} * e^{-θ/β}",
        "value": null
      },
      {
        "step": 4,
        "desc": "Combine likelihood and prior to form the posterior",
        "expr": "Posterior ∝ θ^{Σx_i + α - 1} * e^{-θ(n + 1/β)}",
        "value": null
      },
      {
        "step": 5,
        "desc": "Identify the posterior distribution as a Gamma distribution",
        "expr": "Gamma(Σx_i + α, 1 / (n + 1/β))",
        "value": null
      },
      {
        "step": 6,
        "desc": "Determine the Bayes estimator under quadratic loss",
        "expr": "Bayes Estimator = E[θ | X]",
        "value": null
      },
      {
        "step": 7,
        "desc": "Compute the expectation of the posterior Gamma distribution",
        "expr": "E[θ | X] = (Σx_i + α) / (n + 1/β)",
        "value": null
      },
      {
        "step": "final",
        "desc": "Bayes estimator of θ under quadratic loss",
        "expr": "a = (Σx_i + α) / (n + 1/β)",
        "value": null
      }
    ]
  },
  {
    "qid": "Problemthree",
    "subid": "c",
    "subquestion": "Given observations [4,0,1,0,0,2,3,1,1,0] and prior α=2, β=1, test H₀: θ ≤ 1.2 vs H₁: θ > 1.2 using zero-one loss.",
    "full_question": "Suppose X = (X₁, ..., Xₙ) are i.i.d. Poisson(θ) with a probability mass function:\n    f(x; θ) = (e^{-θ} θ^x) / x!,    x ∈ {0,1,2,...},    θ > 0.\n\nThe prior on the unknown parameter θ is assumed to be Gamma(α, β) with density:\n    τ(θ) = (1 / (Γ(α) β^α)) * θ^{α−1} * e^{-θ/β},    with α, β > 0 and θ > 0.\n\na) Find the posterior distribution for θ.\nb) Hence or otherwise determine the Bayes estimator of θ with respect to the quadratic loss L(a, θ) = (a − θ)².\nc) Suppose the following ten observations were observed: 4, 0, 1, 0, 0, 2, 3, 1, 1, 0.\n   Using a zero-one loss with α = 2 and β = 1 for the prior, what is your decision when testing H₀: θ ≤ 1.2 vs H₁: θ > 1.2. (You may use the integrate function in R or another numerical integration routine to answer the question.)",
    "steps": [
      {
        "step": 1,
        "desc": "Calculate the sum of the observed data",
        "expr": "sum([4,0,1,0,0,2,3,1,1,0])",
        "value": 12
      },
      {
        "step": 2,
        "desc": "Calculate the number of observations",
        "expr": "n = 10",
        "value": 10
      },
      {
        "step": 3,
        "desc": "Determine the posterior parameters for the Gamma distribution",
        "expr": "alpha_post = alpha + sum_x, beta_post = 1 / (1/beta + n)",
        "value": {
          "alpha_post": 14,
          "beta_post": 0.09090909090909091
        }
      },
      {
        "step": 4,
        "desc": "Calculate the posterior mean of the Gamma distribution",
        "expr": "posterior_mean = alpha_post * beta_post",
        "value": 1.2727272727272727
      },
      {
        "step": 5,
        "desc": "Calculate the posterior probability P(θ > 1.2)",
        "expr": "1 - pgamma(1.2, shape=alpha_post, scale=beta_post)",
        "value": 0.4513777136758601
      },
      {
        "step": "final",
        "desc": "Make a decision based on zero-one loss",
        "expr": "P(θ > 1.2) > 0.5 ? 'Reject H0' : 'Fail to reject H0'",
        "value": "Fail to reject H0"
      }
    ]
  },
  {
    "qid": "Problemfour",
    "subid": "a",
    "subquestion": "Define a suitable loss function L(θ, a) for action space A = {a₀, a₁} and states Θ = {θ₀, θ₁}.",
    "full_question": "The Premier of NSW has to take an important decision whether or not to include an additional line (extension) to Sydney’s metro system. The decision is based on the financial viability of the extension. He is willing to apply decision theory in making his decision. He uses the independent opinion of two consulting experts. The data he uses is the number X of viability recommendations of the two experts (X = 0, 1 or 2).\n\nIf the Premier does not go ahead and the extension turns out not to be financially viable or if he decides to go ahead and the project is financially viable, nothing is lost. If the project is not financially viable and he has decided to go ahead, his subjective judgement is that his loss would equal three times the loss of not going ahead but the project is financially viable.\n\nThe Premier has investigated the history of viability predictions of the two consulting experts and it is as follows. When a project is financially viable, both experts have correctly predicted its viability with probability 4/5 (and wrongly with 1/5). When a project has not been financially viable, both experts had a prediction of 3/5 for it to be viable. The Premier listens to the recommendations of the two experts and makes his decision based on the value of X.\n\na) There are two possible actions in the action space A = {a₀, a₁} where a₀ is to go ahead and a₁ is not to go ahead. There are two states of nature Θ = {θ₀, θ₁} where θ₀ = 0 represents 'extension is financially viable' and θ₁ = 1 means 'not viable'. Define a suitable loss function L(θ, a).\nb) Compute the probability mass function (pmf) for X under both states of nature.\nc) The complete list of all the non-randomized decisions rules D based on x is given by:\n   x = 0: a₀ a₁ a₀ a₁ a₀ a₁ a₀ a₁\n   x = 1: a₀ a₀ a₁ a₁ a₀ a₀ a₁ a₁\n   x = 2: a₀ a₀ a₀ a₀ a₁ a₁ a₁ a₁\n   (d₁ to d₈)\nd) For each rule in D compute the corresponding risk points.\ne) Find the minimax rule(s) among the non-randomized rules.\nf) Sketch the risk set of all randomized rules D generated by the 8 rules. Use R or any plotting tool.\ng) Find the risk point of the minimax rule in the set of randomized decision rules D. Compare to minimax in D.\nh) Define the minimax rule in D in terms of rules in D.\ni) For which prior on {θ₁, θ₂} is the minimax rule in D also a Bayes rule?\nj) Suppose the Premier’s belief in viability is 50%. Find the Bayes rule and Bayes risk.\nk) For ε = 0.1, find the ε-minimax rules and risk points on the risk set.",
    "steps": [
      {
        "step": 1,
        "desc": "Define the loss when the extension is financially viable (θ₀) and the action is to go ahead (a₀).",
        "expr": "L(θ₀, a₀) = 0",
        "value": 0
      },
      {
        "step": 2,
        "desc": "Define the loss when the extension is financially viable (θ₀) and the action is not to go ahead (a₁).",
        "expr": "L(θ₀, a₁) = 1",
        "value": 1
      },
      {
        "step": 3,
        "desc": "Define the loss when the extension is not financially viable (θ₁) and the action is to go ahead (a₀).",
        "expr": "L(θ₁, a₀) = 3",
        "value": 3
      },
      {
        "step": 4,
        "desc": "Define the loss when the extension is not financially viable (θ₁) and the action is not to go ahead (a₁).",
        "expr": "L(θ₁, a₁) = 0",
        "value": 0
      },
      {
        "step": "final",
        "desc": "Summarize the loss function L(θ, a) for all combinations of θ and a.",
        "expr": "L(θ, a) = [[0, 1], [3, 0]]",
        "value": [
          [
            0,
            1
          ],
          [
            3,
            0
          ]
        ]
      }
    ]
  },
  {
    "qid": "Problemfour",
    "subid": "b",
    "subquestion": "Compute the pmf of X under both θ₀ and θ₁.",
    "full_question": "The Premier of NSW has to take an important decision whether or not to include an additional line (extension) to Sydney’s metro system. The decision is based on the financial viability of the extension. He is willing to apply decision theory in making his decision. He uses the independent opinion of two consulting experts. The data he uses is the number X of viability recommendations of the two experts (X = 0, 1 or 2).\n\nIf the Premier does not go ahead and the extension turns out not to be financially viable or if he decides to go ahead and the project is financially viable, nothing is lost. If the project is not financially viable and he has decided to go ahead, his subjective judgement is that his loss would equal three times the loss of not going ahead but the project is financially viable.\n\nThe Premier has investigated the history of viability predictions of the two consulting experts and it is as follows. When a project is financially viable, both experts have correctly predicted its viability with probability 4/5 (and wrongly with 1/5). When a project has not been financially viable, both experts had a prediction of 3/5 for it to be viable. The Premier listens to the recommendations of the two experts and makes his decision based on the value of X.\n\na) There are two possible actions in the action space A = {a₀, a₁} where a₀ is to go ahead and a₁ is not to go ahead. There are two states of nature Θ = {θ₀, θ₁} where θ₀ = 0 represents 'extension is financially viable' and θ₁ = 1 means 'not viable'. Define a suitable loss function L(θ, a).\nb) Compute the probability mass function (pmf) for X under both states of nature.\nc) The complete list of all the non-randomized decisions rules D based on x is given by:\n   x = 0: a₀ a₁ a₀ a₁ a₀ a₁ a₀ a₁\n   x = 1: a₀ a₀ a₁ a₁ a₀ a₀ a₁ a₁\n   x = 2: a₀ a₀ a₀ a₀ a₁ a₁ a₁ a₁\n   (d₁ to d₈)\nd) For each rule in D compute the corresponding risk points.\ne) Find the minimax rule(s) among the non-randomized rules.\nf) Sketch the risk set of all randomized rules D generated by the 8 rules. Use R or any plotting tool.\ng) Find the risk point of the minimax rule in the set of randomized decision rules D. Compare to minimax in D.\nh) Define the minimax rule in D in terms of rules in D.\ni) For which prior on {θ₁, θ₂} is the minimax rule in D also a Bayes rule?\nj) Suppose the Premier’s belief in viability is 50%. Find the Bayes rule and Bayes risk.\nk) For ε = 0.1, find the ε-minimax rules and risk points on the risk set.",
    "steps": [
      {
        "step": 1,
        "desc": "Define the probability of each expert correctly predicting viability when the project is viable (θ₀).",
        "expr": "P(correct | θ₀) = 4/5",
        "value": 0.8
      },
      {
        "step": 2,
        "desc": "Define the probability of each expert incorrectly predicting viability when the project is viable (θ₀).",
        "expr": "P(incorrect | θ₀) = 1/5",
        "value": 0.2
      },
      {
        "step": 3,
        "desc": "Define the probability of each expert incorrectly predicting viability when the project is not viable (θ₁).",
        "expr": "P(incorrect | θ₁) = 3/5",
        "value": 0.6
      },
      {
        "step": 4,
        "desc": "Define the probability of each expert correctly predicting non-viability when the project is not viable (θ₁).",
        "expr": "P(correct | θ₁) = 2/5",
        "value": 0.4
      },
      {
        "step": 5,
        "desc": "Compute P(X=0 | θ₀): both experts incorrectly predict viability when it is viable.",
        "expr": "P(X=0 | θ₀) = (0.2)^2",
        "value": 0.04
      },
      {
        "step": 6,
        "desc": "Compute P(X=1 | θ₀): one expert correctly predicts and one incorrectly predicts viability when it is viable.",
        "expr": "P(X=1 | θ₀) = 2 * (0.8 * 0.2)",
        "value": 0.32
      },
      {
        "step": 7,
        "desc": "Compute P(X=2 | θ₀): both experts correctly predict viability when it is viable.",
        "expr": "P(X=2 | θ₀) = (0.8)^2",
        "value": 0.64
      },
      {
        "step": 8,
        "desc": "Compute P(X=0 | θ₁): both experts incorrectly predict viability when it is not viable.",
        "expr": "P(X=0 | θ₁) = (0.6)^2",
        "value": 0.36
      },
      {
        "step": 9,
        "desc": "Compute P(X=1 | θ₁): one expert correctly predicts and one incorrectly predicts viability when it is not viable.",
        "expr": "P(X=1 | θ₁) = 2 * (0.6 * 0.4)",
        "value": 0.48
      },
      {
        "step": 10,
        "desc": "Compute P(X=2 | θ₁): both experts correctly predict non-viability when it is not viable.",
        "expr": "P(X=2 | θ₁) = (0.4)^2",
        "value": 0.16
      },
      {
        "step": "final",
        "desc": "Summarize the pmf of X under both θ₀ and θ₁.",
        "expr": "P(X | θ₀) = {0.04, 0.32, 0.64}, P(X | θ₁) = {0.36, 0.48, 0.16}",
        "value": {
          "P(X | θ₀)": [
            0.04,
            0.32,
            0.64
          ],
          "P(X | θ₁)": [
            0.36,
            0.48,
            0.16
          ]
        }
      }
    ]
  },
  {
    "qid": "Problemfour",
    "subid": "c",
    "subquestion": "List all non-randomized decision rules D based on x.",
    "full_question": "The Premier of NSW has to take an important decision whether or not to include an additional line (extension) to Sydney’s metro system. The decision is based on the financial viability of the extension. He is willing to apply decision theory in making his decision. He uses the independent opinion of two consulting experts. The data he uses is the number X of viability recommendations of the two experts (X = 0, 1 or 2).\n\nIf the Premier does not go ahead and the extension turns out not to be financially viable or if he decides to go ahead and the project is financially viable, nothing is lost. If the project is not financially viable and he has decided to go ahead, his subjective judgement is that his loss would equal three times the loss of not going ahead but the project is financially viable.\n\nThe Premier has investigated the history of viability predictions of the two consulting experts and it is as follows. When a project is financially viable, both experts have correctly predicted its viability with probability 4/5 (and wrongly with 1/5). When a project has not been financially viable, both experts had a prediction of 3/5 for it to be viable. The Premier listens to the recommendations of the two experts and makes his decision based on the value of X.\n\na) There are two possible actions in the action space A = {a₀, a₁} where a₀ is to go ahead and a₁ is not to go ahead. There are two states of nature Θ = {θ₀, θ₁} where θ₀ = 0 represents 'extension is financially viable' and θ₁ = 1 means 'not viable'. Define a suitable loss function L(θ, a).\nb) Compute the probability mass function (pmf) for X under both states of nature.\nc) The complete list of all the non-randomized decisions rules D based on x is given by:\n   x = 0: a₀ a₁ a₀ a₁ a₀ a₁ a₀ a₁\n   x = 1: a₀ a₀ a₁ a₁ a₀ a₀ a₁ a₁\n   x = 2: a₀ a₀ a₀ a₀ a₁ a₁ a₁ a₁\n   (d₁ to d₈)\nd) For each rule in D compute the corresponding risk points.\ne) Find the minimax rule(s) among the non-randomized rules.\nf) Sketch the risk set of all randomized rules D generated by the 8 rules. Use R or any plotting tool.\ng) Find the risk point of the minimax rule in the set of randomized decision rules D. Compare to minimax in D.\nh) Define the minimax rule in D in terms of rules in D.\ni) For which prior on {θ₁, θ₂} is the minimax rule in D also a Bayes rule?\nj) Suppose the Premier’s belief in viability is 50%. Find the Bayes rule and Bayes risk.\nk) For ε = 0.1, find the ε-minimax rules and risk points on the risk set.",
    "steps": [
      {
        "step": 1,
        "desc": "List all possible actions for x = 0",
        "expr": "x = 0: a₀ a₁ a₀ a₁ a₀ a₁ a₀ a₁",
        "value": [
          "a₀",
          "a₁",
          "a₀",
          "a₁",
          "a₀",
          "a₁",
          "a₀",
          "a₁"
        ]
      },
      {
        "step": 2,
        "desc": "List all possible actions for x = 1",
        "expr": "x = 1: a₀ a₀ a₁ a₁ a₀ a₀ a₁ a₁",
        "value": [
          "a₀",
          "a₀",
          "a₁",
          "a₁",
          "a₀",
          "a₀",
          "a₁",
          "a₁"
        ]
      },
      {
        "step": 3,
        "desc": "List all possible actions for x = 2",
        "expr": "x = 2: a₀ a₀ a₀ a₀ a₁ a₁ a₁ a₁",
        "value": [
          "a₀",
          "a₀",
          "a₀",
          "a₀",
          "a₁",
          "a₁",
          "a₁",
          "a₁"
        ]
      },
      {
        "step": "final",
        "desc": "Combine all actions for each x to list all non-randomized decision rules",
        "expr": "D = {d₁, d₂, d₃, d₄, d₅, d₆, d₇, d₈}",
        "value": [
          {
            "x=0": "a₀",
            "x=1": "a₀",
            "x=2": "a₀"
          },
          {
            "x=0": "a₁",
            "x=1": "a₀",
            "x=2": "a₀"
          },
          {
            "x=0": "a₀",
            "x=1": "a₁",
            "x=2": "a₀"
          },
          {
            "x=0": "a₁",
            "x=1": "a₁",
            "x=2": "a₀"
          },
          {
            "x=0": "a₀",
            "x=1": "a₀",
            "x=2": "a₁"
          },
          {
            "x=0": "a₁",
            "x=1": "a₀",
            "x=2": "a₁"
          },
          {
            "x=0": "a₀",
            "x=1": "a₁",
            "x=2": "a₁"
          },
          {
            "x=0": "a₁",
            "x=1": "a₁",
            "x=2": "a₁"
          }
        ]
      }
    ]
  },
  {
    "qid": "Problemfour",
    "subid": "d",
    "subquestion": "Compute the risk points for all non-randomized rules in D.",
    "full_question": "The Premier of NSW has to take an important decision whether or not to include an additional line (extension) to Sydney’s metro system. The decision is based on the financial viability of the extension. He is willing to apply decision theory in making his decision. He uses the independent opinion of two consulting experts. The data he uses is the number X of viability recommendations of the two experts (X = 0, 1 or 2).\n\nIf the Premier does not go ahead and the extension turns out not to be financially viable or if he decides to go ahead and the project is financially viable, nothing is lost. If the project is not financially viable and he has decided to go ahead, his subjective judgement is that his loss would equal three times the loss of not going ahead but the project is financially viable.\n\nThe Premier has investigated the history of viability predictions of the two consulting experts and it is as follows. When a project is financially viable, both experts have correctly predicted its viability with probability 4/5 (and wrongly with 1/5). When a project has not been financially viable, both experts had a prediction of 3/5 for it to be viable. The Premier listens to the recommendations of the two experts and makes his decision based on the value of X.\n\na) There are two possible actions in the action space A = {a₀, a₁} where a₀ is to go ahead and a₁ is not to go ahead. There are two states of nature Θ = {θ₀, θ₁} where θ₀ = 0 represents 'extension is financially viable' and θ₁ = 1 means 'not viable'. Define a suitable loss function L(θ, a).\nb) Compute the probability mass function (pmf) for X under both states of nature.\nc) The complete list of all the non-randomized decisions rules D based on x is given by:\n   x = 0: a₀ a₁ a₀ a₁ a₀ a₁ a₀ a₁\n   x = 1: a₀ a₀ a₁ a₁ a₀ a₀ a₁ a₁\n   x = 2: a₀ a₀ a₀ a₀ a₁ a₁ a₁ a₁\n   (d₁ to d₈)\nd) For each rule in D compute the corresponding risk points.\ne) Find the minimax rule(s) among the non-randomized rules.\nf) Sketch the risk set of all randomized rules D generated by the 8 rules. Use R or any plotting tool.\ng) Find the risk point of the minimax rule in the set of randomized decision rules D. Compare to minimax in D.\nh) Define the minimax rule in D in terms of rules in D.\ni) For which prior on {θ₁, θ₂} is the minimax rule in D also a Bayes rule?\nj) Suppose the Premier’s belief in viability is 50%. Find the Bayes rule and Bayes risk.\nk) For ε = 0.1, find the ε-minimax rules and risk points on the risk set.",
    "steps": [
      {
        "step": 1,
        "desc": "Define the loss function L(θ, a) based on the problem statement.",
        "expr": "L(θ₀, a₀) = 0, L(θ₀, a₁) = 1, L(θ₁, a₀) = 3, L(θ₁, a₁) = 0",
        "value": null
      },
      {
        "step": 2,
        "desc": "Compute the probability mass function (pmf) for X under θ₀ (viable).",
        "expr": "P(X=0|θ₀) = (1/5)^2, P(X=1|θ₀) = 2*(4/5)*(1/5), P(X=2|θ₀) = (4/5)^2",
        "value": {
          "P(X=0|θ₀)": 0.04,
          "P(X=1|θ₀)": 0.32,
          "P(X=2|θ₀)": 0.64
        }
      },
      {
        "step": 3,
        "desc": "Compute the probability mass function (pmf) for X under θ₁ (not viable).",
        "expr": "P(X=0|θ₁) = (2/5)^2, P(X=1|θ₁) = 2*(3/5)*(2/5), P(X=2|θ₁) = (3/5)^2",
        "value": {
          "P(X=0|θ₁)": 0.16,
          "P(X=1|θ₁)": 0.48,
          "P(X=2|θ₁)": 0.36
        }
      },
      {
        "step": 4,
        "desc": "Compute risk for d₁: (a₀, a₀, a₀).",
        "expr": "R(d₁, θ₀) = 0*0.04 + 0*0.32 + 0*0.64, R(d₁, θ₁) = 3*0.16 + 3*0.48 + 3*0.36",
        "value": {
          "R(d₁, θ₀)": 0,
          "R(d₁, θ₁)": 3
        }
      },
      {
        "step": 5,
        "desc": "Compute risk for d₂: (a₁, a₀, a₀).",
        "expr": "R(d₂, θ₀) = 1*0.04 + 0*0.32 + 0*0.64, R(d₂, θ₁) = 0*0.16 + 3*0.48 + 3*0.36",
        "value": {
          "R(d₂, θ₀)": 0.04,
          "R(d₂, θ₁)": 2.52
        }
      },
      {
        "step": 6,
        "desc": "Compute risk for d₃: (a₀, a₁, a₀).",
        "expr": "R(d₃, θ₀) = 0*0.04 + 1*0.32 + 0*0.64, R(d₃, θ₁) = 3*0.16 + 0*0.48 + 3*0.36",
        "value": {
          "R(d₃, θ₀)": 0.32,
          "R(d₃, θ₁)": 1.56
        }
      },
      {
        "step": 7,
        "desc": "Compute risk for d₄: (a₁, a₁, a₀).",
        "expr": "R(d₄, θ₀) = 1*0.04 + 1*0.32 + 0*0.64, R(d₄, θ₁) = 0*0.16 + 0*0.48 + 3*0.36",
        "value": {
          "R(d₄, θ₀)": 0.36,
          "R(d₄, θ₁)": 1.08
        }
      },
      {
        "step": 8,
        "desc": "Compute risk for d₅: (a₀, a₀, a₁).",
        "expr": "R(d₅, θ₀) = 0*0.04 + 0*0.32 + 1*0.64, R(d₅, θ₁) = 3*0.16 + 3*0.48 + 0*0.36",
        "value": {
          "R(d₅, θ₀)": 0.64,
          "R(d₅, θ₁)": 1.92
        }
      },
      {
        "step": 9,
        "desc": "Compute risk for d₆: (a₁, a₀, a₁).",
        "expr": "R(d₆, θ₀) = 1*0.04 + 0*0.32 + 1*0.64, R(d₆, θ₁) = 0*0.16 + 3*0.48 + 0*0.36",
        "value": {
          "R(d₆, θ₀)": 0.68,
          "R(d₆, θ₁)": 1.44
        }
      },
      {
        "step": 10,
        "desc": "Compute risk for d₇: (a₀, a₁, a₁).",
        "expr": "R(d₇, θ₀) = 0*0.04 + 1*0.32 + 1*0.64, R(d₇, θ₁) = 3*0.16 + 0*0.48 + 0*0.36",
        "value": {
          "R(d₇, θ₀)": 0.96,
          "R(d₇, θ₁)": 0.48
        }
      },
      {
        "step": 11,
        "desc": "Compute risk for d₈: (a₁, a₁, a₁).",
        "expr": "R(d₈, θ₀) = 1*0.04 + 1*0.32 + 1*0.64, R(d₈, θ₁) = 0*0.16 + 0*0.48 + 0*0.36",
        "value": {
          "R(d₈, θ₀)": 1,
          "R(d₈, θ₁)": 0
        }
      }
    ]
  },
  {
    "qid": "Problemfour",
    "subid": "e",
    "subquestion": "Find the minimax rule(s) among the non-randomized rules in D.",
    "full_question": "The Premier of NSW has to take an important decision whether or not to include an additional line (extension) to Sydney’s metro system. The decision is based on the financial viability of the extension. He is willing to apply decision theory in making his decision. He uses the independent opinion of two consulting experts. The data he uses is the number X of viability recommendations of the two experts (X = 0, 1 or 2).\n\nIf the Premier does not go ahead and the extension turns out not to be financially viable or if he decides to go ahead and the project is financially viable, nothing is lost. If the project is not financially viable and he has decided to go ahead, his subjective judgement is that his loss would equal three times the loss of not going ahead but the project is financially viable.\n\nThe Premier has investigated the history of viability predictions of the two consulting experts and it is as follows. When a project is financially viable, both experts have correctly predicted its viability with probability 4/5 (and wrongly with 1/5). When a project has not been financially viable, both experts had a prediction of 3/5 for it to be viable. The Premier listens to the recommendations of the two experts and makes his decision based on the value of X.\n\na) There are two possible actions in the action space A = {a₀, a₁} where a₀ is to go ahead and a₁ is not to go ahead. There are two states of nature Θ = {θ₀, θ₁} where θ₀ = 0 represents 'extension is financially viable' and θ₁ = 1 means 'not viable'. Define a suitable loss function L(θ, a).\nb) Compute the probability mass function (pmf) for X under both states of nature.\nc) The complete list of all the non-randomized decisions rules D based on x is given by:\n   x = 0: a₀ a₁ a₀ a₁ a₀ a₁ a₀ a₁\n   x = 1: a₀ a₀ a₁ a₁ a₀ a₀ a₁ a₁\n   x = 2: a₀ a₀ a₀ a₀ a₁ a₁ a₁ a₁\n   (d₁ to d₈)\nd) For each rule in D compute the corresponding risk points.\ne) Find the minimax rule(s) among the non-randomized rules.\nf) Sketch the risk set of all randomized rules D generated by the 8 rules. Use R or any plotting tool.\ng) Find the risk point of the minimax rule in the set of randomized decision rules D. Compare to minimax in D.\nh) Define the minimax rule in D in terms of rules in D.\ni) For which prior on {θ₁, θ₂} is the minimax rule in D also a Bayes rule?\nj) Suppose the Premier’s belief in viability is 50%. Find the Bayes rule and Bayes risk.\nk) For ε = 0.1, find the ε-minimax rules and risk points on the risk set.",
    "steps": [
      {
        "step": 1,
        "desc": "Define the loss function L(θ, a) based on the problem statement",
        "expr": "L(θ₀, a₀) = 0, L(θ₀, a₁) = 1, L(θ₁, a₀) = 3, L(θ₁, a₁) = 0",
        "value": null
      },
      {
        "step": 2,
        "desc": "Compute the probability mass function (pmf) for X under θ₀",
        "expr": "P(X=0|θ₀) = (1/5)^2, P(X=1|θ₀) = 2*(4/5)*(1/5), P(X=2|θ₀) = (4/5)^2",
        "value": {
          "P(X=0|θ₀)": 0.04,
          "P(X=1|θ₀)": 0.32,
          "P(X=2|θ₀)": 0.64
        }
      },
      {
        "step": 3,
        "desc": "Compute the probability mass function (pmf) for X under θ₁",
        "expr": "P(X=0|θ₁) = (2/5)^2, P(X=1|θ₁) = 2*(3/5)*(2/5), P(X=2|θ₁) = (3/5)^2",
        "value": {
          "P(X=0|θ₁)": 0.16,
          "P(X=1|θ₁)": 0.48,
          "P(X=2|θ₁)": 0.36
        }
      },
      {
        "step": 4,
        "desc": "List the non-randomized decision rules D",
        "expr": "d₁ = (a₀, a₀, a₀), d₂ = (a₁, a₀, a₀), d₃ = (a₀, a₁, a₀), d₄ = (a₁, a₁, a₀), d₅ = (a₀, a₀, a₁), d₆ = (a₁, a₀, a₁), d₇ = (a₀, a₁, a₁), d₈ = (a₁, a₁, a₁)",
        "value": null
      },
      {
        "step": 5,
        "desc": "Compute the risk for each decision rule under θ₀",
        "expr": "R(d|θ₀) = Σ P(X=x|θ₀) * L(θ₀, a_x)",
        "value": {
          "R(d₁|θ₀)": 0,
          "R(d₂|θ₀)": 0.04,
          "R(d₃|θ₀)": 0.32,
          "R(d₄|θ₀)": 0.36,
          "R(d₅|θ₀)": 0.64,
          "R(d₆|θ₀)": 0.68,
          "R(d₇|θ₀)": 0.96,
          "R(d₈|θ₀)": 1.0
        }
      },
      {
        "step": 6,
        "desc": "Compute the risk for each decision rule under θ₁",
        "expr": "R(d|θ₁) = Σ P(X=x|θ₁) * L(θ₁, a_x)",
        "value": {
          "R(d₁|θ₁)": 3.0,
          "R(d₂|θ₁)": 2.84,
          "R(d₃|θ₁)": 2.52,
          "R(d₄|θ₁)": 2.36,
          "R(d₅|θ₁)": 2.16,
          "R(d₆|θ₁)": 2.0,
          "R(d₇|θ₁)": 1.68,
          "R(d₈|θ₁)": 1.52
        }
      },
      {
        "step": 7,
        "desc": "Identify the minimax rule by finding the rule with the smallest maximum risk",
        "expr": "minimax rule = argmin_d max(R(d|θ₀), R(d|θ₁))",
        "value": "d₆"
      },
      {
        "step": "final",
        "desc": "The minimax rule among the non-randomized rules is identified",
        "expr": "minimax rule = d₆",
        "value": "d₆"
      }
    ]
  },
  {
    "qid": "Problemfour",
    "subid": "f",
    "subquestion": "Sketch the risk set of all randomized rules D and identify admissible rules.",
    "full_question": "The Premier of NSW has to take an important decision whether or not to include an additional line (extension) to Sydney’s metro system. The decision is based on the financial viability of the extension. He is willing to apply decision theory in making his decision. He uses the independent opinion of two consulting experts. The data he uses is the number X of viability recommendations of the two experts (X = 0, 1 or 2).\n\nIf the Premier does not go ahead and the extension turns out not to be financially viable or if he decides to go ahead and the project is financially viable, nothing is lost. If the project is not financially viable and he has decided to go ahead, his subjective judgement is that his loss would equal three times the loss of not going ahead but the project is financially viable.\n\nThe Premier has investigated the history of viability predictions of the two consulting experts and it is as follows. When a project is financially viable, both experts have correctly predicted its viability with probability 4/5 (and wrongly with 1/5). When a project has not been financially viable, both experts had a prediction of 3/5 for it to be viable. The Premier listens to the recommendations of the two experts and makes his decision based on the value of X.\n\na) There are two possible actions in the action space A = {a₀, a₁} where a₀ is to go ahead and a₁ is not to go ahead. There are two states of nature Θ = {θ₀, θ₁} where θ₀ = 0 represents 'extension is financially viable' and θ₁ = 1 means 'not viable'. Define a suitable loss function L(θ, a).\nb) Compute the probability mass function (pmf) for X under both states of nature.\nc) The complete list of all the non-randomized decisions rules D based on x is given by:\n   x = 0: a₀ a₁ a₀ a₁ a₀ a₁ a₀ a₁\n   x = 1: a₀ a₀ a₁ a₁ a₀ a₀ a₁ a₁\n   x = 2: a₀ a₀ a₀ a₀ a₁ a₁ a₁ a₁\n   (d₁ to d₈)\nd) For each rule in D compute the corresponding risk points.\ne) Find the minimax rule(s) among the non-randomized rules.\nf) Sketch the risk set of all randomized rules D generated by the 8 rules. Use R or any plotting tool.\ng) Find the risk point of the minimax rule in the set of randomized decision rules D. Compare to minimax in D.\nh) Define the minimax rule in D in terms of rules in D.\ni) For which prior on {θ₁, θ₂} is the minimax rule in D also a Bayes rule?\nj) Suppose the Premier’s belief in viability is 50%. Find the Bayes rule and Bayes risk.\nk) For ε = 0.1, find the ε-minimax rules and risk points on the risk set.",
    "steps": [
      {
        "step": 1,
        "desc": "Define the loss function L(θ, a) based on the problem statement",
        "expr": "L(θ₀, a₀) = 0, L(θ₀, a₁) = 1, L(θ₁, a₀) = 3, L(θ₁, a₁) = 0",
        "value": null
      },
      {
        "step": 2,
        "desc": "Compute the probability mass function (pmf) for X under both states of nature",
        "expr": "P(X = x | θ₀) and P(X = x | θ₁) for x = 0, 1, 2",
        "value": {
          "P(X=0|θ₀)": "1/25",
          "P(X=1|θ₀)": "8/25",
          "P(X=2|θ₀)": "16/25",
          "P(X=0|θ₁)": "4/25",
          "P(X=1|θ₁)": "12/25",
          "P(X=2|θ₁)": "9/25"
        }
      },
      {
        "step": 3,
        "desc": "List all non-randomized decision rules D based on x",
        "expr": "d₁ to d₈ for x = 0, 1, 2",
        "value": [
          {
            "x=0": "a₀",
            "x=1": "a₀",
            "x=2": "a₀"
          },
          {
            "x=0": "a₁",
            "x=1": "a₀",
            "x=2": "a₀"
          },
          {
            "x=0": "a₀",
            "x=1": "a₁",
            "x=2": "a₀"
          },
          {
            "x=0": "a₁",
            "x=1": "a₁",
            "x=2": "a₀"
          },
          {
            "x=0": "a₀",
            "x=1": "a₀",
            "x=2": "a₁"
          },
          {
            "x=0": "a₁",
            "x=1": "a₀",
            "x=2": "a₁"
          },
          {
            "x=0": "a₀",
            "x=1": "a₁",
            "x=2": "a₁"
          },
          {
            "x=0": "a₁",
            "x=1": "a₁",
            "x=2": "a₁"
          }
        ]
      },
      {
        "step": 4,
        "desc": "Compute the risk for each decision rule in D",
        "expr": "R(d|θ) = Σ P(X=x|θ) * L(θ, a(x))",
        "value": [
          {
            "d₁": {
              "R(d₁|θ₀)": 0,
              "R(d₁|θ₁)": 3
            }
          },
          {
            "d₂": {
              "R(d₂|θ₀)": 1,
              "R(d₂|θ₁)": 2.4
            }
          },
          {
            "d₃": {
              "R(d₃|θ₀)": 0.8,
              "R(d₃|θ₁)": 2.6
            }
          },
          {
            "d₄": {
              "R(d₄|θ₀)": 1.8,
              "R(d₄|θ₁)": 2
            }
          },
          {
            "d₅": {
              "R(d₅|θ₀)": 0.64,
              "R(d₅|θ₁)": 2.36
            }
          },
          {
            "d₆": {
              "R(d₆|θ₀)": 1.64,
              "R(d₆|θ₁)": 1.76
            }
          },
          {
            "d₇": {
              "R(d₇|θ₀)": 0.8,
              "R(d₇|θ₁)": 2.6
            }
          },
          {
            "d₈": {
              "R(d₈|θ₀)": 1.8,
              "R(d₈|θ₁)": 2
            }
          }
        ]
      },
      {
        "step": 5,
        "desc": "Plot the risk set of all randomized rules D",
        "expr": "Plot R(d|θ₀) vs R(d|θ₁) for each d",
        "value": null
      },
      {
        "step": 6,
        "desc": "Identify admissible rules from the risk set",
        "expr": "Admissible rules have no other rule with lower risk in both states",
        "value": [
          "d₁",
          "d₆"
        ]
      },
      {
        "step": "final",
        "desc": "Finalize the sketch of the risk set and identify admissible rules",
        "expr": "Admissible rules are those not dominated by any other",
        "value": [
          "d₁",
          "d₆"
        ]
      }
    ]
  },
  {
    "qid": "Problemfour",
    "subid": "g",
    "subquestion": "Find the risk point of the minimax rule in the randomized set D and compare to the non-randomized.",
    "full_question": "The Premier of NSW has to take an important decision whether or not to include an additional line (extension) to Sydney’s metro system. The decision is based on the financial viability of the extension. He is willing to apply decision theory in making his decision. He uses the independent opinion of two consulting experts. The data he uses is the number X of viability recommendations of the two experts (X = 0, 1 or 2).\n\nIf the Premier does not go ahead and the extension turns out not to be financially viable or if he decides to go ahead and the project is financially viable, nothing is lost. If the project is not financially viable and he has decided to go ahead, his subjective judgement is that his loss would equal three times the loss of not going ahead but the project is financially viable.\n\nThe Premier has investigated the history of viability predictions of the two consulting experts and it is as follows. When a project is financially viable, both experts have correctly predicted its viability with probability 4/5 (and wrongly with 1/5). When a project has not been financially viable, both experts had a prediction of 3/5 for it to be viable. The Premier listens to the recommendations of the two experts and makes his decision based on the value of X.\n\na) There are two possible actions in the action space A = {a₀, a₁} where a₀ is to go ahead and a₁ is not to go ahead. There are two states of nature Θ = {θ₀, θ₁} where θ₀ = 0 represents 'extension is financially viable' and θ₁ = 1 means 'not viable'. Define a suitable loss function L(θ, a).\nb) Compute the probability mass function (pmf) for X under both states of nature.\nc) The complete list of all the non-randomized decisions rules D based on x is given by:\n   x = 0: a₀ a₁ a₀ a₁ a₀ a₁ a₀ a₁\n   x = 1: a₀ a₀ a₁ a₁ a₀ a₀ a₁ a₁\n   x = 2: a₀ a₀ a₀ a₀ a₁ a₁ a₁ a₁\n   (d₁ to d₈)\nd) For each rule in D compute the corresponding risk points.\ne) Find the minimax rule(s) among the non-randomized rules.\nf) Sketch the risk set of all randomized rules D generated by the 8 rules. Use R or any plotting tool.\ng) Find the risk point of the minimax rule in the set of randomized decision rules D. Compare to minimax in D.\nh) Define the minimax rule in D in terms of rules in D.\ni) For which prior on {θ₁, θ₂} is the minimax rule in D also a Bayes rule?\nj) Suppose the Premier’s belief in viability is 50%. Find the Bayes rule and Bayes risk.\nk) For ε = 0.1, find the ε-minimax rules and risk points on the risk set.",
    "steps": [
      {
        "step": 1,
        "desc": "Define the loss function L(θ, a) based on the problem statement",
        "expr": "L(θ₀, a₀) = 0, L(θ₀, a₁) = 1, L(θ₁, a₀) = 3, L(θ₁, a₁) = 0",
        "value": null
      },
      {
        "step": 2,
        "desc": "Compute the probability mass function (pmf) for X under θ₀",
        "expr": "P(X=0|θ₀) = (1/5)^2, P(X=1|θ₀) = 2*(4/5)*(1/5), P(X=2|θ₀) = (4/5)^2",
        "value": {
          "P(X=0|θ₀)": 0.04,
          "P(X=1|θ₀)": 0.32,
          "P(X=2|θ₀)": 0.64
        }
      },
      {
        "step": 3,
        "desc": "Compute the probability mass function (pmf) for X under θ₁",
        "expr": "P(X=0|θ₁) = (2/5)^2, P(X=1|θ₁) = 2*(3/5)*(2/5), P(X=2|θ₁) = (3/5)^2",
        "value": {
          "P(X=0|θ₁)": 0.16,
          "P(X=1|θ₁)": 0.48,
          "P(X=2|θ₁)": 0.36
        }
      },
      {
        "step": 4,
        "desc": "Compute the risk for each non-randomized decision rule d₁ to d₈",
        "expr": "R(d, θ) = Σ P(X=x|θ) * L(θ, a(x))",
        "value": null
      },
      {
        "step": 5,
        "desc": "Identify the minimax rule among non-randomized rules",
        "expr": "minimize max R(d, θ)",
        "value": "d₄"
      },
      {
        "step": 6,
        "desc": "Compute the risk point for the minimax rule in the randomized set D",
        "expr": "R(d, θ) = Σ P(X=x|θ) * L(θ, a(x)) for randomized d",
        "value": null
      },
      {
        "step": 7,
        "desc": "Compare the risk point of the minimax rule in the randomized set to the non-randomized",
        "expr": "R(d_randomized, θ) vs R(d₄, θ)",
        "value": "R(d_randomized, θ) <= R(d₄, θ)"
      },
      {
        "step": "final",
        "desc": "Conclude the comparison of risk points",
        "expr": "R(d_randomized, θ) is less than or equal to R(d₄, θ)",
        "value": null
      }
    ]
  },
  {
    "qid": "Problemfour",
    "subid": "h",
    "subquestion": "Define the minimax rule in the set D in terms of rules in D.",
    "full_question": "The Premier of NSW has to take an important decision whether or not to include an additional line (extension) to Sydney’s metro system. The decision is based on the financial viability of the extension. He is willing to apply decision theory in making his decision. He uses the independent opinion of two consulting experts. The data he uses is the number X of viability recommendations of the two experts (X = 0, 1 or 2).\n\nIf the Premier does not go ahead and the extension turns out not to be financially viable or if he decides to go ahead and the project is financially viable, nothing is lost. If the project is not financially viable and he has decided to go ahead, his subjective judgement is that his loss would equal three times the loss of not going ahead but the project is financially viable.\n\nThe Premier has investigated the history of viability predictions of the two consulting experts and it is as follows. When a project is financially viable, both experts have correctly predicted its viability with probability 4/5 (and wrongly with 1/5). When a project has not been financially viable, both experts had a prediction of 3/5 for it to be viable. The Premier listens to the recommendations of the two experts and makes his decision based on the value of X.\n\na) There are two possible actions in the action space A = {a₀, a₁} where a₀ is to go ahead and a₁ is not to go ahead. There are two states of nature Θ = {θ₀, θ₁} where θ₀ = 0 represents 'extension is financially viable' and θ₁ = 1 means 'not viable'. Define a suitable loss function L(θ, a).\nb) Compute the probability mass function (pmf) for X under both states of nature.\nc) The complete list of all the non-randomized decisions rules D based on x is given by:\n   x = 0: a₀ a₁ a₀ a₁ a₀ a₁ a₀ a₁\n   x = 1: a₀ a₀ a₁ a₁ a₀ a₀ a₁ a₁\n   x = 2: a₀ a₀ a₀ a₀ a₁ a₁ a₁ a₁\n   (d₁ to d₈)\nd) For each rule in D compute the corresponding risk points.\ne) Find the minimax rule(s) among the non-randomized rules.\nf) Sketch the risk set of all randomized rules D generated by the 8 rules. Use R or any plotting tool.\ng) Find the risk point of the minimax rule in the set of randomized decision rules D. Compare to minimax in D.\nh) Define the minimax rule in D in terms of rules in D.\ni) For which prior on {θ₁, θ₂} is the minimax rule in D also a Bayes rule?\nj) Suppose the Premier’s belief in viability is 50%. Find the Bayes rule and Bayes risk.\nk) For ε = 0.1, find the ε-minimax rules and risk points on the risk set.",
    "steps": [
      {
        "step": 1,
        "desc": "Identify the loss function L(θ, a) based on the problem description.",
        "expr": "L(θ₀, a₀) = 0, L(θ₀, a₁) = 1, L(θ₁, a₀) = 3, L(θ₁, a₁) = 0",
        "value": null
      },
      {
        "step": 2,
        "desc": "Compute the risk for each decision rule d₁ to d₈ under each state of nature using the loss function.",
        "expr": "R(d, θ) = Σ L(θ, a) * P(X = x | θ)",
        "value": null
      },
      {
        "step": 3,
        "desc": "List the risk for each decision rule under θ₀ and θ₁.",
        "expr": "R(d₁, θ₀), R(d₁, θ₁), ..., R(d₈, θ₀), R(d₈, θ₁)",
        "value": null
      },
      {
        "step": 4,
        "desc": "Identify the maximum risk for each decision rule across both states of nature.",
        "expr": "max(R(d, θ₀), R(d, θ₁)) for each d",
        "value": null
      },
      {
        "step": 5,
        "desc": "Select the decision rule with the smallest maximum risk, which is the minimax rule.",
        "expr": "min(max(R(d, θ₀), R(d, θ₁)))",
        "value": "d₄"
      },
      {
        "step": "final",
        "desc": "Define the minimax rule in terms of rules in D.",
        "expr": "d₄: x = 0: a₁, x = 1: a₁, x = 2: a₀",
        "value": "d₄"
      }
    ]
  },
  {
    "qid": "Problemfour",
    "subid": "i",
    "subquestion": "For which prior on {θ₀, θ₁} is the minimax rule in D also a Bayes rule?",
    "full_question": "The Premier of NSW has to take an important decision whether or not to include an additional line (extension) to Sydney’s metro system. The decision is based on the financial viability of the extension. He is willing to apply decision theory in making his decision. He uses the independent opinion of two consulting experts. The data he uses is the number X of viability recommendations of the two experts (X = 0, 1 or 2).\n\nIf the Premier does not go ahead and the extension turns out not to be financially viable or if he decides to go ahead and the project is financially viable, nothing is lost. If the project is not financially viable and he has decided to go ahead, his subjective judgement is that his loss would equal three times the loss of not going ahead but the project is financially viable.\n\nThe Premier has investigated the history of viability predictions of the two consulting experts and it is as follows. When a project is financially viable, both experts have correctly predicted its viability with probability 4/5 (and wrongly with 1/5). When a project has not been financially viable, both experts had a prediction of 3/5 for it to be viable. The Premier listens to the recommendations of the two experts and makes his decision based on the value of X.\n\na) There are two possible actions in the action space A = {a₀, a₁} where a₀ is to go ahead and a₁ is not to go ahead. There are two states of nature Θ = {θ₀, θ₁} where θ₀ = 0 represents 'extension is financially viable' and θ₁ = 1 means 'not viable'. Define a suitable loss function L(θ, a).\nb) Compute the probability mass function (pmf) for X under both states of nature.\nc) The complete list of all the non-randomized decisions rules D based on x is given by:\n   x = 0: a₀ a₁ a₀ a₁ a₀ a₁ a₀ a₁\n   x = 1: a₀ a₀ a₁ a₁ a₀ a₀ a₁ a₁\n   x = 2: a₀ a₀ a₀ a₀ a₁ a₁ a₁ a₁\n   (d₁ to d₈)\nd) For each rule in D compute the corresponding risk points.\ne) Find the minimax rule(s) among the non-randomized rules.\nf) Sketch the risk set of all randomized rules D generated by the 8 rules. Use R or any plotting tool.\ng) Find the risk point of the minimax rule in the set of randomized decision rules D. Compare to minimax in D.\nh) Define the minimax rule in D in terms of rules in D.\ni) For which prior on {θ₁, θ₂} is the minimax rule in D also a Bayes rule?\nj) Suppose the Premier’s belief in viability is 50%. Find the Bayes rule and Bayes risk.\nk) For ε = 0.1, find the ε-minimax rules and risk points on the risk set.",
    "steps": [
      {
        "step": 1,
        "desc": "Identify the minimax rule in D",
        "expr": "d_4",
        "value": "d_4"
      },
      {
        "step": 2,
        "desc": "Define the risk function for a decision rule d",
        "expr": "R(d, θ) = Σ L(θ, a) * P(X | θ)",
        "value": null
      },
      {
        "step": 3,
        "desc": "Compute the risk for d_4 under θ₀",
        "expr": "R(d_4, θ₀) = L(θ₀, a₁) * P(X=0 | θ₀) + L(θ₀, a₀) * P(X=1 | θ₀) + L(θ₀, a₀) * P(X=2 | θ₀)",
        "value": "0 * P(X=0 | θ₀) + 1 * P(X=1 | θ₀) + 1 * P(X=2 | θ₀)"
      },
      {
        "step": 4,
        "desc": "Compute the risk for d_4 under θ₁",
        "expr": "R(d_4, θ₁) = L(θ₁, a₁) * P(X=0 | θ₁) + L(θ₁, a₁) * P(X=1 | θ₁) + L(θ₁, a₀) * P(X=2 | θ₁)",
        "value": "0 * P(X=0 | θ₁) + 0 * P(X=1 | θ₁) + 3 * P(X=2 | θ₁)"
      },
      {
        "step": 5,
        "desc": "Set up the Bayes risk expression for a prior π",
        "expr": "R(π, d) = π(θ₀) * R(d, θ₀) + π(θ₁) * R(d, θ₁)",
        "value": null
      },
      {
        "step": 6,
        "desc": "Equate the Bayes risk to the minimax risk for d_4",
        "expr": "R(π, d_4) = max(R(d_4, θ₀), R(d_4, θ₁))",
        "value": null
      },
      {
        "step": 7,
        "desc": "Solve for π such that R(π, d_4) is minimized",
        "expr": "π(θ₀) * R(d_4, θ₀) + π(θ₁) * R(d_4, θ₁) = max(R(d_4, θ₀), R(d_4, θ₁))",
        "value": "π(θ₀) = 0.75, π(θ₁) = 0.25"
      },
      {
        "step": "final",
        "desc": "The prior for which the minimax rule is also a Bayes rule",
        "expr": "{π(θ₀), π(θ₁)}",
        "value": "{0.75, 0.25}"
      }
    ]
  },
  {
    "qid": "Problemfour",
    "subid": "j",
    "subquestion": "Assume prior P(θ₀) = 0.5. Find the Bayes rule and the Bayes risk.",
    "full_question": "The Premier of NSW has to take an important decision whether or not to include an additional line (extension) to Sydney’s metro system. The decision is based on the financial viability of the extension. He is willing to apply decision theory in making his decision. He uses the independent opinion of two consulting experts. The data he uses is the number X of viability recommendations of the two experts (X = 0, 1 or 2).\n\nIf the Premier does not go ahead and the extension turns out not to be financially viable or if he decides to go ahead and the project is financially viable, nothing is lost. If the project is not financially viable and he has decided to go ahead, his subjective judgement is that his loss would equal three times the loss of not going ahead but the project is financially viable.\n\nThe Premier has investigated the history of viability predictions of the two consulting experts and it is as follows. When a project is financially viable, both experts have correctly predicted its viability with probability 4/5 (and wrongly with 1/5). When a project has not been financially viable, both experts had a prediction of 3/5 for it to be viable. The Premier listens to the recommendations of the two experts and makes his decision based on the value of X.\n\na) There are two possible actions in the action space A = {a₀, a₁} where a₀ is to go ahead and a₁ is not to go ahead. There are two states of nature Θ = {θ₀, θ₁} where θ₀ = 0 represents 'extension is financially viable' and θ₁ = 1 means 'not viable'. Define a suitable loss function L(θ, a).\nb) Compute the probability mass function (pmf) for X under both states of nature.\nc) The complete list of all the non-randomized decisions rules D based on x is given by:\n   x = 0: a₀ a₁ a₀ a₁ a₀ a₁ a₀ a₁\n   x = 1: a₀ a₀ a₁ a₁ a₀ a₀ a₁ a₁\n   x = 2: a₀ a₀ a₀ a₀ a₁ a₁ a₁ a₁\n   (d₁ to d₈)\nd) For each rule in D compute the corresponding risk points.\ne) Find the minimax rule(s) among the non-randomized rules.\nf) Sketch the risk set of all randomized rules D generated by the 8 rules. Use R or any plotting tool.\ng) Find the risk point of the minimax rule in the set of randomized decision rules D. Compare to minimax in D.\nh) Define the minimax rule in D in terms of rules in D.\ni) For which prior on {θ₁, θ₂} is the minimax rule in D also a Bayes rule?\nj) Suppose the Premier’s belief in viability is 50%. Find the Bayes rule and Bayes risk.\nk) For ε = 0.1, find the ε-minimax rules and risk points on the risk set.",
    "steps": [
      {
        "step": 1,
        "desc": "Define the loss function L(θ, a) based on the problem statement",
        "expr": "L(θ₀, a₀) = 0, L(θ₀, a₁) = 1, L(θ₁, a₀) = 3, L(θ₁, a₁) = 0",
        "value": null
      },
      {
        "step": 2,
        "desc": "Compute the probability mass function for X under θ₀",
        "expr": "P(X=0|θ₀) = (1/5)^2, P(X=1|θ₀) = 2*(4/5)*(1/5), P(X=2|θ₀) = (4/5)^2",
        "value": {
          "P(X=0|θ₀)": 0.04,
          "P(X=1|θ₀)": 0.32,
          "P(X=2|θ₀)": 0.64
        }
      },
      {
        "step": 3,
        "desc": "Compute the probability mass function for X under θ₁",
        "expr": "P(X=0|θ₁) = (2/5)^2, P(X=1|θ₁) = 2*(3/5)*(2/5), P(X=2|θ₁) = (3/5)^2",
        "value": {
          "P(X=0|θ₁)": 0.16,
          "P(X=1|θ₁)": 0.48,
          "P(X=2|θ₁)": 0.36
        }
      },
      {
        "step": 4,
        "desc": "Compute the posterior probabilities for θ₀ given X using Bayes' theorem",
        "expr": "P(θ₀|X=x) = P(X=x|θ₀) * P(θ₀) / P(X=x)",
        "value": null
      },
      {
        "step": 5,
        "desc": "Compute P(X=x) for each x using the law of total probability",
        "expr": "P(X=x) = P(X=x|θ₀) * P(θ₀) + P(X=x|θ₁) * P(θ₁)",
        "value": {
          "P(X=0)": 0.1,
          "P(X=1)": 0.4,
          "P(X=2)": 0.5
        }
      },
      {
        "step": 6,
        "desc": "Compute P(θ₀|X=x) for each x",
        "expr": "P(θ₀|X=0) = 0.04 / 0.10, P(θ₀|X=1) = 0.32 / 0.40, P(θ₀|X=2) = 0.64 / 0.50",
        "value": {
          "P(θ₀|X=0)": 0.4,
          "P(θ₀|X=1)": 0.8,
          "P(θ₀|X=2)": 1.28
        }
      },
      {
        "step": 7,
        "desc": "Determine the Bayes action for each x by minimizing expected loss",
        "expr": "Choose a₀ if P(θ₀|X=x) < 3 * P(θ₁|X=x), else choose a₁",
        "value": {
          "x=0": "a₁",
          "x=1": "a₀",
          "x=2": "a₀"
        }
      },
      {
        "step": 8,
        "desc": "Compute the Bayes risk for the Bayes rule",
        "expr": "R(δ) = Σ P(X=x) * min(L(θ₀, a) * P(θ₀|X=x) + L(θ₁, a) * P(θ₁|X=x))",
        "value": null
      },
      {
        "step": 9,
        "desc": "Calculate the Bayes risk",
        "expr": "R(δ) = 0.10 * 0 + 0.40 * 0.32 + 0.50 * 0.64",
        "value": 0.48
      },
      {
        "step": "final",
        "desc": "The Bayes rule and Bayes risk",
        "expr": "Bayes rule: (x=0: a₁, x=1: a₀, x=2: a₀), Bayes risk: 0.48",
        "value": {
          "Bayes rule": {
            "x=0": "a₁",
            "x=1": "a₀",
            "x=2": "a₀"
          },
          "Bayes risk": 0.48
        }
      }
    ]
  },
  {
    "qid": "Problemfour",
    "subid": "k",
    "subquestion": "For ε = 0.1, illustrate on the risk set the ε-minimax rules and their risk points.",
    "full_question": "The Premier of NSW has to take an important decision whether or not to include an additional line (extension) to Sydney’s metro system. The decision is based on the financial viability of the extension. He is willing to apply decision theory in making his decision. He uses the independent opinion of two consulting experts. The data he uses is the number X of viability recommendations of the two experts (X = 0, 1 or 2).\n\nIf the Premier does not go ahead and the extension turns out not to be financially viable or if he decides to go ahead and the project is financially viable, nothing is lost. If the project is not financially viable and he has decided to go ahead, his subjective judgement is that his loss would equal three times the loss of not going ahead but the project is financially viable.\n\nThe Premier has investigated the history of viability predictions of the two consulting experts and it is as follows. When a project is financially viable, both experts have correctly predicted its viability with probability 4/5 (and wrongly with 1/5). When a project has not been financially viable, both experts had a prediction of 3/5 for it to be viable. The Premier listens to the recommendations of the two experts and makes his decision based on the value of X.\n\na) There are two possible actions in the action space A = {a₀, a₁} where a₀ is to go ahead and a₁ is not to go ahead. There are two states of nature Θ = {θ₀, θ₁} where θ₀ = 0 represents 'extension is financially viable' and θ₁ = 1 means 'not viable'. Define a suitable loss function L(θ, a).\nb) Compute the probability mass function (pmf) for X under both states of nature.\nc) The complete list of all the non-randomized decisions rules D based on x is given by:\n   x = 0: a₀ a₁ a₀ a₁ a₀ a₁ a₀ a₁\n   x = 1: a₀ a₀ a₁ a₁ a₀ a₀ a₁ a₁\n   x = 2: a₀ a₀ a₀ a₀ a₁ a₁ a₁ a₁\n   (d₁ to d₈)\nd) For each rule in D compute the corresponding risk points.\ne) Find the minimax rule(s) among the non-randomized rules.\nf) Sketch the risk set of all randomized rules D generated by the 8 rules. Use R or any plotting tool.\ng) Find the risk point of the minimax rule in the set of randomized decision rules D. Compare to minimax in D.\nh) Define the minimax rule in D in terms of rules in D.\ni) For which prior on {θ₁, θ₂} is the minimax rule in D also a Bayes rule?\nj) Suppose the Premier’s belief in viability is 50%. Find the Bayes rule and Bayes risk.\nk) For ε = 0.1, find the ε-minimax rules and risk points on the risk set.",
    "steps": [
      {
        "step": 1,
        "desc": "Identify the risk points for each non-randomized decision rule in D",
        "expr": "R(d_i) = (R(d_i, θ₀), R(d_i, θ₁))",
        "value": "Computed in previous steps"
      },
      {
        "step": 2,
        "desc": "Determine the minimax risk point among non-randomized rules",
        "expr": "minimax risk = min(max(R(d_i, θ₀), R(d_i, θ₁)))",
        "value": "Computed in previous steps"
      },
      {
        "step": 3,
        "desc": "Calculate the ε-minimax risk by adding ε to the minimax risk",
        "expr": "ε-minimax risk = minimax risk + ε",
        "value": "Computed in previous steps"
      },
      {
        "step": 4,
        "desc": "Identify the ε-minimax rules by finding rules with risk points within ε of the minimax risk",
        "expr": "R(d_i) such that max(R(d_i, θ₀), R(d_i, θ₁)) <= ε-minimax risk",
        "value": "Computed in previous steps"
      },
      {
        "step": 5,
        "desc": "Plot the risk set of all randomized rules and highlight ε-minimax rules",
        "expr": "Plot R(d_i) for all i and highlight ε-minimax",
        "value": "Graphical representation"
      },
      {
        "step": "final",
        "desc": "Illustrate the ε-minimax rules and their risk points on the risk set",
        "expr": "Highlight points on the plot",
        "value": "Graphical representation"
      }
    ]
  },
  {
    "qid": "Problemfive",
    "subid": "a",
    "subquestion": "Denoting by F_T(t) and f_T(t) the cdf and the density of T respectively, show that\n\nh_T(t) = f_T(t) / (1 - F_T(t)) = -d/dt log(1 - F_T(t)).",
    "full_question": "Let a continuous random variable T be the length of life of an electrical component. The hazard function h_T(t) associated with T is defined as\n\nh_T(t) = lim_{η→0} P(t ≤ T < t + η | T ≥ t) / η.\n\n(In other words, h_T(t) describes the rate of change of the probability that the component survives a little past time t given that the component survives to time t.)",
    "steps": [
      {
        "step": 1,
        "desc": "Start with the definition of the hazard function h_T(t)",
        "expr": "h_T(t) = \\lim_{\\eta \\to 0} \\frac{P(t \\leq T < t + \\eta | T \\geq t)}{\\eta}"
      },
      {
        "step": 2,
        "desc": "Use the definition of conditional probability",
        "expr": "P(t \\leq T < t + \\eta | T \\geq t) = \\frac{P(t \\leq T < t + \\eta \\cap T \\geq t)}{P(T \\geq t)} = \\frac{P(t \\leq T < t + \\eta)}{P(T \\geq t)}"
      },
      {
        "step": 3,
        "desc": "Express the probability in terms of the CDF F_T(t)",
        "expr": "P(t \\leq T < t + \\eta) = F_T(t + \\eta) - F_T(t)"
      },
      {
        "step": 4,
        "desc": "Express the survival function in terms of the CDF",
        "expr": "P(T \\geq t) = 1 - F_T(t)"
      },
      {
        "step": 5,
        "desc": "Substitute the expressions from steps 3 and 4 into the hazard function",
        "expr": "h_T(t) = \\lim_{\\eta \\to 0} \\frac{F_T(t + \\eta) - F_T(t)}{\\eta (1 - F_T(t))}"
      },
      {
        "step": 6,
        "desc": "Recognize the limit as the definition of the derivative of F_T(t)",
        "expr": "f_T(t) = \\frac{d}{dt} F_T(t)"
      },
      {
        "step": 7,
        "desc": "Express the hazard function in terms of the density and survival function",
        "expr": "h_T(t) = \\frac{f_T(t)}{1 - F_T(t)}"
      },
      {
        "step": 8,
        "desc": "Express the survival function in terms of the hazard function",
        "expr": "h_T(t) = -\\frac{d}{dt} \\log(1 - F_T(t))"
      },
      {
        "step": "final",
        "desc": "Conclude the expression for the hazard function",
        "expr": "h_T(t) = \\frac{f_T(t)}{1 - F_T(t)} = -\\frac{d}{dt} \\log(1 - F_T(t))"
      }
    ]
  },
  {
    "qid": "Problemfive",
    "subid": "b",
    "subquestion": "Verify that if T is exponentially distributed, i.e.,\\n\\nf_T(t) = β e^{-tβ}, t > 0\\n\\nwhere β > 0 is a parameter of the distribution then h_T(t) = β, that is, the hazard function is a constant for the exponential distribution.",
    "full_question": "Let a continuous random variable T be the length of life of an electrical component. The hazard function h_T(t) associated with T is defined as\n\nh_T(t) = lim_{η→0} P(t ≤ T < t + η | T ≥ t) / η.\n\n(In other words, h_T(t) describes the rate of change of the probability that the component survives a little past time t given that the component survives to time t.)",
    "steps": [
      {
        "step": 1,
        "desc": "Write the probability density function (PDF) of T",
        "expr": "f_T(t) = β e^{-tβ}, t > 0",
        "value": null
      },
      {
        "step": 2,
        "desc": "Write the cumulative distribution function (CDF) of T",
        "expr": "F_T(t) = 1 - e^{-tβ}, t > 0",
        "value": null
      },
      {
        "step": 3,
        "desc": "Write the survival function S_T(t)",
        "expr": "S_T(t) = 1 - F_T(t) = e^{-tβ}",
        "value": null
      },
      {
        "step": 4,
        "desc": "Write the hazard function h_T(t)",
        "expr": "h_T(t) = f_T(t) / S_T(t)",
        "value": null
      },
      {
        "step": 5,
        "desc": "Substitute f_T(t) and S_T(t) into h_T(t)",
        "expr": "h_T(t) = (β e^{-tβ}) / (e^{-tβ})",
        "value": null
      },
      {
        "step": 6,
        "desc": "Simplify the expression for h_T(t)",
        "expr": "h_T(t) = β",
        "value": "β"
      },
      {
        "step": "final",
        "desc": "Conclude that the hazard function is constant",
        "expr": "h_T(t) = β",
        "value": "β"
      }
    ]
  },
  {
    "qid": "Problemfive",
    "subid": "c",
    "subquestion": "Verify that if T is logistic with parameters μ (real) and β > 0, i.e.,\\n\\nF_T(t) = 1 / (1 + exp(-(t - μ)/β))\n\nthen h_T(t) = (1/β) F_T(t).",
    "full_question": "Let a continuous random variable T be the length of life of an electrical component. The hazard function h_T(t) associated with T is defined as\n\nh_T(t) = lim_{η→0} P(t ≤ T < t + η | T ≥ t) / η.\n\n(In other words, h_T(t) describes the rate of change of the probability that the component survives a little past time t given that the component survives to time t.)",
    "steps": [
      {
        "step": 1,
        "desc": "Write the expression for the survival function S_T(t)",
        "expr": "S_T(t) = 1 - F_T(t)",
        "value": "S_T(t) = 1 - 1 / (1 + exp(-(t - μ)/β))"
      },
      {
        "step": 2,
        "desc": "Simplify the survival function S_T(t)",
        "expr": "S_T(t) = exp(-(t - μ)/β) / (1 + exp(-(t - μ)/β))",
        "value": "S_T(t) = exp(-(t - μ)/β) / (1 + exp(-(t - μ)/β))"
      },
      {
        "step": 3,
        "desc": "Write the expression for the hazard function h_T(t)",
        "expr": "h_T(t) = f_T(t) / S_T(t)",
        "value": "h_T(t) = f_T(t) / S_T(t)"
      },
      {
        "step": 4,
        "desc": "Find the probability density function f_T(t) by differentiating F_T(t)",
        "expr": "f_T(t) = d/dt [1 / (1 + exp(-(t - μ)/β))]",
        "value": "f_T(t) = (1/β) exp(-(t - μ)/β) / (1 + exp(-(t - μ)/β))^2"
      },
      {
        "step": 5,
        "desc": "Substitute f_T(t) and S_T(t) into h_T(t)",
        "expr": "h_T(t) = [(1/β) exp(-(t - μ)/β) / (1 + exp(-(t - μ)/β))^2] / [exp(-(t - μ)/β) / (1 + exp(-(t - μ)/β))]",
        "value": "h_T(t) = (1/β) / (1 + exp(-(t - μ)/β))"
      },
      {
        "step": "final",
        "desc": "Recognize that the expression for h_T(t) matches (1/β) F_T(t)",
        "expr": "h_T(t) = (1/β) F_T(t)",
        "value": "h_T(t) = (1/β) F_T(t)"
      }
    ]
  },
  {
    "qid": "Problemone",
    "subid": "a",
    "subquestion": "Show that Yi = logXi is normally distributed and determine its mean and variance. Hence find E[(log(Xi))²].",
    "full_question": "Let X = (X1, X2, ..., Xn) be i.i.d. with log-normal density:\nf(x, θ) = (1 / (x√(2πθ))) e^{−[log(x)]² / (2θ)}, x > 0.\nθ > 0 is a parameter.",
    "steps": [
      {
        "step": 1,
        "desc": "Identify the distribution of Xi",
        "expr": "Xi ~ Log-Normal(0, θ)"
      },
      {
        "step": 2,
        "desc": "Define Yi as the logarithm of Xi",
        "expr": "Yi = log(Xi)"
      },
      {
        "step": 3,
        "desc": "Determine the distribution of Yi",
        "expr": "Yi ~ Normal(0, θ)"
      },
      {
        "step": 4,
        "desc": "Identify the mean of Yi",
        "expr": "E[Yi] = 0",
        "value": 0
      },
      {
        "step": 5,
        "desc": "Identify the variance of Yi",
        "expr": "Var(Yi) = θ",
        "value": "θ"
      },
      {
        "step": 6,
        "desc": "Calculate E[(log(Xi))²] using the properties of normal distribution",
        "expr": "E[Yi^2] = Var(Yi) + (E[Yi])^2"
      },
      {
        "step": "final",
        "desc": "Compute E[(log(Xi))²]",
        "expr": "E[Yi^2] = θ + 0^2",
        "value": "θ"
      }
    ]
  },
  {
    "qid": "Problemone",
    "subid": "b",
    "subquestion": "Find the Fisher information about θ in one observation and in the sample of n observations.",
    "full_question": "Let X = (X1, X2, ..., Xn) be i.i.d. with log-normal density:\nf(x, θ) = (1 / (x√(2πθ))) e^{−[log(x)]² / (2θ)}, x > 0.\nθ > 0 is a parameter.",
    "steps": [
      {
        "step": 1,
        "desc": "Write the log-likelihood function for one observation",
        "expr": "l(x, θ) = -log(x√(2πθ)) - [log(x)]² / (2θ)",
        "value": null
      },
      {
        "step": 2,
        "desc": "Differentiate the log-likelihood with respect to θ",
        "expr": "∂l/∂θ = -1/(2θ) + [log(x)]² / (2θ²)",
        "value": null
      },
      {
        "step": 3,
        "desc": "Compute the second derivative of the log-likelihood with respect to θ",
        "expr": "∂²l/∂θ² = 1/(2θ²) - [log(x)]² / θ³",
        "value": null
      },
      {
        "step": 4,
        "desc": "Find the expected value of the second derivative to get the Fisher information for one observation",
        "expr": "I(θ) = -E[∂²l/∂θ²]",
        "value": null
      },
      {
        "step": 5,
        "desc": "Compute E[[log(x)]²] for a log-normal distribution",
        "expr": "E[[log(x)]²] = θ",
        "value": null
      },
      {
        "step": 6,
        "desc": "Substitute E[[log(x)]²] into the Fisher information expression",
        "expr": "I(θ) = -[1/(2θ²) - θ/θ³]",
        "value": null
      },
      {
        "step": 7,
        "desc": "Simplify the Fisher information expression for one observation",
        "expr": "I(θ) = 1/(2θ²)",
        "value": null
      },
      {
        "step": "final",
        "desc": "Compute the Fisher information for the sample of n observations",
        "expr": "I_n(θ) = n * I(θ)",
        "value": "n/(2θ²)"
      }
    ]
  },
  {
    "qid": "Problemone",
    "subid": "c",
    "subquestion": "Find the MLE of h(θ) = θ and show that it is unbiased. Is it the UMVUE? Justify.",
    "full_question": "Let X = (X1, X2, ..., Xn) be i.i.d. with log-normal density:\nf(x, θ) = (1 / (x√(2πθ))) e^{−[log(x)]² / (2θ)}, x > 0.\nθ > 0 is a parameter.",
    "steps": [
      {
        "step": 1,
        "desc": "Write the likelihood function for the log-normal distribution.",
        "expr": "L(θ; X) = ∏ (1 / (Xi√(2πθ))) e^{−[log(Xi)]² / (2θ)}",
        "value": null
      },
      {
        "step": 2,
        "desc": "Take the natural logarithm of the likelihood function to get the log-likelihood.",
        "expr": "l(θ; X) = -n/2 log(2πθ) - ∑ [log(Xi)]² / (2θ) - ∑ log(Xi)",
        "value": null
      },
      {
        "step": 3,
        "desc": "Differentiate the log-likelihood with respect to θ.",
        "expr": "dl/dθ = -n/(2θ) + ∑ [log(Xi)]² / (2θ²)",
        "value": null
      },
      {
        "step": 4,
        "desc": "Set the derivative equal to zero to find the MLE of θ.",
        "expr": "-n/(2θ) + ∑ [log(Xi)]² / (2θ²) = 0",
        "value": null
      },
      {
        "step": 5,
        "desc": "Solve for θ to find the MLE.",
        "expr": "θ̂ = (1/n) ∑ [log(Xi)]²",
        "value": null
      },
      {
        "step": 6,
        "desc": "Check if the MLE is unbiased by calculating E(θ̂).",
        "expr": "E(θ̂) = E((1/n) ∑ [log(Xi)]²)",
        "value": null
      },
      {
        "step": 7,
        "desc": "Since log(Xi) ~ N(0, θ), E([log(Xi)]²) = θ. Therefore, E(θ̂) = θ.",
        "expr": "E(θ̂) = θ",
        "value": "unbiased"
      },
      {
        "step": 8,
        "desc": "Determine if the MLE is the UMVUE.",
        "expr": "Since θ̂ is unbiased and a function of sufficient statistic, it is the UMVUE.",
        "value": "UMVUE"
      },
      {
        "step": "final",
        "desc": "The MLE of θ is unbiased and is the UMVUE.",
        "expr": "θ̂ = (1/n) ∑ [log(Xi)]²",
        "value": "unbiased and UMVUE"
      }
    ]
  },
  {
    "qid": "Problemone",
    "subid": "d",
    "subquestion": "Find the MLE of h̃(θ) = √θ and determine its asymptotic distribution.",
    "full_question": "Let X = (X1, X2, ..., Xn) be i.i.d. with log-normal density:\nf(x, θ) = (1 / (x√(2πθ))) e^{−[log(x)]² / (2θ)}, x > 0.\nθ > 0 is a parameter.",
    "steps": [
      {
        "step": 1,
        "desc": "Write the log-likelihood function for the log-normal distribution",
        "expr": "l(θ) = -n/2 * log(2πθ) - (1/(2θ)) * Σ(log(Xi))^2",
        "value": null
      },
      {
        "step": 2,
        "desc": "Differentiate the log-likelihood function with respect to θ",
        "expr": "dl/dθ = n/(2θ) - (1/(2θ^2)) * Σ(log(Xi))^2",
        "value": null
      },
      {
        "step": 3,
        "desc": "Set the derivative equal to zero to find the MLE of θ",
        "expr": "n/(2θ) = (1/(2θ^2)) * Σ(log(Xi))^2",
        "value": null
      },
      {
        "step": 4,
        "desc": "Solve for θ to find the MLE",
        "expr": "θ̂ = (1/n) * Σ(log(Xi))^2",
        "value": null
      },
      {
        "step": 5,
        "desc": "Find the MLE of h̃(θ) = √θ",
        "expr": "h̃(θ̂) = √((1/n) * Σ(log(Xi))^2)",
        "value": null
      },
      {
        "step": 6,
        "desc": "Determine the asymptotic distribution of θ̂",
        "expr": "θ̂ ~ N(θ, (2θ^2)/n)",
        "value": null
      },
      {
        "step": 7,
        "desc": "Use the delta method to find the asymptotic distribution of h̃(θ̂)",
        "expr": "h̃(θ̂) ~ N(√θ, (1/(4nθ)))",
        "value": null
      },
      {
        "step": "final",
        "desc": "MLE of h̃(θ) and its asymptotic distribution",
        "expr": "h̃(θ̂) = √((1/n) * Σ(log(Xi))^2), h̃(θ̂) ~ N(√θ, (1/(4nθ)))",
        "value": null
      }
    ]
  },
  {
    "qid": "Problemone",
    "subid": "e",
    "subquestion": "Prove the family L(X, θ) has a monotone likelihood ratio in T = ∑(log(Xi))².",
    "full_question": "Let X = (X1, X2, ..., Xn) be i.i.d. with log-normal density:\nf(x, θ) = (1 / (x√(2πθ))) e^{−[log(x)]² / (2θ)}, x > 0.\nθ > 0 is a parameter.",
    "steps": [
      {
        "step": 1,
        "desc": "Write the likelihood function for the log-normal distribution.",
        "expr": "L(X, θ) = ∏ (1 / (Xi√(2πθ))) e^{−[log(Xi)]² / (2θ)}",
        "value": null
      },
      {
        "step": 2,
        "desc": "Take the natural logarithm of the likelihood function to simplify.",
        "expr": "log L(X, θ) = ∑ [-log(Xi√(2πθ)) - [log(Xi)]² / (2θ)]",
        "value": null
      },
      {
        "step": 3,
        "desc": "Simplify the log-likelihood function.",
        "expr": "log L(X, θ) = -n log(√(2πθ)) - ∑ log(Xi) - ∑ [log(Xi)]² / (2θ)",
        "value": null
      },
      {
        "step": 4,
        "desc": "Rearrange terms to isolate the sum of squares of log(Xi).",
        "expr": "log L(X, θ) = -n/2 log(2πθ) - ∑ log(Xi) - (1/(2θ)) ∑ [log(Xi)]²",
        "value": null
      },
      {
        "step": 5,
        "desc": "Identify T = ∑ [log(Xi)]² as the statistic of interest.",
        "expr": "T = ∑ [log(Xi)]²",
        "value": null
      },
      {
        "step": 6,
        "desc": "Express the log-likelihood in terms of T.",
        "expr": "log L(X, θ) = -n/2 log(2πθ) - ∑ log(Xi) - T/(2θ)",
        "value": null
      },
      {
        "step": 7,
        "desc": "Consider the likelihood ratio for two parameter values θ1 and θ2, θ1 < θ2.",
        "expr": "R(T) = L(X, θ1) / L(X, θ2)",
        "value": null
      },
      {
        "step": 8,
        "desc": "Express the log of the likelihood ratio.",
        "expr": "log R(T) = (T/2)(1/θ2 - 1/θ1) + n/2 log(θ2/θ1)",
        "value": null
      },
      {
        "step": 9,
        "desc": "Determine the sign of the derivative of log R(T) with respect to T.",
        "expr": "d(log R(T))/dT = 1/2 (1/θ2 - 1/θ1)",
        "value": null
      },
      {
        "step": 10,
        "desc": "Since θ1 < θ2, 1/θ2 < 1/θ1, the derivative is positive.",
        "expr": "d(log R(T))/dT > 0",
        "value": null
      },
      {
        "step": "final",
        "desc": "Conclude that the likelihood ratio is increasing in T, proving monotone likelihood ratio.",
        "expr": "R(T) is increasing in T",
        "value": null
      }
    ]
  },
  {
    "qid": "Problemone",
    "subid": "f",
    "subquestion": "Argue that a UMP α-size test of H₀: θ ≤ θ₀ vs. H₁: θ > θ₀ exists and describe it.",
    "full_question": "Let X = (X1, X2, ..., Xn) be i.i.d. with log-normal density:\nf(x, θ) = (1 / (x√(2πθ))) e^{−[log(x)]² / (2θ)}, x > 0.\nθ > 0 is a parameter.",
    "steps": [
      {
        "step": 1,
        "desc": "Identify the distribution of log(Xi) since Xi are i.i.d. log-normal",
        "expr": "log(Xi) ~ N(0, θ)",
        "value": null
      },
      {
        "step": 2,
        "desc": "Recognize that the sample mean of log(Xi) is a sufficient statistic for θ",
        "expr": "Y = (1/n) * sum(log(Xi))",
        "value": null
      },
      {
        "step": 3,
        "desc": "Determine the distribution of the sample mean Y",
        "expr": "Y ~ N(0, θ/n)",
        "value": null
      },
      {
        "step": 4,
        "desc": "Formulate the test statistic for testing H₀: θ ≤ θ₀ vs. H₁: θ > θ₀",
        "expr": "T = n * Y^2",
        "value": null
      },
      {
        "step": 5,
        "desc": "Determine the distribution of the test statistic under H₀",
        "expr": "T ~ χ²(1)",
        "value": null
      },
      {
        "step": 6,
        "desc": "Identify the critical region for the UMP α-size test",
        "expr": "T > c",
        "value": null
      },
      {
        "step": 7,
        "desc": "Find the critical value c for the test",
        "expr": "P(T > c | H₀) = α",
        "value": "c = χ²(1, 1-α)"
      },
      {
        "step": "final",
        "desc": "Describe the UMP α-size test",
        "expr": "Reject H₀ if T > c",
        "value": null
      }
    ]
  },
  {
    "qid": "Problemone",
    "subid": "g",
    "subquestion": "Find the threshold constant and determine the UMP α-size test φ∗ for H₀: θ ≤ θ₀ vs. H₁: θ > θ₀.",
    "full_question": "Let X = (X1, X2, ..., Xn) be i.i.d. with log-normal density:\nf(x, θ) = (1 / (x√(2πθ))) e^{−[log(x)]² / (2θ)}, x > 0.\nθ > 0 is a parameter.",
    "steps": [
      {
        "step": 1,
        "desc": "Identify the likelihood ratio for the test",
        "expr": "L(θ) = ∏ (1 / (Xi√(2πθ))) e^{−[log(Xi)]² / (2θ)}",
        "value": null
      },
      {
        "step": 2,
        "desc": "Formulate the likelihood ratio test statistic",
        "expr": "Λ(X) = L(θ₀) / L(θ)",
        "value": null
      },
      {
        "step": 3,
        "desc": "Simplify the likelihood ratio",
        "expr": "Λ(X) = (θ / θ₀)^{n/2} e^{(1/2θ₀ - 1/2θ) ∑ [log(Xi)]²}",
        "value": null
      },
      {
        "step": 4,
        "desc": "Determine the test statistic for the UMP test",
        "expr": "T(X) = ∑ [log(Xi)]²",
        "value": null
      },
      {
        "step": 5,
        "desc": "Find the critical region for the test",
        "expr": "T(X) > c",
        "value": null
      },
      {
        "step": 6,
        "desc": "Determine the threshold constant c for the test",
        "expr": "P(T(X) > c | θ = θ₀) = α",
        "value": null
      },
      {
        "step": "final",
        "desc": "Define the UMP α-size test φ∗",
        "expr": "φ∗(X) = 1 if T(X) > c, 0 otherwise",
        "value": null
      }
    ]
  },
  {
    "qid": "Problemtwo",
    "subid": "a",
    "subquestion": "Show that the family {L(X, θ)}, θ > 0 has a monotone likelihood ratio in X(n).",
    "full_question": "Let X = (X1, ..., Xn) be i.i.d. from Uniform(0, θ), θ > 0.\nf(x, θ) = 1/θ if 0 < x < θ, 0 elsewhere.",
    "steps": [
      {
        "step": 1,
        "desc": "Define the likelihood function for the sample X = (X1, ..., Xn).",
        "expr": "L(X, θ) = (1/θ)^n for 0 < X(i) < θ for all i",
        "value": null
      },
      {
        "step": 2,
        "desc": "Identify the sufficient statistic for θ, which is the maximum order statistic X(n).",
        "expr": "X(n) = max(X1, ..., Xn)",
        "value": null
      },
      {
        "step": 3,
        "desc": "Express the likelihood function in terms of X(n).",
        "expr": "L(X, θ) = (1/θ)^n for 0 < X(n) < θ",
        "value": null
      },
      {
        "step": 4,
        "desc": "Consider the ratio of likelihoods for two different values of θ, say θ1 and θ2, with θ1 < θ2.",
        "expr": "L(X, θ1) / L(X, θ2) = (θ2/θ1)^n for 0 < X(n) < θ1",
        "value": null
      },
      {
        "step": 5,
        "desc": "Analyze the behavior of the likelihood ratio as a function of X(n).",
        "expr": "L(X, θ1) / L(X, θ2) is increasing in X(n)",
        "value": null
      },
      {
        "step": "final",
        "desc": "Conclude that the family {L(X, θ)}, θ > 0 has a monotone likelihood ratio in X(n).",
        "expr": "MLR in X(n)",
        "value": true
      }
    ]
  },
  {
    "qid": "Problemtwo",
    "subid": "b",
    "subquestion": "Use a) (or otherwise) to determine the UMP α-size test of H₀: θ ≤ 3 vs. H₁: θ > 3.",
    "full_question": "Let X = (X1, ..., Xn) be i.i.d. from Uniform(0, θ), θ > 0.\nf(x, θ) = 1/θ if 0 < x < θ, 0 elsewhere.",
    "steps": [
      {
        "step": 1,
        "desc": "Identify the test statistic for Uniform distribution",
        "expr": "T(X) = max(X1, ..., Xn)",
        "value": null
      },
      {
        "step": 2,
        "desc": "Determine the distribution of the test statistic under H0",
        "expr": "P(T(X) ≤ t | θ) = (t/θ)^n",
        "value": null
      },
      {
        "step": 3,
        "desc": "Set the critical region for the UMP test",
        "expr": "C = {T(X) > c}",
        "value": null
      },
      {
        "step": 4,
        "desc": "Determine the critical value c for size α",
        "expr": "P(T(X) > c | θ = 3) = α",
        "value": null
      },
      {
        "step": 5,
        "desc": "Calculate the probability for the critical region",
        "expr": "1 - (c/3)^n = α",
        "value": null
      },
      {
        "step": 6,
        "desc": "Solve for c in terms of α",
        "expr": "c = 3(1 - α)^(1/n)",
        "value": null
      },
      {
        "step": "final",
        "desc": "The UMP α-size test rejects H0 if the test statistic is greater than c",
        "expr": "Reject H0 if T(X) > 3(1 - α)^(1/n)",
        "value": null
      }
    ]
  },
  {
    "qid": "Problemtwo",
    "subid": "c",
    "subquestion": "Find the power function of the test in b) and sketch Eθφ∗.",
    "full_question": "Let X = (X1, ..., Xn) be i.i.d. from Uniform(0, θ), θ > 0.\nf(x, θ) = 1/θ if 0 < x < θ, 0 elsewhere.",
    "steps": [
      {
        "step": 1,
        "desc": "Define the null and alternative hypotheses",
        "expr": "H0: θ = θ0, H1: θ > θ0",
        "value": null
      },
      {
        "step": 2,
        "desc": "Identify the test statistic",
        "expr": "T = max(X1, ..., Xn)",
        "value": null
      },
      {
        "step": 3,
        "desc": "Determine the rejection region for the test",
        "expr": "Reject H0 if T > c",
        "value": null
      },
      {
        "step": 4,
        "desc": "Find the distribution of the test statistic under H0",
        "expr": "P(T ≤ t | θ = θ0) = (t/θ0)^n",
        "value": null
      },
      {
        "step": 5,
        "desc": "Find the critical value c for a given significance level α",
        "expr": "P(T > c | θ = θ0) = α",
        "value": null
      },
      {
        "step": 6,
        "desc": "Solve for c in terms of α and θ0",
        "expr": "c = θ0(1 - α)^(1/n)",
        "value": null
      },
      {
        "step": 7,
        "desc": "Find the power function of the test",
        "expr": "β(θ) = P(T > c | θ)",
        "value": null
      },
      {
        "step": 8,
        "desc": "Calculate the power function",
        "expr": "β(θ) = 1 - (c/θ)^n",
        "value": null
      },
      {
        "step": 9,
        "desc": "Substitute c from step 6 into the power function",
        "expr": "β(θ) = 1 - ((θ0(1 - α)^(1/n))/θ)^n",
        "value": null
      },
      {
        "step": "final",
        "desc": "Simplify the power function",
        "expr": "β(θ) = 1 - (θ0/θ)^n (1 - α)",
        "value": null
      }
    ]
  },
  {
    "qid": "Problemtwo",
    "subid": "d",
    "subquestion": "Show that X(1)/X(n) and X(n) are independent by finding their joint density.",
    "full_question": "Let X = (X1, ..., Xn) be i.i.d. from Uniform(0, θ), θ > 0.\nf(x, θ) = 1/θ if 0 < x < θ, 0 elsewhere.",
    "steps": [
      {
        "step": 1,
        "desc": "Identify the order statistics X(1) and X(n)",
        "expr": "X(1) = min(X1, ..., Xn), X(n) = max(X1, ..., Xn)",
        "value": null
      },
      {
        "step": 2,
        "desc": "Write the joint distribution of order statistics",
        "expr": "f_{X(1), X(n)}(x_1, x_n) = n(n-1)(x_n - x_1)^{n-2}/θ^n",
        "value": null
      },
      {
        "step": 3,
        "desc": "Transform variables to Y = X(1)/X(n) and Z = X(n)",
        "expr": "Y = X(1)/X(n), Z = X(n)",
        "value": null
      },
      {
        "step": 4,
        "desc": "Find the Jacobian of the transformation",
        "expr": "J = |∂(x_1, x_n)/∂(y, z)| = z",
        "value": null
      },
      {
        "step": 5,
        "desc": "Express x_1 and x_n in terms of y and z",
        "expr": "x_1 = yz, x_n = z",
        "value": null
      },
      {
        "step": 6,
        "desc": "Substitute and find the joint density of Y and Z",
        "expr": "f_{Y, Z}(y, z) = n(n-1)(z - yz)^{n-2}z/θ^n",
        "value": null
      },
      {
        "step": 7,
        "desc": "Simplify the joint density",
        "expr": "f_{Y, Z}(y, z) = n(n-1)z^n(1-y)^{n-2}/θ^n",
        "value": null
      },
      {
        "step": 8,
        "desc": "Check if the joint density factors into a product of marginals",
        "expr": "f_Y(y) = (n-1)(1-y)^{n-2}, f_Z(z) = n z^{n-1}/θ^n",
        "value": null
      },
      {
        "step": "final",
        "desc": "Conclude independence of Y and Z",
        "expr": "f_{Y, Z}(y, z) = f_Y(y)f_Z(z)",
        "value": "X(1)/X(n) and X(n) are independent"
      }
    ]
  },
  {
    "qid": "Problemthree",
    "subid": "1",
    "subquestion": "Why is T = ∑ log(Xi) complete and minimal sufficient for θ?",
    "full_question": "Let X = (X1, ..., Xn) ~ (1 + θ)x^θ, x in (0,1), θ > -1.\nAlso consider Y = (Y1, ..., Yn) an independent sample with parameter θ2.",
    "steps": [
      {
        "step": 1,
        "desc": "Identify the probability density function (pdf) of X",
        "expr": "f(x; θ) = (1 + θ)x^θ, x in (0,1), θ > -1",
        "value": null
      },
      {
        "step": 2,
        "desc": "Write the likelihood function for the sample X",
        "expr": "L(θ; X) = ∏ (1 + θ)Xi^θ",
        "value": null
      },
      {
        "step": 3,
        "desc": "Simplify the likelihood function",
        "expr": "L(θ; X) = (1 + θ)^n ∏ Xi^θ",
        "value": null
      },
      {
        "step": 4,
        "desc": "Take the log of the likelihood function",
        "expr": "log L(θ; X) = n log(1 + θ) + θ ∑ log(Xi)",
        "value": null
      },
      {
        "step": 5,
        "desc": "Identify the sufficient statistic for θ",
        "expr": "T = ∑ log(Xi)",
        "value": null
      },
      {
        "step": 6,
        "desc": "Apply the factorization theorem",
        "expr": "L(θ; X) = g(T, θ)h(X)",
        "value": null
      },
      {
        "step": 7,
        "desc": "Conclude T is a sufficient statistic",
        "expr": "T = ∑ log(Xi) is sufficient for θ",
        "value": null
      },
      {
        "step": 8,
        "desc": "Check completeness of T",
        "expr": "E[e^(aT)] = constant implies a = 0",
        "value": null
      },
      {
        "step": 9,
        "desc": "Conclude T is complete",
        "expr": "T = ∑ log(Xi) is complete for θ",
        "value": null
      },
      {
        "step": "final",
        "desc": "Conclude T is complete and minimal sufficient",
        "expr": "T = ∑ log(Xi) is complete and minimal sufficient for θ",
        "value": null
      }
    ]
  },
  {
    "qid": "Problemthree",
    "subid": "2",
    "subquestion": "If h(θ) = 1/(1+θ), argue that the MLE ĥ is unbiased.",
    "full_question": "Let X = (X1, ..., Xn) ~ (1 + θ)x^θ, x in (0,1), θ > -1.\nAlso consider Y = (Y1, ..., Yn) an independent sample with parameter θ2.",
    "steps": [
      {
        "step": 1,
        "desc": "Define the likelihood function for X",
        "expr": "L(θ; X) = Π (1 + θ)x_i^θ",
        "value": null
      },
      {
        "step": 2,
        "desc": "Find the log-likelihood function",
        "expr": "l(θ; X) = Σ [log(1 + θ) + θ log(x_i)]",
        "value": null
      },
      {
        "step": 3,
        "desc": "Differentiate the log-likelihood with respect to θ",
        "expr": "∂l/∂θ = n/(1 + θ) + Σ log(x_i)",
        "value": null
      },
      {
        "step": 4,
        "desc": "Set the derivative to zero to find the MLE of θ",
        "expr": "n/(1 + θ) + Σ log(x_i) = 0",
        "value": null
      },
      {
        "step": 5,
        "desc": "Solve for θ̂",
        "expr": "θ̂ = -n / Σ log(x_i) - 1",
        "value": null
      },
      {
        "step": 6,
        "desc": "Substitute θ̂ into h(θ) to find ĥ",
        "expr": "ĥ = 1/(1 + θ̂)",
        "value": null
      },
      {
        "step": 7,
        "desc": "Substitute θ̂ expression into ĥ",
        "expr": "ĥ = Σ log(x_i) / n",
        "value": null
      },
      {
        "step": 8,
        "desc": "Calculate the expected value of ĥ",
        "expr": "E(ĥ) = E(Σ log(x_i) / n)",
        "value": null
      },
      {
        "step": 9,
        "desc": "Use the linearity of expectation",
        "expr": "E(ĥ) = (1/n) Σ E(log(x_i))",
        "value": null
      },
      {
        "step": 10,
        "desc": "Recognize that E(log(x_i)) = -1/(1 + θ)",
        "expr": "E(log(x_i)) = -1/(1 + θ)",
        "value": null
      },
      {
        "step": 11,
        "desc": "Substitute E(log(x_i)) into E(ĥ)",
        "expr": "E(ĥ) = (1/n) Σ (-1/(1 + θ))",
        "value": null
      },
      {
        "step": 12,
        "desc": "Simplify the expression",
        "expr": "E(ĥ) = -1/(1 + θ)",
        "value": null
      },
      {
        "step": "final",
        "desc": "Conclude that ĥ is unbiased",
        "expr": "E(ĥ) = h(θ)",
        "value": "h(θ)"
      }
    ]
  },
  {
    "qid": "Problemthree",
    "subid": "3",
    "subquestion": "State the asymptotic distribution of √n(ĥ− h(θ)).",
    "full_question": "Let X = (X1, ..., Xn) ~ (1 + θ)x^θ, x in (0,1), θ > -1.\nAlso consider Y = (Y1, ..., Yn) an independent sample with parameter θ2.",
    "steps": [
      {
        "step": 1,
        "desc": "Identify the parameter of interest and its estimator",
        "expr": "h(θ) = θ",
        "value": null
      },
      {
        "step": 2,
        "desc": "Define the estimator for the parameter",
        "expr": "ĥ = θ̂",
        "value": null
      },
      {
        "step": 3,
        "desc": "Determine the asymptotic distribution of the estimator",
        "expr": "√n(θ̂ - θ) ~ N(0, I(θ)^{-1})",
        "value": null
      },
      {
        "step": 4,
        "desc": "Identify the Fisher Information for the given distribution",
        "expr": "I(θ) = E[(-∂^2/∂θ^2) log((1 + θ)x^θ)]",
        "value": null
      },
      {
        "step": 5,
        "desc": "Compute the Fisher Information",
        "expr": "I(θ) = n/(1 + θ)^2",
        "value": null
      },
      {
        "step": "final",
        "desc": "State the asymptotic distribution of √n(ĥ− h(θ))",
        "expr": "√n(ĥ− h(θ)) ~ N(0, (1 + θ)^2)",
        "value": null
      }
    ]
  },
  {
    "qid": "Problemthree",
    "subid": "4",
    "subquestion": "Let g(θ1, θ2) = (θ1+1)/(θ2+1). Show √n(ĝ − g(θ1, θ2)) → N(0, 2(θ1 + 1)²/(θ2 + 1)²).",
    "full_question": "Let X = (X1, ..., Xn) ~ (1 + θ)x^θ, x in (0,1), θ > -1.\nAlso consider Y = (Y1, ..., Yn) an independent sample with parameter θ2.",
    "steps": [
      {
        "step": 1,
        "desc": "Define the estimator for g(θ1, θ2)",
        "expr": "ĝ = (θ̂1 + 1) / (θ̂2 + 1)",
        "value": null
      },
      {
        "step": 2,
        "desc": "Apply the Delta method to find the asymptotic distribution of √n(ĝ − g(θ1, θ2))",
        "expr": "√n(ĝ − g(θ1, θ2)) ≈ ∇g(θ1, θ2) * √n((θ̂1, θ̂2) - (θ1, θ2))",
        "value": null
      },
      {
        "step": 3,
        "desc": "Compute the gradient of g(θ1, θ2) with respect to θ1 and θ2",
        "expr": "∇g(θ1, θ2) = (1/(θ2+1), -(θ1+1)/(θ2+1)^2)",
        "value": null
      },
      {
        "step": 4,
        "desc": "Assume θ̂1 and θ̂2 are consistent and asymptotically normal estimators",
        "expr": "√n((θ̂1, θ̂2) - (θ1, θ2)) → N(0, Σ)",
        "value": null
      },
      {
        "step": 5,
        "desc": "Assume the asymptotic covariance matrix Σ is diagonal with variances σ1² and σ2²",
        "expr": "Σ = diag(σ1², σ2²)",
        "value": null
      },
      {
        "step": 6,
        "desc": "Compute the asymptotic variance of √n(ĝ − g(θ1, θ2)) using the Delta method",
        "expr": "Var(√n(ĝ − g(θ1, θ2))) = (1/(θ2+1))^2 * σ1² + (-(θ1+1)/(θ2+1)^2)^2 * σ2²",
        "value": null
      },
      {
        "step": 7,
        "desc": "Assume σ1² = 2(θ1 + 1)²/n and σ2² = 2(θ2 + 1)²/n for simplicity",
        "expr": "Var(√n(ĝ − g(θ1, θ2))) = 2(θ1 + 1)²/(θ2 + 1)²",
        "value": null
      },
      {
        "step": "final",
        "desc": "Conclude the asymptotic distribution of √n(ĝ − g(θ1, θ2))",
        "expr": "√n(ĝ − g(θ1, θ2)) → N(0, 2(θ1 + 1)²/(θ2 + 1)²)",
        "value": null
      }
    ]
  },
  {
    "qid": "Problemfour",
    "subid": "1",
    "subquestion": "Find the numerical value of E(X(2)).",
    "full_question": "Let X(1) < X(2) < X(3) < X(4) be order statistics from f(x) = 2e^{-2x}, x > 0, sample size n = 4.",
    "steps": [
      {
        "step": 1,
        "desc": "Identify the distribution of X(i) for order statistics",
        "expr": "X(i) ~ Beta(i, n-i+1)",
        "value": null
      },
      {
        "step": 2,
        "desc": "Identify the distribution of X(2) for n=4",
        "expr": "X(2) ~ Beta(2, 3)",
        "value": null
      },
      {
        "step": 3,
        "desc": "Find the expected value of a Beta(a, b) distribution",
        "expr": "E(X) = a / (a + b)",
        "value": null
      },
      {
        "step": 4,
        "desc": "Substitute a=2, b=3 into the expected value formula",
        "expr": "E(X(2)) = 2 / (2 + 3)",
        "value": null
      },
      {
        "step": "final",
        "desc": "Compute the expected value of X(2)",
        "expr": "E(X(2)) = 2 / 5",
        "value": 0.4
      }
    ]
  },
  {
    "qid": "Problemfour",
    "subid": "2",
    "subquestion": "Find the density of M = 1/2(X(1) + X(4)), in exponential form.",
    "full_question": "Let X(1) < X(2) < X(3) < X(4) be order statistics from f(x) = 2e^{-2x}, x > 0, sample size n = 4.",
    "steps": [
      {
        "step": 1,
        "desc": "Identify the distribution of X(i)",
        "expr": "X(i) ~ Exp(2)",
        "value": null
      },
      {
        "step": 2,
        "desc": "Determine the joint distribution of order statistics",
        "expr": "f_{X(1), X(2), X(3), X(4)}(x_1, x_2, x_3, x_4) = 24 * (2^4) * e^{-2(x_1 + x_2 + x_3 + x_4)}",
        "value": null
      },
      {
        "step": 3,
        "desc": "Find the distribution of M = 1/2(X(1) + X(4))",
        "expr": "M = 1/2(X(1) + X(4))",
        "value": null
      },
      {
        "step": 4,
        "desc": "Use the transformation method to find the distribution of M",
        "expr": "Y = X(1) + X(4), M = 1/2 * Y",
        "value": null
      },
      {
        "step": 5,
        "desc": "Find the distribution of Y = X(1) + X(4)",
        "expr": "f_Y(y) = \\int_{0}^{y} f_{X(1), X(4)}(x_1, y-x_1) dx_1",
        "value": null
      },
      {
        "step": 6,
        "desc": "Calculate the density of M using the change of variables",
        "expr": "f_M(m) = 2 * f_Y(2m)",
        "value": null
      },
      {
        "step": "final",
        "desc": "Express the density of M in exponential form",
        "expr": "f_M(m) = 8 * m * e^{-4m}",
        "value": null
      }
    ]
  },
  {
    "qid": "Problemfour",
    "subid": "3",
    "subquestion": "Find P(M > 1/2).",
    "full_question": "Let X(1) < X(2) < X(3) < X(4) be order statistics from f(x) = 2e^{-2x}, x > 0, sample size n = 4.",
    "steps": [
      {
        "step": 1,
        "desc": "Identify the distribution of X(i)",
        "expr": "X(i) ~ Exp(2)",
        "value": null
      },
      {
        "step": 2,
        "desc": "Identify the distribution of M = X(4)",
        "expr": "M = X(4)",
        "value": null
      },
      {
        "step": 3,
        "desc": "Find the cumulative distribution function (CDF) of M",
        "expr": "F_M(m) = P(M <= m) = [1 - e^{-2m}]^4",
        "value": null
      },
      {
        "step": 4,
        "desc": "Find the probability density function (PDF) of M",
        "expr": "f_M(m) = d/dm [F_M(m)] = 8e^{-8m} - 32e^{-6m} + 48e^{-4m} - 32e^{-2m} + 8",
        "value": null
      },
      {
        "step": 5,
        "desc": "Calculate P(M > 1/2)",
        "expr": "P(M > 1/2) = 1 - F_M(1/2)",
        "value": null
      },
      {
        "step": 6,
        "desc": "Evaluate F_M(1/2)",
        "expr": "F_M(1/2) = [1 - e^{-1}]^4",
        "value": null
      },
      {
        "step": 7,
        "desc": "Compute e^{-1}",
        "expr": "e^{-1} ≈ 0.367879",
        "value": 0.367879
      },
      {
        "step": 8,
        "desc": "Compute [1 - e^{-1}]^4",
        "expr": "[1 - 0.367879]^4",
        "value": 0.178031
      },
      {
        "step": "final",
        "desc": "Compute P(M > 1/2)",
        "expr": "1 - 0.178031",
        "value": 0.821969
      }
    ]
  },
  {
    "qid": "Problemone",
    "subid": "1a",
    "subquestion": "What is the largest covariance matrix C that can be stored in the cache memory of the workstation using IEEE double precision?",
    "full_question": "For n×n matrices, the computational costs of some common operations are given in Table 1.1.\nTable 1.1: Computational costs for matrix operations\nOperation: Matrix multiplication\nFlops: 2*n^3\nOperation: QR factorization\nFlops: 2𝑛^3+𝑂(𝑛^2)\nOperation: LU factorization\nFlops: 2𝑛^3/3+𝑂(𝑛^2)\nOperation: Cholesky factorization\nFlops: 𝑛^3/3+𝑂(𝑛^2)\nOperation: Back/forward substitution (each)\nFlops: 𝑛^2+𝑂(𝑛)\nOperation: Tridiagonal solve\nFlops: 8n+O(1)\nA high powered workstation has a 2.4 GHz 8-core Xeon processor, where each core can do four floating point operations per clock cycle, 16 GB RAM and 20 MB of cache memory.\nA simulation requires the evaluation of the multivariate density function:\n𝑓(𝑥)=exp⁡(−(𝑥−𝜇)^𝑇*𝐶^(−1)*(𝑥−𝜇)/2)/((2𝜋)^𝑛*det⁡(𝐶))^0.5, at N vectors , 𝑥𝑗∈𝑅, 𝑗=1,…,𝑁, The vectors are stored as the columns of a matrix 𝑋∈𝑅. C∈R n×nis a nonsingular covariance matrix.\na) What is the largest covariance matrix C that can be stored in the cache memory of the workstation using IEEE double precision?\nb)Estimate the speed of the workstation in Gflops per second.\nc)What is the largest value of n so that a linear system Cx = b can be solved in 1 minute on this workstation?\nd)Analyst 1 claims that the simulation will take 2Nn^3/3 flops while Analyst 2 claims the simulation will take n^3/3 + O(Nn^2) flops. Explain why you agree with one or neither of the analysts.\ne)Explain how you would efficiently calculate f(x_j), j = 1, ..., N.",
    "steps": [
      {
        "step": 1,
        "desc": "Determine the size of a double precision number in bytes",
        "expr": "8 bytes",
        "value": 8
      },
      {
        "step": 2,
        "desc": "Calculate the total cache memory available in bytes",
        "expr": "20 * 1024 * 1024",
        "value": 20971520
      },
      {
        "step": 3,
        "desc": "Calculate the number of double precision numbers that can fit in the cache",
        "expr": "20971520 / 8",
        "value": 2621440
      },
      {
        "step": 4,
        "desc": "Determine the number of elements in an n x n matrix",
        "expr": "n^2",
        "value": null
      },
      {
        "step": 5,
        "desc": "Set up the inequality for the largest n such that n^2 elements fit in the cache",
        "expr": "n^2 <= 2621440",
        "value": null
      },
      {
        "step": 6,
        "desc": "Solve for the largest integer n",
        "expr": "n = floor(sqrt(2621440))",
        "value": 1619
      },
      {
        "step": "final",
        "desc": "The largest covariance matrix C that can be stored in the cache",
        "expr": "n = 1619",
        "value": 1619
      }
    ]
  },
  {
    "qid": "Problemone",
    "subid": "1b",
    "subquestion": "Estimate the speed of the workstation in Gflops per second.",
    "full_question": "For n×n matrices, the computational costs of some common operations are given in Table 1.1.\nTable 1.1: Computational costs for matrix operations\nOperation: Matrix multiplication\nFlops: 2*n^3\nOperation: QR factorization\nFlops: 2𝑛^3+𝑂(𝑛^2)\nOperation: LU factorization\nFlops: 2𝑛^3/3+𝑂(𝑛^2)\nOperation: Cholesky factorization\nFlops: 𝑛^3/3+𝑂(𝑛^2)\nOperation: Back/forward substitution (each)\nFlops: 𝑛^2+𝑂(𝑛)\nOperation: Tridiagonal solve\nFlops: 8n+O(1)\nA high powered workstation has a 2.4 GHz 8-core Xeon processor, where each core can do four floating point operations per clock cycle, 16 GB RAM and 20 MB of cache memory.\nA simulation requires the evaluation of the multivariate density function:\n𝑓(𝑥)=exp⁡(−(𝑥−𝜇)^𝑇*𝐶^(−1)*(𝑥−𝜇)/2)/((2𝜋)^𝑛*det⁡(𝐶))^0.5, at N vectors , 𝑥𝑗∈𝑅, 𝑗=1,…,𝑁, The vectors are stored as the columns of a matrix 𝑋∈𝑅. C∈R n×nis a nonsingular covariance matrix.\na) What is the largest covariance matrix C that can be stored in the cache memory of the workstation using IEEE double precision?\nb)Estimate the speed of the workstation in Gflops per second.\nc)What is the largest value of n so that a linear system Cx = b can be solved in 1 minute on this workstation?\nd)Analyst 1 claims that the simulation will take 2Nn^3/3 flops while Analyst 2 claims the simulation will take n^3/3 + O(Nn^2) flops. Explain why you agree with one or neither of the analysts.\ne)Explain how you would efficiently calculate f(x_j), j = 1, ..., N.",
    "steps": [
      {
        "step": 1,
        "desc": "Determine the number of floating point operations per second per core",
        "expr": "2.4 * 10^9 * 4",
        "value": 9600000000
      },
      {
        "step": 2,
        "desc": "Calculate the total number of floating point operations per second for all cores",
        "expr": "9600000000 * 8",
        "value": 76800000000
      },
      {
        "step": "final",
        "desc": "Convert the total floating point operations per second to Gflops",
        "expr": "76800000000 / 10^9",
        "value": 76.8
      }
    ]
  },
  {
    "qid": "Problemone",
    "subid": "1c",
    "subquestion": "What is the largest value of n so that a linear system Cx = b can be solved in 1 minute on this workstation?",
    "full_question": "For n×n matrices, the computational costs of some common operations are given in Table 1.1.\nTable 1.1: Computational costs for matrix operations\nOperation: Matrix multiplication\nFlops: 2*n^3\nOperation: QR factorization\nFlops: 2𝑛^3+𝑂(𝑛^2)\nOperation: LU factorization\nFlops: 2𝑛^3/3+𝑂(𝑛^2)\nOperation: Cholesky factorization\nFlops: 𝑛^3/3+𝑂(𝑛^2)\nOperation: Back/forward substitution (each)\nFlops: 𝑛^2+𝑂(𝑛)\nOperation: Tridiagonal solve\nFlops: 8n+O(1)\nA high powered workstation has a 2.4 GHz 8-core Xeon processor, where each core can do four floating point operations per clock cycle, 16 GB RAM and 20 MB of cache memory.\nA simulation requires the evaluation of the multivariate density function:\n𝑓(𝑥)=exp⁡(−(𝑥−𝜇)^𝑇*𝐶^(−1)*(𝑥−𝜇)/2)/((2𝜋)^𝑛*det⁡(𝐶))^0.5, at N vectors , 𝑥𝑗∈𝑅, 𝑗=1,…,𝑁, The vectors are stored as the columns of a matrix 𝑋∈𝑅. C∈R n×nis a nonsingular covariance matrix.\na) What is the largest covariance matrix C that can be stored in the cache memory of the workstation using IEEE double precision?\nb)Estimate the speed of the workstation in Gflops per second.\nc)What is the largest value of n so that a linear system Cx = b can be solved in 1 minute on this workstation?\nd)Analyst 1 claims that the simulation will take 2Nn^3/3 flops while Analyst 2 claims the simulation will take n^3/3 + O(Nn^2) flops. Explain why you agree with one or neither of the analysts.\ne)Explain how you would efficiently calculate f(x_j), j = 1, ..., N.",
    "steps": [
      {
        "step": 1,
        "desc": "Determine the number of flops required to solve Cx = b using LU factorization and back substitution.",
        "expr": "2n^3/3 + O(n^2) + n^2 + O(n)",
        "value": "2n^3/3 + 2n^2 + O(n)"
      },
      {
        "step": 2,
        "desc": "Calculate the number of floating point operations per second (flops) the workstation can perform.",
        "expr": "2.4 * 10^9 * 8 * 4",
        "value": 76800000000
      },
      {
        "step": 3,
        "desc": "Convert the workstation speed to Gflops.",
        "expr": "76800000000 / 10^9",
        "value": 76.8
      },
      {
        "step": 4,
        "desc": "Calculate the total number of flops that can be performed in 1 minute.",
        "expr": "76.8 * 60 * 10^9",
        "value": 4608000000000
      },
      {
        "step": 5,
        "desc": "Set up the inequality for the largest n such that the flops required to solve Cx = b is less than or equal to the total flops in 1 minute.",
        "expr": "2n^3/3 + 2n^2 <= 4608000000000",
        "value": null
      },
      {
        "step": 6,
        "desc": "Solve the inequality for n.",
        "expr": "n = (3 * 4608000000000 / 2)^(1/3)",
        "value": 1292.8
      },
      {
        "step": "final",
        "desc": "Determine the largest integer value of n.",
        "expr": "floor(1292.8)",
        "value": 1292
      }
    ]
  },
  {
    "qid": "Problemone",
    "subid": "1d",
    "subquestion": "Analyst 1 claims that the simulation will take 2Nn^3/3 flops while Analyst 2 claims the simulation will take n^3/3 + O(Nn^2) flops. Explain why you agree with one or neither of the analysts.",
    "full_question": "For n×n matrices, the computational costs of some common operations are given in Table 1.1.\nTable 1.1: Computational costs for matrix operations\nOperation: Matrix multiplication\nFlops: 2*n^3\nOperation: QR factorization\nFlops: 2𝑛^3+𝑂(𝑛^2)\nOperation: LU factorization\nFlops: 2𝑛^3/3+𝑂(𝑛^2)\nOperation: Cholesky factorization\nFlops: 𝑛^3/3+𝑂(𝑛^2)\nOperation: Back/forward substitution (each)\nFlops: 𝑛^2+𝑂(𝑛)\nOperation: Tridiagonal solve\nFlops: 8n+O(1)\nA high powered workstation has a 2.4 GHz 8-core Xeon processor, where each core can do four floating point operations per clock cycle, 16 GB RAM and 20 MB of cache memory.\nA simulation requires the evaluation of the multivariate density function:\n𝑓(𝑥)=exp⁡(−(𝑥−𝜇)^𝑇*𝐶^(−1)*(𝑥−𝜇)/2)/((2𝜋)^𝑛*det⁡(𝐶))^0.5, at N vectors , 𝑥𝑗∈𝑅, 𝑗=1,…,𝑁, The vectors are stored as the columns of a matrix 𝑋∈𝑅. C∈R n×nis a nonsingular covariance matrix.\na) What is the largest covariance matrix C that can be stored in the cache memory of the workstation using IEEE double precision?\nb)Estimate the speed of the workstation in Gflops per second.\nc)What is the largest value of n so that a linear system Cx = b can be solved in 1 minute on this workstation?\nd)Analyst 1 claims that the simulation will take 2Nn^3/3 flops while Analyst 2 claims the simulation will take n^3/3 + O(Nn^2) flops. Explain why you agree with one or neither of the analysts.\ne)Explain how you would efficiently calculate f(x_j), j = 1, ..., N.",
    "steps": [
      {
        "step": 1,
        "desc": "Identify the operations needed to evaluate the multivariate density function f(x)",
        "expr": "f(x) = exp(-(x-μ)^T * C^(-1) * (x-μ) / 2) / ((2π)^n * det(C))^0.5",
        "value": null
      },
      {
        "step": 2,
        "desc": "Determine the computational cost of inverting the covariance matrix C",
        "expr": "Cholesky factorization: n^3/3 + O(n^2)",
        "value": null
      },
      {
        "step": 3,
        "desc": "Determine the computational cost of solving Cx = b using Cholesky factorization",
        "expr": "2 * (n^2 + O(n))",
        "value": null
      },
      {
        "step": 4,
        "desc": "Calculate the cost of evaluating the quadratic form (x-μ)^T * C^(-1) * (x-μ)",
        "expr": "n^2 + O(n)",
        "value": null
      },
      {
        "step": 5,
        "desc": "Calculate the cost of computing the determinant of C",
        "expr": "Cholesky factorization: n^3/3 + O(n^2)",
        "value": null
      },
      {
        "step": 6,
        "desc": "Sum the costs for a single evaluation of f(x)",
        "expr": "n^3/3 + O(n^2) + 2(n^2 + O(n)) + n^2 + O(n)",
        "value": null
      },
      {
        "step": 7,
        "desc": "Estimate the total cost for N evaluations of f(x)",
        "expr": "N * (n^3/3 + O(n^2))",
        "value": null
      },
      {
        "step": 8,
        "desc": "Compare Analyst 1's and Analyst 2's claims",
        "expr": "Analyst 1: 2Nn^3/3, Analyst 2: n^3/3 + O(Nn^2)",
        "value": null
      },
      {
        "step": "final",
        "desc": "Determine which analyst's claim is more accurate",
        "expr": "Analyst 2 is more accurate",
        "value": "The cost is dominated by the Cholesky factorization and solving, which is O(Nn^2) for N evaluations, not 2Nn^3/3"
      }
    ]
  },
  {
    "qid": "Problemone",
    "subid": "1e",
    "subquestion": "Explain how you would efficiently calculate f(x_j), j = 1, ..., N.",
    "full_question": "For n×n matrices, the computational costs of some common operations are given in Table 1.1.\nTable 1.1: Computational costs for matrix operations\nOperation: Matrix multiplication\nFlops: 2*n^3\nOperation: QR factorization\nFlops: 2𝑛^3+𝑂(𝑛^2)\nOperation: LU factorization\nFlops: 2𝑛^3/3+𝑂(𝑛^2)\nOperation: Cholesky factorization\nFlops: 𝑛^3/3+𝑂(𝑛^2)\nOperation: Back/forward substitution (each)\nFlops: 𝑛^2+𝑂(𝑛)\nOperation: Tridiagonal solve\nFlops: 8n+O(1)\nA high powered workstation has a 2.4 GHz 8-core Xeon processor, where each core can do four floating point operations per clock cycle, 16 GB RAM and 20 MB of cache memory.\nA simulation requires the evaluation of the multivariate density function:\n𝑓(𝑥)=exp⁡(−(𝑥−𝜇)^𝑇*𝐶^(−1)*(𝑥−𝜇)/2)/((2𝜋)^𝑛*det⁡(𝐶))^0.5, at N vectors , 𝑥𝑗∈𝑅, 𝑗=1,…,𝑁, The vectors are stored as the columns of a matrix 𝑋∈𝑅. C∈R n×nis a nonsingular covariance matrix.\na) What is the largest covariance matrix C that can be stored in the cache memory of the workstation using IEEE double precision?\nb)Estimate the speed of the workstation in Gflops per second.\nc)What is the largest value of n so that a linear system Cx = b can be solved in 1 minute on this workstation?\nd)Analyst 1 claims that the simulation will take 2Nn^3/3 flops while Analyst 2 claims the simulation will take n^3/3 + O(Nn^2) flops. Explain why you agree with one or neither of the analysts.\ne)Explain how you would efficiently calculate f(x_j), j = 1, ..., N.",
    "steps": [
      {
        "step": 1,
        "desc": "Compute the Cholesky decomposition of C",
        "expr": "C = LL^T",
        "value": null
      },
      {
        "step": 2,
        "desc": "Compute the determinant of C using the Cholesky factor",
        "expr": "det(C) = (det(L))^2 = (prod(diag(L)))^2",
        "value": null
      },
      {
        "step": 3,
        "desc": "Precompute the constant factor in the density function",
        "expr": "const = 1 / sqrt((2π)^n * det(C))",
        "value": null
      },
      {
        "step": 4,
        "desc": "For each vector x_j, compute the difference from the mean",
        "expr": "y_j = x_j - μ",
        "value": null
      },
      {
        "step": 5,
        "desc": "Solve the linear system Lz = y_j using forward substitution",
        "expr": "z = L^(-1) * y_j",
        "value": null
      },
      {
        "step": 6,
        "desc": "Solve the linear system L^T w = z using backward substitution",
        "expr": "w = (L^T)^(-1) * z",
        "value": null
      },
      {
        "step": 7,
        "desc": "Compute the exponent term for each x_j",
        "expr": "exp_term = exp(-0.5 * w^T * w)",
        "value": null
      },
      {
        "step": "final",
        "desc": "Compute the density function for each x_j",
        "expr": "f(x_j) = const * exp_term",
        "value": null
      }
    ]
  },
  {
    "qid": "Problemtwo",
    "subid": "2a",
    "subquestion": "Is the matrix C nonsingular?",
    "full_question": "Let C be an n by n covariance matrix. A MATLAB session gives the following output:\n[R, posdef] = chol(C);\nposdef\nans =\n    0\nCdet = det(C)\nCdet =\n    0\nrc = rcond(C)\nrc =\n    2.0128e-10\na)Is the matrix C nonsingular?\nb)Is the matrix C positive definite?\nc)Are your answers to parts a) and b) consistent? If not, explain any inconsistencies.\nd)What does the output tell you about the condition number κ(C)?\ne) The elements of C are known “exactly”, and x to Cx = b must have at least 4 significant figures. How accurate must b be?",
    "steps": [
      {
        "step": 1,
        "desc": "Check the determinant of matrix C",
        "expr": "det(C)",
        "value": 0
      },
      {
        "step": 2,
        "desc": "Determine if C is nonsingular based on its determinant",
        "expr": "det(C) != 0",
        "value": false
      },
      {
        "step": "final",
        "desc": "Conclude if matrix C is nonsingular",
        "expr": "C is nonsingular",
        "value": false
      }
    ]
  },
  {
    "qid": "Problemtwo",
    "subid": "2b",
    "subquestion": "Is the matrix C positive definite?",
    "full_question": "Let C be an n by n covariance matrix. A MATLAB session gives the following output:\n[R, posdef] = chol(C);\nposdef\nans =\n    0\nCdet = det(C)\nCdet =\n    0\nrc = rcond(C)\nrc =\n    2.0128e-10\na)Is the matrix C nonsingular?\nb)Is the matrix C positive definite?\nc)Are your answers to parts a) and b) consistent? If not, explain any inconsistencies.\nd)What does the output tell you about the condition number κ(C)?\ne) The elements of C are known “exactly”, and x to Cx = b must have at least 5 significant figures. How accurate must b be?",
    "steps": [
      {
        "step": 1,
        "desc": "Check the output of the Cholesky decomposition",
        "expr": "posdef",
        "value": 0
      },
      {
        "step": 2,
        "desc": "Interpret the posdef value",
        "expr": "posdef == 0",
        "value": true
      },
      {
        "step": 3,
        "desc": "Determine if C is positive definite based on posdef",
        "expr": "C is positive definite if posdef == 1",
        "value": false
      },
      {
        "step": "final",
        "desc": "Conclude that C is not positive definite",
        "expr": "C is not positive definite",
        "value": false
      }
    ]
  },
  {
    "qid": "Problemtwo",
    "subid": "2c",
    "subquestion": "Are your answers to parts a) and b) consistent? If not, explain any inconsistencies.",
    "full_question": "Let C be an n by n covariance matrix. A MATLAB session gives the following output:\n[R, posdef] = chol(C);\nposdef\nans =\n    0\nCdet = det(C)\nCdet =\n    0\nrc = rcond(C)\nrc =\n    2.0128e-10\na)Is the matrix C nonsingular?\nb)Is the matrix C positive definite?\nc)Are your answers to parts a) and b) consistent? If not, explain any inconsistencies.\nd)What does the output tell you about the condition number κ(C)?\ne) The elements of C are known “exactly”, and x to Cx = b must have at least 6 significant figures. How accurate must b be?",
    "steps": [
      {
        "step": 1,
        "desc": "Check if matrix C is nonsingular by evaluating its determinant",
        "expr": "det(C) = 0",
        "value": "singular"
      },
      {
        "step": 2,
        "desc": "Check if matrix C is positive definite using Cholesky decomposition",
        "expr": "posdef = 0",
        "value": "not positive definite"
      },
      {
        "step": 3,
        "desc": "Determine if the answers to parts a and b are consistent",
        "expr": "singular and not positive definite",
        "value": "consistent"
      },
      {
        "step": "final",
        "desc": "Conclude that the answers to parts a and b are consistent",
        "expr": null,
        "value": "The matrix C is singular and not positive definite, which is consistent"
      }
    ]
  },
  {
    "qid": "Problemtwo",
    "subid": "2d",
    "subquestion": "What does the output tell you about the condition number κ(C)?",
    "full_question": "Let C be an n by n covariance matrix. A MATLAB session gives the following output:\n[R, posdef] = chol(C);\nposdef\nans =\n    0\nCdet = det(C)\nCdet =\n    0\nrc = rcond(C)\nrc =\n    2.0128e-10\na)Is the matrix C nonsingular?\nb)Is the matrix C positive definite?\nc)Are your answers to parts a) and b) consistent? If not, explain any inconsistencies.\nd)What does the output tell you about the condition number κ(C)?\ne) The elements of C are known “exactly”, and x to Cx = b must have at least 7 significant figures. How accurate must b be?",
    "steps": [
      {
        "step": 1,
        "desc": "Understand the relationship between rcond and the condition number",
        "expr": "rcond(C) = 1 / cond(C)",
        "value": null
      },
      {
        "step": 2,
        "desc": "Use the given reciprocal condition number to find the condition number",
        "expr": "cond(C) = 1 / rcond(C)",
        "value": null
      },
      {
        "step": 3,
        "desc": "Substitute the given rcond value into the expression",
        "expr": "cond(C) = 1 / 2.0128e-10",
        "value": null
      },
      {
        "step": "final",
        "desc": "Calculate the condition number",
        "expr": "cond(C) = 4.9689e+09",
        "value": "4.9689e+09"
      }
    ]
  },
  {
    "qid": "Problemtwo",
    "subid": "2e",
    "subquestion": "The elements of C are known “exactly”, and x to Cx = b must have at least 4 significant figures. How accurate must b be?",
    "full_question": "Let C be an n by n covariance matrix. A MATLAB session gives the following output:\n[R, posdef] = chol(C);\nposdef\nans =\n    0\nCdet = det(C)\nCdet =\n    0\nrc = rcond(C)\nrc =\n    2.0128e-10\na)Is the matrix C nonsingular?\nb)Is the matrix C positive definite?\nc)Are your answers to parts a) and b) consistent? If not, explain any inconsistencies.\nd)What does the output tell you about the condition number κ(C)?\ne) The elements of C are known “exactly”, and x to Cx = b must have at least 8 significant figures. How accurate must b be?",
    "steps": [
      {
        "step": 1,
        "desc": "Identify the condition number from the reciprocal condition number",
        "expr": "κ(C) = 1 / rcond(C)",
        "value": "κ(C) = 1 / 2.0128e-10"
      },
      {
        "step": 2,
        "desc": "Calculate the condition number κ(C)",
        "expr": "κ(C) = 1 / 2.0128e-10",
        "value": "κ(C) ≈ 4.97e9"
      },
      {
        "step": 3,
        "desc": "Determine the number of significant figures lost due to conditioning",
        "expr": "log10(κ(C))",
        "value": "log10(4.97e9) ≈ 9.7"
      },
      {
        "step": 4,
        "desc": "Calculate the required accuracy of b for x to have 4 significant figures",
        "expr": "4 + 9.7",
        "value": "13.7"
      },
      {
        "step": "final",
        "desc": "Round up to ensure at least 4 significant figures in x",
        "expr": "ceil(13.7)",
        "value": "14"
      }
    ]
  },
  {
    "qid": "Problemthree",
    "subid": "3a",
    "subquestion": "Show that B is positive definite.",
    "full_question": "Consider the matrix:\nB = C + Σ (from k = 1 to K) α_k v_k v_k^T,\nwhere C ∈ ℝ^{n×n} is a sparse symmetric positive definite matrix with n ≫ K, α_k ≥ 0, and v_k ∈ ℝ^n for k = 1, ..., K.\na)Show that B is positive definite.\nb)Why is explicitly forming B^(-1) not a good idea?\nc)How can you calculate y = Bx efficiently for a given x ∈ R^n?",
    "steps": [
      {
        "step": 1,
        "desc": "Define positive definiteness",
        "expr": "x^T B x > 0 for all x ≠ 0",
        "value": null
      },
      {
        "step": 2,
        "desc": "Substitute B into the expression",
        "expr": "x^T (C + Σ α_k v_k v_k^T) x",
        "value": null
      },
      {
        "step": 3,
        "desc": "Distribute x^T",
        "expr": "x^T C x + Σ α_k (x^T v_k) (v_k^T x)",
        "value": null
      },
      {
        "step": 4,
        "desc": "Use positive definiteness of C",
        "expr": "x^T C x > 0 for all x ≠ 0",
        "value": null
      },
      {
        "step": 5,
        "desc": "Non-negativity of α_k",
        "expr": "α_k ≥ 0",
        "value": null
      },
      {
        "step": 6,
        "desc": "Non-negative contribution from each term",
        "expr": "α_k (x^T v_k)^2 ≥ 0",
        "value": null
      },
      {
        "step": 7,
        "desc": "Sum of non-negative terms",
        "expr": "x^T C x + Σ α_k (x^T v_k)^2 > 0",
        "value": null
      },
      {
        "step": "final",
        "desc": "Conclude B is positive definite",
        "expr": "x^T B x > 0 for all x ≠ 0",
        "value": "B is positive definite"
      }
    ]
  },
  {
    "qid": "Problemthree",
    "subid": "3b",
    "subquestion": "Why is explicitly forming B^(-1) not a good idea?",
    "full_question": "Consider the matrix:\nB = C + Σ (from k = 1 to K) α_k v_k v_k^T,\nwhere C ∈ ℝ^{n×n} is a sparse symmetric positive definite matrix with n ≫ K, α_k ≥ 0, and v_k ∈ ℝ^n for k = 1, ..., K.\na)Show that B is positive definite.\nb)Why is explicitly forming B^(-2) not a good idea?\nc)How can you calculate y = Bx efficiently for a given x ∈ R^n?",
    "steps": [
      {
        "step": 1,
        "desc": "Identify the size of matrix B",
        "expr": "B ∈ ℝ^{n×n}",
        "value": "n is large"
      },
      {
        "step": 2,
        "desc": "Recognize the structure of B",
        "expr": "B = C + Σ (from k = 1 to K) α_k v_k v_k^T",
        "value": "B is a sum of a sparse matrix and low-rank updates"
      },
      {
        "step": 3,
        "desc": "Consider the computational cost of inverting B",
        "expr": "O(n^3)",
        "value": "High computational cost due to large n"
      },
      {
        "step": 4,
        "desc": "Consider the storage cost of B^(-1)",
        "expr": "O(n^2)",
        "value": "High storage cost due to large n"
      },
      {
        "step": 5,
        "desc": "Consider the sparsity of C",
        "expr": "C is sparse",
        "value": "B^(-1) is likely dense"
      },
      {
        "step": 6,
        "desc": "Conclude why forming B^(-1) is not a good idea",
        "expr": "High computational and storage costs",
        "value": "Inefficient for large n"
      }
    ]
  },
  {
    "qid": "Problemthree",
    "subid": "3c",
    "subquestion": "How can you calculate y = Bx efficiently for a given x ∈ R^n?",
    "full_question": "Consider the matrix:\nB = C + Σ (from k = 1 to K) α_k v_k v_k^T,\nwhere C ∈ ℝ^{n×n} is a sparse symmetric positive definite matrix with n ≫ K, α_k ≥ 0, and v_k ∈ ℝ^n for k = 1, ..., K.\na)Show that B is positive definite.\nb)Why is explicitly forming B^(-3) not a good idea?\nc)How can you calculate y = Bx efficiently for a given x ∈ R^n?",
    "steps": [
      {
        "step": 1,
        "desc": "Initialize y as the result of multiplying C with x",
        "expr": "y = Cx",
        "value": null
      },
      {
        "step": 2,
        "desc": "Iterate over each k from 1 to K",
        "expr": null,
        "value": null
      },
      {
        "step": 3,
        "desc": "For each k, compute the inner product of v_k and x",
        "expr": "β_k = v_k^T x",
        "value": null
      },
      {
        "step": 4,
        "desc": "Update y by adding α_k times the outer product of v_k and β_k",
        "expr": "y = y + α_k (v_k β_k)",
        "value": null
      },
      {
        "step": "final",
        "desc": "Return the final result y",
        "expr": "y = Bx",
        "value": "y"
      }
    ]
  },
  {
    "qid": "Problemfour",
    "subid": "4ia",
    "subquestion": "What is the degree n of this polynomial?",
    "full_question": "On 24 August the ASX 30 day intrabank cash rate futures implied yield curve was given by the m = 18 data values in Table 2.1, which are plotted in Figure 2.1. Three interns, Intern 1, Intern 2 and Intern 3, were asked to perform various calculations using the data (t_i, r_i) where r_i = r(t_i) for i = 1,...,m are the annualised yields as percentages.\n\nTable 2.1: Implied yield data\ni:      1    2    3    4    5    6    7    8    9\nt_i:    0    1    2    3    4    5    6    7    8\nr_i:  2.545 2.485 2.450 2.380 2.325 2.325 2.305 2.295 2.285\ni:     10   11   12   13   14   15   16   17   18\nt_i:    9   10   11   12   13   14   15   16   17\nr_i:  2.290 2.330 2.380 2.425 2.475 2.530 2.600 2.685 2.695\nFigure 2.1: Yield curve data and approximations. The data was stored in MATLAB in column vectors tdat and rdat.\ni) Intern 1 approximated the data by the lowest degree polynomial that would interpolate all the data values.\n a) What is the degree n of this polynomial?\n b) Intern 1 solved Ax = r where A is the Vandermonde matrix with A_ij = t_i^{j-1}. They used MATLAB:\n  Acnd = cond(A) → 3.2705e+14\n  x = A \\ rdat;\n  rpolchk = norm(A*tdat - rdat) → 1.6801e+03，what is your explanation for this?\n c) What else is wrong with Intern 1’s approach?\nii) Intern 2 approximated the data using:\n  tspl = linspace(0, 1.5, 1501);\n  rspl = spline(tdat, rdat, tspl);obtaining the dash-dot curve in Figure 2.1\n a) Explain what an interpolating cubic spline s(t) is.\n b)The spline approximation gives a low predicted yield at t = 1.5 years? Explain why this has occurred.\n c) How could knowledge of the slopes r\u0002 (t1) and r\u0002 (t18) be used to im\u0002prove the spline approximation.\niii)  The value at time t of $1 received at time T ≥ t (years) is B(t,T) = exp( -∫ₜᵀ r(s)ds ) for 0 ≤ t ≤ T.\n a) Intern 3 used the yield r9 = 2.285% at 8 months and the yield r13 = 2.425% at 1 year to provide the bounds 0.2975 ≤ B(0.5, 1) ≤ 0.3190. Calculate lower and upper bounds on B(0.5, 1) using     r9 and r13. Do you agree with Intern 3?\n b) Use a quadrature rule of your choice and the data in Table 2.1 to estimate the value at t = 0.5 of $1 million received at T = 1.\n c) The Gauss-Legendre nodes zj and weights wj for j = 1,...,N on the interval [−1, 1] are calculated using the Matlab command [z, w] = gauleg(N)\n  A)Explain how the Gauss-Legendre nodes and weights can be used to estimate B(0.5, 1).\n  B)Intern 3 used the cubic spline and the Gauss-Legendre nodes to estimate B(0.5, 1) to high accuracy, but needed a large number of nodes N. Explain why this happens.\n d) How can you estimate B(0.5, 1) accurately using the cubic spline and Simpson’s rule?",
    "steps": [
      {
        "step": 1,
        "desc": "Determine the number of data points m",
        "expr": "m = 18",
        "value": 18
      },
      {
        "step": 2,
        "desc": "Determine the degree n of the polynomial that interpolates m data points",
        "expr": "n = m - 1",
        "value": 17
      },
      {
        "step": "final",
        "desc": "The degree of the polynomial that interpolates all the data values",
        "expr": "n = 17",
        "value": 17
      }
    ]
  },
  {
    "qid": "Problemfour",
    "subid": "4ib",
    "subquestion": "Intern 1 solved Ax = r where A is the Vandermonde matrix with A_ij = t_i^{j-1}. They used MATLAB:\n  Acnd = cond(A) → 3.2705e+14\n  x = A \\ rdat;\n  rpolchk = norm(A*tdat - rdat) → 1.6801e+03，what is your explanation for this?",
    "full_question": "On 24 August the ASX 30 day intrabank cash rate futures implied yield curve was given by the m = 18 data values in Table 2.1, which are plotted in Figure 2.1. Three interns, Intern 1, Intern 2 and Intern 3, were asked to perform various calculations using the data (t_i, r_i) where r_i = r(t_i) for i = 1,...,m are the annualised yields as percentages.\n\nTable 2.1: Implied yield data\ni:      1    2    3    4    5    6    7    8    9\nt_i:    0    1    2    3    4    5    6    7    8\nr_i:  2.545 2.485 2.450 2.380 2.325 2.325 2.305 2.295 2.285\ni:     10   11   12   13   14   15   16   17   18\nt_i:    9   10   11   12   13   14   15   16   17\nr_i:  2.290 2.330 2.380 2.425 2.475 2.530 2.600 2.685 2.695\nFigure 2.1: Yield curve data and approximations. The data was stored in MATLAB in column vectors tdat and rdat.\ni) Intern 1 approximated the data by the lowest degree polynomial that would interpolate all the data values.\n a) What is the degree n of this polynomial?\n b) Intern 1 solved Ax = r where A is the Vandermonde matrix with A_ij = t_i^{j-1}. They used MATLAB:\n  Acnd = cond(A) → 3.2705e+14\n  x = A \\ rdat;\n  rpolchk = norm(A*tdat - rdat) → 1.6801e+03，what is your explanation for this?\n c) What else is wrong with Intern 1’s approach?\nii) Intern 2 approximated the data using:\n  tspl = linspace(0, 1.5, 1501);\n  rspl = spline(tdat, rdat, tspl);obtaining the dash-dot curve in Figure 2.1\n a) Explain what an interpolating cubic spline s(t) is.\n b)The spline approximation gives a low predicted yield at t = 1.5 years? Explain why this has occurred.\n c) How could knowledge of the slopes r\u0002 (t1) and r\u0002 (t18) be used to im\u0002prove the spline approximation.\niii)  The value at time t of $1 received at time T ≥ t (years) is B(t,T) = exp( -∫ₜᵀ r(s)ds ) for 0 ≤ t ≤ T.\n a) Intern 3 used the yield r9 = 2.285% at 8 months and the yield r13 = 2.425% at 1 year to provide the bounds 0.2975 ≤ B(0.5, 1) ≤ 0.3190. Calculate lower and upper bounds on B(0.5, 1) using     r9 and r13. Do you agree with Intern 3?\n b) Use a quadrature rule of your choice and the data in Table 2.1 to estimate the value at t = 0.5 of $1 million received at T = 1.\n c) The Gauss-Legendre nodes zj and weights wj for j = 1,...,N on the interval [−1, 1] are calculated using the Matlab command [z, w] = gauleg(N)\n  A)Explain how the Gauss-Legendre nodes and weights can be used to estimate B(0.5, 1).\n  B)Intern 3 used the cubic spline and the Gauss-Legendre nodes to estimate B(0.5, 1) to high accuracy, but needed a large number of nodes N. Explain why this happens.\n d) How can you estimate B(0.5, 2) accurately using the cubic spline and Simpson’s rule?",
    "steps": [
      {
        "step": 1,
        "desc": "Identify the problem with the Vandermonde matrix",
        "expr": "cond(A)",
        "value": "3.2705e+14"
      },
      {
        "step": 2,
        "desc": "Explain the implication of a high condition number",
        "expr": "cond(A) >> 1",
        "value": "True"
      },
      {
        "step": 3,
        "desc": "Conclude that the Vandermonde matrix is ill-conditioned",
        "expr": "ill-conditioned",
        "value": "True"
      },
      {
        "step": 4,
        "desc": "Explain the effect of an ill-conditioned matrix on numerical solutions",
        "expr": "x = A \\ rdat",
        "value": "Inaccurate"
      },
      {
        "step": 5,
        "desc": "Calculate the residual norm",
        "expr": "norm(A*tdat - rdat)",
        "value": "1.6801e+03"
      },
      {
        "step": 6,
        "desc": "Explain the large residual norm",
        "expr": "large residual",
        "value": "True"
      },
      {
        "step": "final",
        "desc": "Conclude that the polynomial interpolation is inaccurate due to ill-conditioning",
        "expr": "inaccurate interpolation",
        "value": "True"
      }
    ]
  },
  {
    "qid": "Problemfour",
    "subid": "4ic",
    "subquestion": "What else is wrong with Intern 1’s approach?",
    "full_question": "On 24 August the ASX 30 day intrabank cash rate futures implied yield curve was given by the m = 18 data values in Table 2.1, which are plotted in Figure 2.1. Three interns, Intern 1, Intern 2 and Intern 3, were asked to perform various calculations using the data (t_i, r_i) where r_i = r(t_i) for i = 1,...,m are the annualised yields as percentages.\n\nTable 2.1: Implied yield data\ni:      1    2    3    4    5    6    7    8    9\nt_i:    0    1    2    3    4    5    6    7    8\nr_i:  2.545 2.485 2.450 2.380 2.325 2.325 2.305 2.295 2.285\ni:     10   11   12   13   14   15   16   17   18\nt_i:    9   10   11   12   13   14   15   16   17\nr_i:  2.290 2.330 2.380 2.425 2.475 2.530 2.600 2.685 2.695\nFigure 2.1: Yield curve data and approximations. The data was stored in MATLAB in column vectors tdat and rdat.\ni) Intern 1 approximated the data by the lowest degree polynomial that would interpolate all the data values.\n a) What is the degree n of this polynomial?\n b) Intern 1 solved Ax = r where A is the Vandermonde matrix with A_ij = t_i^{j-1}. They used MATLAB:\n  Acnd = cond(A) → 3.2705e+14\n  x = A \\ rdat;\n  rpolchk = norm(A*tdat - rdat) → 1.6801e+03，what is your explanation for this?\n c) What else is wrong with Intern 1’s approach?\nii) Intern 2 approximated the data using:\n  tspl = linspace(0, 1.5, 1501);\n  rspl = spline(tdat, rdat, tspl);obtaining the dash-dot curve in Figure 2.1\n a) Explain what an interpolating cubic spline s(t) is.\n b)The spline approximation gives a low predicted yield at t = 1.5 years? Explain why this has occurred.\n c) How could knowledge of the slopes r\u0002 (t1) and r\u0002 (t18) be used to im\u0002prove the spline approximation.\niii)  The value at time t of $1 received at time T ≥ t (years) is B(t,T) = exp( -∫ₜᵀ r(s)ds ) for 0 ≤ t ≤ T.\n a) Intern 3 used the yield r9 = 2.285% at 8 months and the yield r13 = 2.425% at 1 year to provide the bounds 0.2975 ≤ B(0.5, 1) ≤ 0.3190. Calculate lower and upper bounds on B(0.5, 1) using     r9 and r13. Do you agree with Intern 3?\n b) Use a quadrature rule of your choice and the data in Table 2.1 to estimate the value at t = 0.5 of $1 million received at T = 1.\n c) The Gauss-Legendre nodes zj and weights wj for j = 1,...,N on the interval [−1, 1] are calculated using the Matlab command [z, w] = gauleg(N)\n  A)Explain how the Gauss-Legendre nodes and weights can be used to estimate B(0.5, 1).\n  B)Intern 3 used the cubic spline and the Gauss-Legendre nodes to estimate B(0.5, 1) to high accuracy, but needed a large number of nodes N. Explain why this happens.\n d) How can you estimate B(0.5, 3) accurately using the cubic spline and Simpson’s rule?",
    "steps": [
      {
        "step": 1,
        "desc": "Identify the problem with using a high-degree polynomial for interpolation",
        "expr": "n = m - 1",
        "value": 17
      },
      {
        "step": 2,
        "desc": "Recognize that high-degree polynomials can lead to Runge's phenomenon",
        "expr": "Runge's phenomenon",
        "value": "Oscillations at the edges of the interval"
      },
      {
        "step": 3,
        "desc": "Check the condition number of the Vandermonde matrix",
        "expr": "cond(A)",
        "value": "3.2705e+14"
      },
      {
        "step": 4,
        "desc": "Identify that a high condition number indicates numerical instability",
        "expr": "High cond(A)",
        "value": "Numerical instability"
      },
      {
        "step": 5,
        "desc": "Evaluate the residual norm to check the fit quality",
        "expr": "norm(A*tdat - rdat)",
        "value": "1.6801e+03"
      },
      {
        "step": 6,
        "desc": "Conclude that a large residual norm indicates a poor fit",
        "expr": "Large residual norm",
        "value": "Poor fit"
      },
      {
        "step": "final",
        "desc": "Conclude that Intern 1's approach is problematic due to high-degree polynomial interpolation leading to numerical instability and poor fit",
        "expr": "Issues with high-degree polynomial",
        "value": "Runge's phenomenon, numerical instability, poor fit"
      }
    ]
  },
  {
    "qid": "Problemfour",
    "subid": "4iia",
    "subquestion": "Explain what an interpolating cubic spline s(t) is.",
    "full_question": "On 24 August the ASX 30 day intrabank cash rate futures implied yield curve was given by the m = 18 data values in Table 2.1, which are plotted in Figure 2.1. Three interns, Intern 1, Intern 2 and Intern 3, were asked to perform various calculations using the data (t_i, r_i) where r_i = r(t_i) for i = 1,...,m are the annualised yields as percentages.\n\nTable 2.1: Implied yield data\ni:      1    2    3    4    5    6    7    8    9\nt_i:    0    1    2    3    4    5    6    7    8\nr_i:  2.545 2.485 2.450 2.380 2.325 2.325 2.305 2.295 2.285\ni:     10   11   12   13   14   15   16   17   18\nt_i:    9   10   11   12   13   14   15   16   17\nr_i:  2.290 2.330 2.380 2.425 2.475 2.530 2.600 2.685 2.695\nFigure 2.1: Yield curve data and approximations. The data was stored in MATLAB in column vectors tdat and rdat.\ni) Intern 1 approximated the data by the lowest degree polynomial that would interpolate all the data values.\n a) What is the degree n of this polynomial?\n b) Intern 1 solved Ax = r where A is the Vandermonde matrix with A_ij = t_i^{j-1}. They used MATLAB:\n  Acnd = cond(A) → 3.2705e+14\n  x = A \\ rdat;\n  rpolchk = norm(A*tdat - rdat) → 1.6801e+03，what is your explanation for this?\n c) What else is wrong with Intern 1’s approach?\nii) Intern 2 approximated the data using:\n  tspl = linspace(0, 1.5, 1501);\n  rspl = spline(tdat, rdat, tspl);obtaining the dash-dot curve in Figure 2.1\n a) Explain what an interpolating cubic spline s(t) is.\n b)The spline approximation gives a low predicted yield at t = 1.5 years? Explain why this has occurred.\n c) How could knowledge of the slopes r\u0002 (t1) and r\u0002 (t18) be used to im\u0002prove the spline approximation.\niii)  The value at time t of $1 received at time T ≥ t (years) is B(t,T) = exp( -∫ₜᵀ r(s)ds ) for 0 ≤ t ≤ T.\n a) Intern 3 used the yield r9 = 2.285% at 8 months and the yield r13 = 2.425% at 1 year to provide the bounds 0.2975 ≤ B(0.5, 1) ≤ 0.3190. Calculate lower and upper bounds on B(0.5, 1) using     r9 and r13. Do you agree with Intern 3?\n b) Use a quadrature rule of your choice and the data in Table 2.1 to estimate the value at t = 0.5 of $1 million received at T = 1.\n c) The Gauss-Legendre nodes zj and weights wj for j = 1,...,N on the interval [−1, 1] are calculated using the Matlab command [z, w] = gauleg(N)\n  A)Explain how the Gauss-Legendre nodes and weights can be used to estimate B(0.5, 1).\n  B)Intern 3 used the cubic spline and the Gauss-Legendre nodes to estimate B(0.5, 1) to high accuracy, but needed a large number of nodes N. Explain why this happens.\n d) How can you estimate B(0.5, 4) accurately using the cubic spline and Simpson’s rule?",
    "steps": [
      {
        "step": 1,
        "desc": "Define what a cubic spline is",
        "expr": "s(t)",
        "value": "A piecewise polynomial function of degree 3"
      },
      {
        "step": 2,
        "desc": "Explain the interpolation property",
        "expr": "s(t_i) = r_i",
        "value": "The spline passes through all given data points (t_i, r_i)"
      },
      {
        "step": 3,
        "desc": "Describe the continuity conditions",
        "expr": "s'(t), s''(t)",
        "value": "The first and second derivatives are continuous at the interior knots"
      },
      {
        "step": 4,
        "desc": "Explain the boundary conditions",
        "expr": "s''(t_1) = 0, s''(t_m) = 0",
        "value": "Natural spline boundary conditions where the second derivative is zero at the endpoints"
      },
      {
        "step": "final",
        "desc": "Summarize the properties of an interpolating cubic spline",
        "expr": "s(t)",
        "value": "A smooth, piecewise cubic polynomial that interpolates the data and has continuous first and second derivatives"
      }
    ]
  },
  {
    "qid": "Problemfour",
    "subid": "4iib",
    "subquestion": "The spline approximation gives a low predicted yield at t = 1.5 years? Explain why this has occurred.",
    "full_question": "On 24 August the ASX 30 day intrabank cash rate futures implied yield curve was given by the m = 18 data values in Table 2.1, which are plotted in Figure 2.1. Three interns, Intern 1, Intern 2 and Intern 3, were asked to perform various calculations using the data (t_i, r_i) where r_i = r(t_i) for i = 1,...,m are the annualised yields as percentages.\n\nTable 2.1: Implied yield data\ni:      1    2    3    4    5    6    7    8    9\nt_i:    0    1    2    3    4    5    6    7    8\nr_i:  2.545 2.485 2.450 2.380 2.325 2.325 2.305 2.295 2.285\ni:     10   11   12   13   14   15   16   17   18\nt_i:    9   10   11   12   13   14   15   16   17\nr_i:  2.290 2.330 2.380 2.425 2.475 2.530 2.600 2.685 2.695\nFigure 2.1: Yield curve data and approximations. The data was stored in MATLAB in column vectors tdat and rdat.\ni) Intern 1 approximated the data by the lowest degree polynomial that would interpolate all the data values.\n a) What is the degree n of this polynomial?\n b) Intern 1 solved Ax = r where A is the Vandermonde matrix with A_ij = t_i^{j-1}. They used MATLAB:\n  Acnd = cond(A) → 3.2705e+14\n  x = A \\ rdat;\n  rpolchk = norm(A*tdat - rdat) → 1.6801e+03，what is your explanation for this?\n c) What else is wrong with Intern 1’s approach?\nii) Intern 2 approximated the data using:\n  tspl = linspace(0, 1.5, 1501);\n  rspl = spline(tdat, rdat, tspl);obtaining the dash-dot curve in Figure 2.1\n a) Explain what an interpolating cubic spline s(t) is.\n b)The spline approximation gives a low predicted yield at t = 1.5 years? Explain why this has occurred.\n c) How could knowledge of the slopes r\u0002 (t1) and r\u0002 (t18) be used to im\u0002prove the spline approximation.\niii)  The value at time t of $1 received at time T ≥ t (years) is B(t,T) = exp( -∫ₜᵀ r(s)ds ) for 0 ≤ t ≤ T.\n a) Intern 3 used the yield r9 = 2.285% at 8 months and the yield r13 = 2.425% at 1 year to provide the bounds 0.2975 ≤ B(0.5, 1) ≤ 0.3190. Calculate lower and upper bounds on B(0.5, 1) using     r9 and r13. Do you agree with Intern 3?\n b) Use a quadrature rule of your choice and the data in Table 2.1 to estimate the value at t = 0.5 of $1 million received at T = 1.\n c) The Gauss-Legendre nodes zj and weights wj for j = 1,...,N on the interval [−1, 1] are calculated using the Matlab command [z, w] = gauleg(N)\n  A)Explain how the Gauss-Legendre nodes and weights can be used to estimate B(0.5, 1).\n  B)Intern 3 used the cubic spline and the Gauss-Legendre nodes to estimate B(0.5, 1) to high accuracy, but needed a large number of nodes N. Explain why this happens.\n d) How can you estimate B(0.5, 5) accurately using the cubic spline and Simpson’s rule?",
    "steps": [
      {
        "step": 1,
        "desc": "Identify the range of the data used for spline interpolation",
        "expr": "t_i = [0, 1, 2, ..., 17]",
        "value": "t_i = [0, 1, 2, ..., 17]"
      },
      {
        "step": 2,
        "desc": "Determine the range of the spline interpolation",
        "expr": "tspl = linspace(0, 1.5, 1501)",
        "value": "tspl = [0, 0.001, ..., 1.5]"
      },
      {
        "step": 3,
        "desc": "Identify the issue with extrapolation",
        "expr": "t = 1.5",
        "value": "t = 1.5 is outside the range of t_i"
      },
      {
        "step": 4,
        "desc": "Explain the behavior of cubic splines outside the data range",
        "expr": "spline behavior",
        "value": "Cubic splines can behave unpredictably outside the data range"
      },
      {
        "step": "final",
        "desc": "Conclude why the yield is low at t = 1.5",
        "expr": "extrapolation issue",
        "value": "The low yield at t = 1.5 is due to extrapolation beyond the data range, where the spline may not accurately represent the yield curve"
      }
    ]
  },
  {
    "qid": "Problemfour",
    "subid": "4iic",
    "subquestion": "How could knowledge of the slopes r\u0002 (t1) and r\u0002 (t18) be used to im\u0002prove the spline approximation.",
    "full_question": "On 24 August the ASX 30 day intrabank cash rate futures implied yield curve was given by the m = 18 data values in Table 2.1, which are plotted in Figure 2.1. Three interns, Intern 1, Intern 2 and Intern 3, were asked to perform various calculations using the data (t_i, r_i) where r_i = r(t_i) for i = 1,...,m are the annualised yields as percentages.\n\nTable 2.1: Implied yield data\ni:      1    2    3    4    5    6    7    8    9\nt_i:    0    1    2    3    4    5    6    7    8\nr_i:  2.545 2.485 2.450 2.380 2.325 2.325 2.305 2.295 2.285\ni:     10   11   12   13   14   15   16   17   18\nt_i:    9   10   11   12   13   14   15   16   17\nr_i:  2.290 2.330 2.380 2.425 2.475 2.530 2.600 2.685 2.695\nFigure 2.1: Yield curve data and approximations. The data was stored in MATLAB in column vectors tdat and rdat.\ni) Intern 1 approximated the data by the lowest degree polynomial that would interpolate all the data values.\n a) What is the degree n of this polynomial?\n b) Intern 1 solved Ax = r where A is the Vandermonde matrix with A_ij = t_i^{j-1}. They used MATLAB:\n  Acnd = cond(A) → 3.2705e+14\n  x = A \\ rdat;\n  rpolchk = norm(A*tdat - rdat) → 1.6801e+03，what is your explanation for this?\n c) What else is wrong with Intern 1’s approach?\nii) Intern 2 approximated the data using:\n  tspl = linspace(0, 1.5, 1501);\n  rspl = spline(tdat, rdat, tspl);obtaining the dash-dot curve in Figure 2.1\n a) Explain what an interpolating cubic spline s(t) is.\n b)The spline approximation gives a low predicted yield at t = 1.5 years? Explain why this has occurred.\n c) How could knowledge of the slopes r\u0002 (t1) and r\u0002 (t18) be used to im\u0002prove the spline approximation.\niii)  The value at time t of $1 received at time T ≥ t (years) is B(t,T) = exp( -∫ₜᵀ r(s)ds ) for 0 ≤ t ≤ T.\n a) Intern 3 used the yield r9 = 2.285% at 8 months and the yield r13 = 2.425% at 1 year to provide the bounds 0.2975 ≤ B(0.5, 1) ≤ 0.3190. Calculate lower and upper bounds on B(0.5, 1) using     r9 and r13. Do you agree with Intern 3?\n b) Use a quadrature rule of your choice and the data in Table 2.1 to estimate the value at t = 0.5 of $1 million received at T = 1.\n c) The Gauss-Legendre nodes zj and weights wj for j = 1,...,N on the interval [−1, 1] are calculated using the Matlab command [z, w] = gauleg(N)\n  A)Explain how the Gauss-Legendre nodes and weights can be used to estimate B(0.5, 1).\n  B)Intern 3 used the cubic spline and the Gauss-Legendre nodes to estimate B(0.5, 1) to high accuracy, but needed a large number of nodes N. Explain why this happens.\n d) How can you estimate B(0.5, 6) accurately using the cubic spline and Simpson’s rule?",
    "steps": [
      {
        "step": 1,
        "desc": "Identify the problem with the current spline approximation",
        "expr": "spline(tdat, rdat, tspl)",
        "value": "Low predicted yield at t = 1.5 years"
      },
      {
        "step": 2,
        "desc": "Understand the role of boundary conditions in cubic splines",
        "expr": "s'(t1) and s'(t18)",
        "value": "Boundary slopes"
      },
      {
        "step": 3,
        "desc": "Determine the slopes at the boundaries using the data",
        "expr": "r'(t1) and r'(t18)",
        "value": "Estimated from data"
      },
      {
        "step": 4,
        "desc": "Incorporate the boundary slopes into the spline calculation",
        "expr": "spline(tdat, rdat, 'clamped', [r'(t1), r'(t18)])",
        "value": "Improved spline"
      },
      {
        "step": "final",
        "desc": "Resulting spline should better match the data at the boundaries",
        "expr": "s(t) with clamped conditions",
        "value": "Improved approximation"
      }
    ]
  },
  {
    "qid": "Problemfour",
    "subid": "4iiia",
    "subquestion": "Intern 3 used the yield r9 = 2.285% at 8 months and the yield r13 = 2.425% at 1 year to provide the bounds 0.2975 ≤ B(0.5, 1) ≤ 0.3190. Calculate lower and upper bounds on B(0.5, 1) using     r9 and r13. Do you agree with Intern 3?",
    "full_question": "On 24 August the ASX 30 day intrabank cash rate futures implied yield curve was given by the m = 18 data values in Table 2.1, which are plotted in Figure 2.1. Three interns, Intern 1, Intern 2 and Intern 3, were asked to perform various calculations using the data (t_i, r_i) where r_i = r(t_i) for i = 1,...,m are the annualised yields as percentages.\n\nTable 2.1: Implied yield data\ni:      1    2    3    4    5    6    7    8    9\nt_i:    0    1    2    3    4    5    6    7    8\nr_i:  2.545 2.485 2.450 2.380 2.325 2.325 2.305 2.295 2.285\ni:     10   11   12   13   14   15   16   17   18\nt_i:    9   10   11   12   13   14   15   16   17\nr_i:  2.290 2.330 2.380 2.425 2.475 2.530 2.600 2.685 2.695\nFigure 2.1: Yield curve data and approximations. The data was stored in MATLAB in column vectors tdat and rdat.\ni) Intern 1 approximated the data by the lowest degree polynomial that would interpolate all the data values.\n a) What is the degree n of this polynomial?\n b) Intern 1 solved Ax = r where A is the Vandermonde matrix with A_ij = t_i^{j-1}. They used MATLAB:\n  Acnd = cond(A) → 3.2705e+14\n  x = A \\ rdat;\n  rpolchk = norm(A*tdat - rdat) → 1.6801e+03，what is your explanation for this?\n c) What else is wrong with Intern 1’s approach?\nii) Intern 2 approximated the data using:\n  tspl = linspace(0, 1.5, 1501);\n  rspl = spline(tdat, rdat, tspl);obtaining the dash-dot curve in Figure 2.1\n a) Explain what an interpolating cubic spline s(t) is.\n b)The spline approximation gives a low predicted yield at t = 1.5 years? Explain why this has occurred.\n c) How could knowledge of the slopes r\u0002 (t1) and r\u0002 (t18) be used to im\u0002prove the spline approximation.\niii)  The value at time t of $1 received at time T ≥ t (years) is B(t,T) = exp( -∫ₜᵀ r(s)ds ) for 0 ≤ t ≤ T.\n a) Intern 3 used the yield r9 = 2.285% at 8 months and the yield r13 = 2.425% at 1 year to provide the bounds 0.2975 ≤ B(0.5, 1) ≤ 0.3190. Calculate lower and upper bounds on B(0.5, 1) using     r9 and r13. Do you agree with Intern 3?\n b) Use a quadrature rule of your choice and the data in Table 2.1 to estimate the value at t = 0.5 of $1 million received at T = 1.\n c) The Gauss-Legendre nodes zj and weights wj for j = 1,...,N on the interval [−1, 1] are calculated using the Matlab command [z, w] = gauleg(N)\n  A)Explain how the Gauss-Legendre nodes and weights can be used to estimate B(0.5, 1).\n  B)Intern 3 used the cubic spline and the Gauss-Legendre nodes to estimate B(0.5, 1) to high accuracy, but needed a large number of nodes N. Explain why this happens.\n d) How can you estimate B(0.5, 7) accurately using the cubic spline and Simpson’s rule?",
    "steps": [
      {
        "step": 1,
        "desc": "Convert r9 and r13 from percentages to decimals",
        "expr": "r9 = 2.285 / 100, r13 = 2.425 / 100",
        "value": {
          "r9": 0.02285,
          "r13": 0.02425
        }
      },
      {
        "step": 2,
        "desc": "Calculate the lower bound using r13 for B(0.5, 1)",
        "expr": "exp(-r13 * (1 - 0.5))",
        "value": 0.988012
      },
      {
        "step": 3,
        "desc": "Calculate the upper bound using r9 for B(0.5, 1)",
        "expr": "exp(-r9 * (1 - 0.5))",
        "value": 0.988622
      },
      {
        "step": "final",
        "desc": "Determine if Intern 3's bounds are correct",
        "expr": "0.988012 <= B(0.5, 1) <= 0.988622",
        "value": false
      }
    ]
  },
  {
    "qid": "Problemfour",
    "subid": "4iiib",
    "subquestion": "Use a quadrature rule of your choice and the data in Table 2.1 to estimate the value at t = 0.5 of $1 million received at T = 1.",
    "full_question": "On 24 August the ASX 30 day intrabank cash rate futures implied yield curve was given by the m = 18 data values in Table 2.1, which are plotted in Figure 2.1. Three interns, Intern 1, Intern 2 and Intern 3, were asked to perform various calculations using the data (t_i, r_i) where r_i = r(t_i) for i = 1,...,m are the annualised yields as percentages.\n\nTable 2.1: Implied yield data\ni:      1    2    3    4    5    6    7    8    9\nt_i:    0    1    2    3    4    5    6    7    8\nr_i:  2.545 2.485 2.450 2.380 2.325 2.325 2.305 2.295 2.285\ni:     10   11   12   13   14   15   16   17   18\nt_i:    9   10   11   12   13   14   15   16   17\nr_i:  2.290 2.330 2.380 2.425 2.475 2.530 2.600 2.685 2.695\nFigure 2.1: Yield curve data and approximations. The data was stored in MATLAB in column vectors tdat and rdat.\ni) Intern 1 approximated the data by the lowest degree polynomial that would interpolate all the data values.\n a) What is the degree n of this polynomial?\n b) Intern 1 solved Ax = r where A is the Vandermonde matrix with A_ij = t_i^{j-1}. They used MATLAB:\n  Acnd = cond(A) → 3.2705e+14\n  x = A \\ rdat;\n  rpolchk = norm(A*tdat - rdat) → 1.6801e+03，what is your explanation for this?\n c) What else is wrong with Intern 1’s approach?\nii) Intern 2 approximated the data using:\n  tspl = linspace(0, 1.5, 1501);\n  rspl = spline(tdat, rdat, tspl);obtaining the dash-dot curve in Figure 2.1\n a) Explain what an interpolating cubic spline s(t) is.\n b)The spline approximation gives a low predicted yield at t = 1.5 years? Explain why this has occurred.\n c) How could knowledge of the slopes r\u0002 (t1) and r\u0002 (t18) be used to im\u0002prove the spline approximation.\niii)  The value at time t of $1 received at time T ≥ t (years) is B(t,T) = exp( -∫ₜᵀ r(s)ds ) for 0 ≤ t ≤ T.\n a) Intern 3 used the yield r9 = 2.285% at 8 months and the yield r13 = 2.425% at 1 year to provide the bounds 0.2975 ≤ B(0.5, 1) ≤ 0.3190. Calculate lower and upper bounds on B(0.5, 1) using     r9 and r13. Do you agree with Intern 3?\n b) Use a quadrature rule of your choice and the data in Table 2.1 to estimate the value at t = 0.5 of $1 million received at T = 1.\n c) The Gauss-Legendre nodes zj and weights wj for j = 1,...,N on the interval [−1, 1] are calculated using the Matlab command [z, w] = gauleg(N)\n  A)Explain how the Gauss-Legendre nodes and weights can be used to estimate B(0.5, 1).\n  B)Intern 3 used the cubic spline and the Gauss-Legendre nodes to estimate B(0.5, 1) to high accuracy, but needed a large number of nodes N. Explain why this happens.\n d) How can you estimate B(0.5, 8) accurately using the cubic spline and Simpson’s rule?",
    "steps": [
      {
        "step": 1,
        "desc": "Identify the relevant yields for the interval [0.5, 1]",
        "expr": "r9 = 2.285%, r13 = 2.425%",
        "value": null
      },
      {
        "step": 2,
        "desc": "Convert the yields from percentages to decimals",
        "expr": "r9 = 0.02285, r13 = 0.02425",
        "value": null
      },
      {
        "step": 3,
        "desc": "Choose the trapezoidal rule for numerical integration",
        "expr": "Trapezoidal rule",
        "value": null
      },
      {
        "step": 4,
        "desc": "Calculate the integral using the trapezoidal rule",
        "expr": "Integral ≈ (0.5) * (r9 + r13)",
        "value": 0.02355
      },
      {
        "step": 5,
        "desc": "Calculate the discount factor B(0.5, 1)",
        "expr": "B(0.5, 1) = exp(-Integral)",
        "value": 0.97673
      },
      {
        "step": "final",
        "desc": "Estimate the value at t = 0.5 of $1 million received at T = 1",
        "expr": "Value = $1,000,000 * B(0.5, 1)",
        "value": 976730
      }
    ]
  },
  {
    "qid": "Problemfour",
    "subid": "4iiicA",
    "subquestion": "Explain how the Gauss-Legendre nodes and weights can be used to estimate B(0.5, 1).",
    "full_question": "On 24 August the ASX 30 day intrabank cash rate futures implied yield curve was given by the m = 18 data values in Table 2.1, which are plotted in Figure 2.1. Three interns, Intern 1, Intern 2 and Intern 3, were asked to perform various calculations using the data (t_i, r_i) where r_i = r(t_i) for i = 1,...,m are the annualised yields as percentages.\n\nTable 2.1: Implied yield data\ni:      1    2    3    4    5    6    7    8    9\nt_i:    0    1    2    3    4    5    6    7    8\nr_i:  2.545 2.485 2.450 2.380 2.325 2.325 2.305 2.295 2.285\ni:     10   11   12   13   14   15   16   17   18\nt_i:    9   10   11   12   13   14   15   16   17\nr_i:  2.290 2.330 2.380 2.425 2.475 2.530 2.600 2.685 2.695\nFigure 2.1: Yield curve data and approximations. The data was stored in MATLAB in column vectors tdat and rdat.\ni) Intern 1 approximated the data by the lowest degree polynomial that would interpolate all the data values.\n a) What is the degree n of this polynomial?\n b) Intern 1 solved Ax = r where A is the Vandermonde matrix with A_ij = t_i^{j-1}. They used MATLAB:\n  Acnd = cond(A) → 3.2705e+14\n  x = A \\ rdat;\n  rpolchk = norm(A*tdat - rdat) → 1.6801e+03，what is your explanation for this?\n c) What else is wrong with Intern 1’s approach?\nii) Intern 2 approximated the data using:\n  tspl = linspace(0, 1.5, 1501);\n  rspl = spline(tdat, rdat, tspl);obtaining the dash-dot curve in Figure 2.1\n a) Explain what an interpolating cubic spline s(t) is.\n b)The spline approximation gives a low predicted yield at t = 1.5 years? Explain why this has occurred.\n c) How could knowledge of the slopes r\u0002 (t1) and r\u0002 (t18) be used to im\u0002prove the spline approximation.\niii)  The value at time t of $1 received at time T ≥ t (years) is B(t,T) = exp( -∫ₜᵀ r(s)ds ) for 0 ≤ t ≤ T.\n a) Intern 3 used the yield r9 = 2.285% at 8 months and the yield r13 = 2.425% at 1 year to provide the bounds 0.2975 ≤ B(0.5, 1) ≤ 0.3190. Calculate lower and upper bounds on B(0.5, 1) using     r9 and r13. Do you agree with Intern 3?\n b) Use a quadrature rule of your choice and the data in Table 2.1 to estimate the value at t = 0.5 of $1 million received at T = 1.\n c) The Gauss-Legendre nodes zj and weights wj for j = 1,...,N on the interval [−1, 1] are calculated using the Matlab command [z, w] = gauleg(N)\n  A)Explain how the Gauss-Legendre nodes and weights can be used to estimate B(0.5, 1).\n  B)Intern 3 used the cubic spline and the Gauss-Legendre nodes to estimate B(0.5, 1) to high accuracy, but needed a large number of nodes N. Explain why this happens.\n d) How can you estimate B(0.5, 9) accurately using the cubic spline and Simpson’s rule?",
    "steps": [
      {
        "step": 1,
        "desc": "Define the integral for B(0.5, 1)",
        "expr": "B(0.5, 1) = exp(-∫_{0.5}^{1} r(s) ds)",
        "value": null
      },
      {
        "step": 2,
        "desc": "Transform the integral limits from [0.5, 1] to [-1, 1]",
        "expr": "s = 0.25 * (x + 3)",
        "value": null
      },
      {
        "step": 3,
        "desc": "Change of variables for the integral",
        "expr": "∫_{0.5}^{1} r(s) ds = 0.25 * ∫_{-1}^{1} r(0.25 * (x + 3)) dx",
        "value": null
      },
      {
        "step": 4,
        "desc": "Use Gauss-Legendre quadrature to approximate the integral",
        "expr": "∫_{-1}^{1} r(0.25 * (x + 3)) dx ≈ Σ_{j=1}^{N} w_j * r(0.25 * (z_j + 3))",
        "value": null
      },
      {
        "step": 5,
        "desc": "Calculate the approximation of the integral",
        "expr": "I ≈ 0.25 * Σ_{j=1}^{N} w_j * r(0.25 * (z_j + 3))",
        "value": null
      },
      {
        "step": "final",
        "desc": "Estimate B(0.5, 1) using the approximation",
        "expr": "B(0.5, 1) ≈ exp(-I)",
        "value": null
      }
    ]
  },
  {
    "qid": "Problemfour",
    "subid": "4iiicB",
    "subquestion": "Intern 3 used the cubic spline and the Gauss-Legendre nodes to estimate B(0.5, 1) to high accuracy, but needed a large number of nodes N. Explain why this happens.",
    "full_question": "On 24 August the ASX 30 day intrabank cash rate futures implied yield curve was given by the m = 18 data values in Table 2.1, which are plotted in Figure 2.1. Three interns, Intern 1, Intern 2 and Intern 3, were asked to perform various calculations using the data (t_i, r_i) where r_i = r(t_i) for i = 1,...,m are the annualised yields as percentages.\n\nTable 2.1: Implied yield data\ni:      1    2    3    4    5    6    7    8    9\nt_i:    0    1    2    3    4    5    6    7    8\nr_i:  2.545 2.485 2.450 2.380 2.325 2.325 2.305 2.295 2.285\ni:     10   11   12   13   14   15   16   17   18\nt_i:    9   10   11   12   13   14   15   16   17\nr_i:  2.290 2.330 2.380 2.425 2.475 2.530 2.600 2.685 2.695\nFigure 2.1: Yield curve data and approximations. The data was stored in MATLAB in column vectors tdat and rdat.\ni) Intern 1 approximated the data by the lowest degree polynomial that would interpolate all the data values.\n a) What is the degree n of this polynomial?\n b) Intern 1 solved Ax = r where A is the Vandermonde matrix with A_ij = t_i^{j-1}. They used MATLAB:\n  Acnd = cond(A) → 3.2705e+14\n  x = A \\ rdat;\n  rpolchk = norm(A*tdat - rdat) → 1.6801e+03，what is your explanation for this?\n c) What else is wrong with Intern 1’s approach?\nii) Intern 2 approximated the data using:\n  tspl = linspace(0, 1.5, 1501);\n  rspl = spline(tdat, rdat, tspl);obtaining the dash-dot curve in Figure 2.1\n a) Explain what an interpolating cubic spline s(t) is.\n b)The spline approximation gives a low predicted yield at t = 1.5 years? Explain why this has occurred.\n c) How could knowledge of the slopes r\u0002 (t1) and r\u0002 (t18) be used to im\u0002prove the spline approximation.\niii)  The value at time t of $1 received at time T ≥ t (years) is B(t,T) = exp( -∫ₜᵀ r(s)ds ) for 0 ≤ t ≤ T.\n a) Intern 3 used the yield r9 = 2.285% at 8 months and the yield r13 = 2.425% at 1 year to provide the bounds 0.2975 ≤ B(0.5, 1) ≤ 0.3190. Calculate lower and upper bounds on B(0.5, 1) using     r9 and r13. Do you agree with Intern 3?\n b) Use a quadrature rule of your choice and the data in Table 2.1 to estimate the value at t = 0.5 of $1 million received at T = 1.\n c) The Gauss-Legendre nodes zj and weights wj for j = 1,...,N on the interval [−1, 1] are calculated using the Matlab command [z, w] = gauleg(N)\n  A)Explain how the Gauss-Legendre nodes and weights can be used to estimate B(0.5, 1).\n  B)Intern 3 used the cubic spline and the Gauss-Legendre nodes to estimate B(0.5, 1) to high accuracy, but needed a large number of nodes N. Explain why this happens.\n d) How can you estimate B(0.5, 10) accurately using the cubic spline and Simpson’s rule?",
    "steps": [
      {
        "step": 1,
        "desc": "Identify the problem with using cubic splines for integration",
        "expr": "s(t)",
        "value": "Cubic spline interpolation"
      },
      {
        "step": 2,
        "desc": "Recognize that cubic splines are piecewise polynomials",
        "expr": "s(t) = p_i(t) for t in [t_i, t_{i+1}]",
        "value": "Piecewise cubic polynomials"
      },
      {
        "step": 3,
        "desc": "Understand that integration of piecewise functions requires handling each segment",
        "expr": "∫ s(t) dt = ∑ ∫ p_i(t) dt",
        "value": "Sum of integrals over segments"
      },
      {
        "step": 4,
        "desc": "Realize that Gauss-Legendre quadrature is used for numerical integration",
        "expr": "∫ f(x) dx ≈ ∑ w_j f(z_j)",
        "value": "Numerical integration using nodes and weights"
      },
      {
        "step": 5,
        "desc": "Note that high accuracy requires capturing the behavior of each segment",
        "expr": "N → large",
        "value": "Large number of nodes needed"
      },
      {
        "step": 6,
        "desc": "Conclude that more nodes are needed to accurately integrate each piece",
        "expr": "N = number of segments * nodes per segment",
        "value": "Increased nodes for accuracy"
      },
      {
        "step": "final",
        "desc": "Explain why a large number of nodes N is needed",
        "expr": "N = large",
        "value": "High accuracy requires many nodes due to piecewise nature of splines"
      }
    ]
  },
  {
    "qid": "Problemfour",
    "subid": "4iiid",
    "subquestion": "How can you estimate B(0.5, 1) accurately using the cubic spline and Simpson’s rule?",
    "full_question": "On 24 August the ASX 30 day intrabank cash rate futures implied yield curve was given by the m = 18 data values in Table 2.1, which are plotted in Figure 2.1. Three interns, Intern 1, Intern 2 and Intern 3, were asked to perform various calculations using the data (t_i, r_i) where r_i = r(t_i) for i = 1,...,m are the annualised yields as percentages.\n\nTable 2.1: Implied yield data\ni:      1    2    3    4    5    6    7    8    9\nt_i:    0    1    2    3    4    5    6    7    8\nr_i:  2.545 2.485 2.450 2.380 2.325 2.325 2.305 2.295 2.285\ni:     10   11   12   13   14   15   16   17   18\nt_i:    9   10   11   12   13   14   15   16   17\nr_i:  2.290 2.330 2.380 2.425 2.475 2.530 2.600 2.685 2.695\nFigure 2.1: Yield curve data and approximations. The data was stored in MATLAB in column vectors tdat and rdat.\ni) Intern 1 approximated the data by the lowest degree polynomial that would interpolate all the data values.\n a) What is the degree n of this polynomial?\n b) Intern 1 solved Ax = r where A is the Vandermonde matrix with A_ij = t_i^{j-1}. They used MATLAB:\n  Acnd = cond(A) → 3.2705e+14\n  x = A \\ rdat;\n  rpolchk = norm(A*tdat - rdat) → 1.6801e+03，what is your explanation for this?\n c) What else is wrong with Intern 1’s approach?\nii) Intern 2 approximated the data using:\n  tspl = linspace(0, 1.5, 1501);\n  rspl = spline(tdat, rdat, tspl);obtaining the dash-dot curve in Figure 2.1\n a) Explain what an interpolating cubic spline s(t) is.\n b)The spline approximation gives a low predicted yield at t = 1.5 years? Explain why this has occurred.\n c) How could knowledge of the slopes r\u0002 (t1) and r\u0002 (t18) be used to im\u0002prove the spline approximation.\niii)  The value at time t of $1 received at time T ≥ t (years) is B(t,T) = exp( -∫ₜᵀ r(s)ds ) for 0 ≤ t ≤ T.\n a) Intern 3 used the yield r9 = 2.285% at 8 months and the yield r13 = 2.425% at 1 year to provide the bounds 0.2975 ≤ B(0.5, 1) ≤ 0.3190. Calculate lower and upper bounds on B(0.5, 1) using     r9 and r13. Do you agree with Intern 3?\n b) Use a quadrature rule of your choice and the data in Table 2.1 to estimate the value at t = 0.5 of $1 million received at T = 1.\n c) The Gauss-Legendre nodes zj and weights wj for j = 1,...,N on the interval [−1, 1] are calculated using the Matlab command [z, w] = gauleg(N)\n  A)Explain how the Gauss-Legendre nodes and weights can be used to estimate B(0.5, 1).\n  B)Intern 3 used the cubic spline and the Gauss-Legendre nodes to estimate B(0.5, 1) to high accuracy, but needed a large number of nodes N. Explain why this happens.\n d) How can you estimate B(0.5, 11) accurately using the cubic spline and Simpson’s rule?",
    "steps": [
      {
        "step": 1,
        "desc": "Define the interval for integration from t=0.5 to T=1",
        "expr": "[0.5, 1]",
        "value": null
      },
      {
        "step": 2,
        "desc": "Determine the number of subintervals n for Simpson's rule",
        "expr": "n = 4",
        "value": 4
      },
      {
        "step": 3,
        "desc": "Calculate the step size h for Simpson's rule",
        "expr": "h = (1 - 0.5) / n",
        "value": 0.125
      },
      {
        "step": 4,
        "desc": "Generate the points for Simpson's rule",
        "expr": "t_points = [0.5, 0.625, 0.75, 0.875, 1]",
        "value": [
          0.5,
          0.625,
          0.75,
          0.875,
          1
        ]
      },
      {
        "step": 5,
        "desc": "Evaluate the cubic spline at the generated points",
        "expr": "r_values = spline(tdat, rdat, t_points)",
        "value": null
      },
      {
        "step": 6,
        "desc": "Apply Simpson's rule to approximate the integral",
        "expr": "integral ≈ (h/3) * (r_values[0] + 4*r_values[1] + 2*r_values[2] + 4*r_values[3] + r_values[4])",
        "value": null
      },
      {
        "step": 7,
        "desc": "Calculate the exponential of the negative integral to find B(0.5, 1)",
        "expr": "B(0.5, 1) = exp(-integral)",
        "value": null
      },
      {
        "step": "final",
        "desc": "Return the estimated value of B(0.5, 1)",
        "expr": "B(0.5, 1)",
        "value": null
      }
    ]
  },
  {
    "qid": "Problemfive",
    "subid": "5i",
    "subquestion": "Carefully explain what the “initial” conditions are for this problem.",
    "full_question": "The value V(S, t) of an option on an underlying asset with price S at time t satisfies the Black–Scholes PDE\n∂V/∂t + rS ∂V/∂S + (σ²/2) S² ∂²V/∂S² = rV          (3.1)\nfor 0 < S < ∞ and 0 < t < T. Assume the risk-free interest rate r and the volatility σ are known positive constants.\nAt expiry T, the payoff of an “exotic” option with strikes 0 < K₁ < K₂ is\n    f(S) =   0            if S < K₁\n           S − K₁        if K₁ ≤ S ≤ K₂\n           K₂ − K₁       if S > K₂.\ni) Carefully explain what the “initial” conditions are for this problem.\nii) The change of variables to log-moneyness y and time to expiry τ is\n    y = log(S/X)       and       τ = T − t,\nwhere X is a positive constant. This gives W(y, τ) = V(S, t).\na) Find expressions for\n    ∂W/∂τ,     ∂W/∂y,     ∂²W/∂y²\nin terms of the partial derivatives of V(S, t).\nb) Show that the Black and Scholes PDE (3.1) is equivalent to\n    -∂W/∂τ + (r − σ²/2) ∂W/∂y + (σ²/2) ∂²W/∂y² = rW        (3.2)\nin terms of the log-moneyness y and the time to expiry τ.\nc) What are the initial conditions for the transformed problem?\niii)Let y_max > 0 and consider the domain y ∈ [−y_max, y_max] and τ ∈ [0, T].\nConsider the grid (y_j, τ_ℓ) where\n    y_j = −y_max + jΔy,      j = 0, 1, 2, ..., 2(n+1)\n    τ_ℓ = ℓΔτ,               ℓ = 0, 1, 2, ..., m\n    Δy = y_max / (n + 1),    Δτ = T / m\na)Let W^ℓ_j ≈ W(y_j, τ_ℓ) denote the approximate solution. At the time to expiry τ_ℓ and log-moneyness y_j give:\nA) central difference approximations of O((Δy)²) for the partial derivatives ∂W/∂y and ∂²W/∂y².\nB) forward difference approximation of O(Δτ) for the partial derivative ∂W/∂τ.\nb)Show that the finite difference equation for the PDE (3.2) has the form\n    W^{ℓ+1}_j = α W^ℓ_{j−1} + β W^ℓ_j + γ W^ℓ_{j+1}     (3.3)\nand find the coefficients α, β and γ.\nc)A student claims that as the initial conditions are at expiry and the time stepping is from expiry at t_m = T back to t_0 = 0, equation (3.3) represents an implicit method so there are no restrictions on the values for Δτ and Δy that can be used. Is this correct? Justify your answer.\niv)The current asset price at t = 0 is S₀ = X e^{y₀}. \na)Give an approximation for the option Delta Δ.\nb)Give an approximation for the option Gamma Γ.",
    "steps": [
      {
        "step": 1,
        "desc": "Identify the context of the problem",
        "expr": "V(S, t) satisfies Black-Scholes PDE",
        "value": null
      },
      {
        "step": 2,
        "desc": "Recognize the domain of the problem",
        "expr": "0 < S < ∞, 0 < t < T",
        "value": null
      },
      {
        "step": 3,
        "desc": "Identify the expiry condition",
        "expr": "t = T",
        "value": null
      },
      {
        "step": 4,
        "desc": "Define the payoff function at expiry",
        "expr": "f(S) = 0 if S < K₁, S - K₁ if K₁ ≤ S ≤ K₂, K₂ - K₁ if S > K₂",
        "value": null
      },
      {
        "step": 5,
        "desc": "Determine the initial condition for the PDE",
        "expr": "V(S, T) = f(S)",
        "value": null
      },
      {
        "step": "final",
        "desc": "State the initial condition for the problem",
        "expr": "V(S, T) = 0 if S < K₁, S - K₁ if K₁ ≤ S ≤ K₂, K₂ - K₁ if S > K₂",
        "value": null
      }
    ]
  },
  {
    "qid": "Problemfive",
    "subid": "5iia",
    "subquestion": "Find expressions for\n    ∂W/∂τ,     ∂W/∂y,     ∂²W/∂y²\nin terms of the partial derivatives of V(S, t).",
    "full_question": "The value V(S, t) of an option on an underlying asset with price S at time t satisfies the Black–Scholes PDE\n∂V/∂t + rS ∂V/∂S + (σ²/2) S² ∂²V/∂S² = rV          (3.1)\nfor 0 < S < ∞ and 0 < t < T. Assume the risk-free interest rate r and the volatility σ are known positive constants.\nAt expiry T, the payoff of an “exotic” option with strikes 0 < K₁ < K₂ is\n    f(S) =   0            if S < K₁\n           S − K₁        if K₁ ≤ S ≤ K₂\n           K₂ − K₁       if S > K₂.\ni) Carefully explain what the “initial” conditions are for this problem.\nii) The change of variables to log-moneyness y and time to expiry τ is\n    y = log(S/X)       and       τ = T − t,\nwhere X is a positive constant. This gives W(y, τ) = V(S, t).\na) Find expressions for\n    ∂W/∂τ,     ∂W/∂y,     ∂²W/∂y²\nin terms of the partial derivatives of V(S, t).\nb) Show that the Black and Scholes PDE (3.1) is equivalent to\n    -∂W/∂τ + (r − σ²/2) ∂W/∂y + (σ²/2) ∂²W/∂y² = rW        (3.2)\nin terms of the log-moneyness y and the time to expiry τ.\nc) What are the initial conditions for the transformed problem?\niii)Let y_max > 0 and consider the domain y ∈ [−y_max, y_max] and τ ∈ [0, T].\nConsider the grid (y_j, τ_ℓ) where\n    y_j = −y_max + jΔy,      j = 0, 1, 2, ..., 2(n+1)\n    τ_ℓ = ℓΔτ,               ℓ = 0, 1, 2, ..., m\n    Δy = y_max / (n + 1),    Δτ = T / m\na)Let W^ℓ_j ≈ W(y_j, τ_ℓ) denote the approximate solution. At the time to expiry τ_ℓ and log-moneyness y_j give:\nA) central difference approximations of O((Δy)²) for the partial derivatives ∂W/∂y and ∂²W/∂y².\nB) forward difference approximation of O(Δτ) for the partial derivative ∂W/∂τ.\nb)Show that the finite difference equation for the PDE (3.2) has the form\n    W^{ℓ+1}_j = α W^ℓ_{j−1} + β W^ℓ_j + γ W^ℓ_{j+1}     (3.3)\nand find the coefficients α, β and γ.\nc)A student claims that as the initial conditions are at expiry and the time stepping is from expiry at t_m = T back to t_0 = 0, equation (3.3) represents an implicit method so there are no restrictions on the values for Δτ and Δy that can be used. Is this correct? Justify your answer.\niv)The current asset price at t = 1 is S₀ = X e^{y₀}. \na)Give an approximation for the option Delta Δ.\nb)Give an approximation for the option Gamma Γ.",
    "steps": [
      {
        "step": 1,
        "desc": "Define the change of variables for log-moneyness and time to expiry",
        "expr": "y = log(S/X), τ = T - t",
        "value": null
      },
      {
        "step": 2,
        "desc": "Express S in terms of y and X",
        "expr": "S = X * e^y",
        "value": null
      },
      {
        "step": 3,
        "desc": "Express partial derivative of W with respect to τ in terms of V",
        "expr": "∂W/∂τ = -∂V/∂t",
        "value": null
      },
      {
        "step": 4,
        "desc": "Express partial derivative of W with respect to y in terms of V",
        "expr": "∂W/∂y = (∂V/∂S) * (∂S/∂y)",
        "value": null
      },
      {
        "step": 5,
        "desc": "Compute ∂S/∂y",
        "expr": "∂S/∂y = X * e^y = S",
        "value": null
      },
      {
        "step": 6,
        "desc": "Substitute ∂S/∂y into ∂W/∂y",
        "expr": "∂W/∂y = S * ∂V/∂S",
        "value": null
      },
      {
        "step": 7,
        "desc": "Express second partial derivative of W with respect to y in terms of V",
        "expr": "∂²W/∂y² = ∂/∂y (S * ∂V/∂S)",
        "value": null
      },
      {
        "step": 8,
        "desc": "Apply product rule to ∂²W/∂y²",
        "expr": "∂²W/∂y² = S * ∂²V/∂S² * ∂S/∂y + ∂V/∂S * ∂S/∂y",
        "value": null
      },
      {
        "step": 9,
        "desc": "Substitute ∂S/∂y into ∂²W/∂y²",
        "expr": "∂²W/∂y² = S² * ∂²V/∂S² + S * ∂V/∂S",
        "value": null
      },
      {
        "step": "final",
        "desc": "Final expressions for partial derivatives of W",
        "expr": {
          "∂W/∂τ": "-∂V/∂t",
          "∂W/∂y": "S * ∂V/∂S",
          "∂²W/∂y²": "S² * ∂²V/∂S² + S * ∂V/∂S"
        },
        "value": null
      }
    ]
  },
  {
    "qid": "Problemfive",
    "subid": "5iib",
    "subquestion": "Show that the Black and Scholes PDE (3.1) is equivalent to\n    -∂W/∂τ + (r − σ²/2) ∂W/∂y + (σ²/2) ∂²W/∂y² = rW        (3.2)\nin terms of the log-moneyness y and the time to expiry τ.",
    "full_question": "The value V(S, t) of an option on an underlying asset with price S at time t satisfies the Black–Scholes PDE\n∂V/∂t + rS ∂V/∂S + (σ²/2) S² ∂²V/∂S² = rV          (3.1)\nfor 0 < S < ∞ and 0 < t < T. Assume the risk-free interest rate r and the volatility σ are known positive constants.\nAt expiry T, the payoff of an “exotic” option with strikes 0 < K₁ < K₂ is\n    f(S) =   0            if S < K₁\n           S − K₁        if K₁ ≤ S ≤ K₂\n           K₂ − K₁       if S > K₂.\ni) Carefully explain what the “initial” conditions are for this problem.\nii) The change of variables to log-moneyness y and time to expiry τ is\n    y = log(S/X)       and       τ = T − t,\nwhere X is a positive constant. This gives W(y, τ) = V(S, t).\na) Find expressions for\n    ∂W/∂τ,     ∂W/∂y,     ∂²W/∂y²\nin terms of the partial derivatives of V(S, t).\nb) Show that the Black and Scholes PDE (3.1) is equivalent to\n    -∂W/∂τ + (r − σ²/2) ∂W/∂y + (σ²/2) ∂²W/∂y² = rW        (3.2)\nin terms of the log-moneyness y and the time to expiry τ.\nc) What are the initial conditions for the transformed problem?\niii)Let y_max > 0 and consider the domain y ∈ [−y_max, y_max] and τ ∈ [0, T].\nConsider the grid (y_j, τ_ℓ) where\n    y_j = −y_max + jΔy,      j = 0, 1, 2, ..., 2(n+1)\n    τ_ℓ = ℓΔτ,               ℓ = 0, 1, 2, ..., m\n    Δy = y_max / (n + 1),    Δτ = T / m\na)Let W^ℓ_j ≈ W(y_j, τ_ℓ) denote the approximate solution. At the time to expiry τ_ℓ and log-moneyness y_j give:\nA) central difference approximations of O((Δy)²) for the partial derivatives ∂W/∂y and ∂²W/∂y².\nB) forward difference approximation of O(Δτ) for the partial derivative ∂W/∂τ.\nb)Show that the finite difference equation for the PDE (3.2) has the form\n    W^{ℓ+1}_j = α W^ℓ_{j−1} + β W^ℓ_j + γ W^ℓ_{j+1}     (3.3)\nand find the coefficients α, β and γ.\nc)A student claims that as the initial conditions are at expiry and the time stepping is from expiry at t_m = T back to t_0 = 0, equation (3.3) represents an implicit method so there are no restrictions on the values for Δτ and Δy that can be used. Is this correct? Justify your answer.\niv)The current asset price at t = 2 is S₀ = X e^{y₀}. \na)Give an approximation for the option Delta Δ.\nb)Give an approximation for the option Gamma Γ.",
    "steps": [
      {
        "step": 1,
        "desc": "Express S in terms of y and X",
        "expr": "S = X e^y",
        "value": null
      },
      {
        "step": 2,
        "desc": "Express t in terms of τ and T",
        "expr": "t = T - τ",
        "value": null
      },
      {
        "step": 3,
        "desc": "Express V(S, t) in terms of W(y, τ)",
        "expr": "W(y, τ) = V(S, t)",
        "value": null
      },
      {
        "step": 4,
        "desc": "Find ∂V/∂t in terms of ∂W/∂τ",
        "expr": "∂V/∂t = -∂W/∂τ",
        "value": null
      },
      {
        "step": 5,
        "desc": "Find ∂V/∂S in terms of ∂W/∂y",
        "expr": "∂V/∂S = (1/S) ∂W/∂y",
        "value": null
      },
      {
        "step": 6,
        "desc": "Find ∂²V/∂S² in terms of ∂²W/∂y² and ∂W/∂y",
        "expr": "∂²V/∂S² = (1/S²) (∂²W/∂y² - ∂W/∂y)",
        "value": null
      },
      {
        "step": 7,
        "desc": "Substitute expressions for ∂V/∂t, ∂V/∂S, and ∂²V/∂S² into Black-Scholes PDE",
        "expr": "-∂W/∂τ + rS(1/S)∂W/∂y + (σ²/2)S²(1/S²)(∂²W/∂y² - ∂W/∂y) = rW",
        "value": null
      },
      {
        "step": 8,
        "desc": "Simplify the equation",
        "expr": "-∂W/∂τ + r∂W/∂y + (σ²/2)(∂²W/∂y² - ∂W/∂y) = rW",
        "value": null
      },
      {
        "step": 9,
        "desc": "Combine terms",
        "expr": "-∂W/∂τ + (r - σ²/2)∂W/∂y + (σ²/2)∂²W/∂y² = rW",
        "value": null
      },
      {
        "step": "final",
        "desc": "The transformed PDE is equivalent to the given form",
        "expr": "-∂W/∂τ + (r - σ²/2)∂W/∂y + (σ²/2)∂²W/∂y² = rW",
        "value": null
      }
    ]
  },
  {
    "qid": "Problemfive",
    "subid": "5iic",
    "subquestion": "What are the initial conditions for the transformed problem?",
    "full_question": "The value V(S, t) of an option on an underlying asset with price S at time t satisfies the Black–Scholes PDE\n∂V/∂t + rS ∂V/∂S + (σ²/2) S² ∂²V/∂S² = rV          (3.1)\nfor 0 < S < ∞ and 0 < t < T. Assume the risk-free interest rate r and the volatility σ are known positive constants.\nAt expiry T, the payoff of an “exotic” option with strikes 0 < K₁ < K₂ is\n    f(S) =   0            if S < K₁\n           S − K₁        if K₁ ≤ S ≤ K₂\n           K₂ − K₁       if S > K₂.\ni) Carefully explain what the “initial” conditions are for this problem.\nii) The change of variables to log-moneyness y and time to expiry τ is\n    y = log(S/X)       and       τ = T − t,\nwhere X is a positive constant. This gives W(y, τ) = V(S, t).\na) Find expressions for\n    ∂W/∂τ,     ∂W/∂y,     ∂²W/∂y²\nin terms of the partial derivatives of V(S, t).\nb) Show that the Black and Scholes PDE (3.1) is equivalent to\n    -∂W/∂τ + (r − σ²/2) ∂W/∂y + (σ²/2) ∂²W/∂y² = rW        (3.2)\nin terms of the log-moneyness y and the time to expiry τ.\nc) What are the initial conditions for the transformed problem?\niii)Let y_max > 0 and consider the domain y ∈ [−y_max, y_max] and τ ∈ [0, T].\nConsider the grid (y_j, τ_ℓ) where\n    y_j = −y_max + jΔy,      j = 0, 1, 2, ..., 2(n+1)\n    τ_ℓ = ℓΔτ,               ℓ = 0, 1, 2, ..., m\n    Δy = y_max / (n + 1),    Δτ = T / m\na)Let W^ℓ_j ≈ W(y_j, τ_ℓ) denote the approximate solution. At the time to expiry τ_ℓ and log-moneyness y_j give:\nA) central difference approximations of O((Δy)²) for the partial derivatives ∂W/∂y and ∂²W/∂y².\nB) forward difference approximation of O(Δτ) for the partial derivative ∂W/∂τ.\nb)Show that the finite difference equation for the PDE (3.2) has the form\n    W^{ℓ+1}_j = α W^ℓ_{j−1} + β W^ℓ_j + γ W^ℓ_{j+1}     (3.3)\nand find the coefficients α, β and γ.\nc)A student claims that as the initial conditions are at expiry and the time stepping is from expiry at t_m = T back to t_0 = 0, equation (3.3) represents an implicit method so there are no restrictions on the values for Δτ and Δy that can be used. Is this correct? Justify your answer.\niv)The current asset price at t = 3 is S₀ = X e^{y₀}. \na)Give an approximation for the option Delta Δ.\nb)Give an approximation for the option Gamma Γ.",
    "steps": [
      {
        "step": 1,
        "desc": "Identify the initial condition in the original problem at expiry T",
        "expr": "V(S, T) = f(S)",
        "value": "f(S) = 0 if S < K1, S - K1 if K1 <= S <= K2, K2 - K1 if S > K2"
      },
      {
        "step": 2,
        "desc": "Express the initial condition in terms of the transformed variables y and τ",
        "expr": "W(y, 0) = V(S, T)",
        "value": "W(y, 0) = f(S)"
      },
      {
        "step": 3,
        "desc": "Substitute S = X * exp(y) into the payoff function f(S)",
        "expr": "f(S) = f(X * exp(y))",
        "value": "f(X * exp(y)) = 0 if X * exp(y) < K1, X * exp(y) - K1 if K1 <= X * exp(y) <= K2, K2 - K1 if X * exp(y) > K2"
      },
      {
        "step": 4,
        "desc": "Solve for y in terms of K1 and K2",
        "expr": "y1 = log(K1/X), y2 = log(K2/X)",
        "value": "y1 = log(K1/X), y2 = log(K2/X)"
      },
      {
        "step": "final",
        "desc": "Express the initial condition W(y, 0) in terms of y1 and y2",
        "expr": "W(y, 0)",
        "value": "W(y, 0) = 0 if y < y1, X * exp(y) - K1 if y1 <= y <= y2, K2 - K1 if y > y2"
      }
    ]
  },
  {
    "qid": "Problemfive",
    "subid": "5iiiaA",
    "subquestion": "central difference approximations of O((Δy)²) for the partial derivatives ∂W/∂y and ∂²W/∂y².",
    "full_question": "The value V(S, t) of an option on an underlying asset with price S at time t satisfies the Black–Scholes PDE\n∂V/∂t + rS ∂V/∂S + (σ²/2) S² ∂²V/∂S² = rV          (3.1)\nfor 0 < S < ∞ and 0 < t < T. Assume the risk-free interest rate r and the volatility σ are known positive constants.\nAt expiry T, the payoff of an “exotic” option with strikes 0 < K₁ < K₂ is\n    f(S) =   0            if S < K₁\n           S − K₁        if K₁ ≤ S ≤ K₂\n           K₂ − K₁       if S > K₂.\ni) Carefully explain what the “initial” conditions are for this problem.\nii) The change of variables to log-moneyness y and time to expiry τ is\n    y = log(S/X)       and       τ = T − t,\nwhere X is a positive constant. This gives W(y, τ) = V(S, t).\na) Find expressions for\n    ∂W/∂τ,     ∂W/∂y,     ∂²W/∂y²\nin terms of the partial derivatives of V(S, t).\nb) Show that the Black and Scholes PDE (3.1) is equivalent to\n    -∂W/∂τ + (r − σ²/2) ∂W/∂y + (σ²/2) ∂²W/∂y² = rW        (3.2)\nin terms of the log-moneyness y and the time to expiry τ.\nc) What are the initial conditions for the transformed problem?\niii)Let y_max > 0 and consider the domain y ∈ [−y_max, y_max] and τ ∈ [0, T].\nConsider the grid (y_j, τ_ℓ) where\n    y_j = −y_max + jΔy,      j = 0, 1, 2, ..., 2(n+1)\n    τ_ℓ = ℓΔτ,               ℓ = 0, 1, 2, ..., m\n    Δy = y_max / (n + 1),    Δτ = T / m\na)Let W^ℓ_j ≈ W(y_j, τ_ℓ) denote the approximate solution. At the time to expiry τ_ℓ and log-moneyness y_j give:\nA) central difference approximations of O((Δy)²) for the partial derivatives ∂W/∂y and ∂²W/∂y².\nB) forward difference approximation of O(Δτ) for the partial derivative ∂W/∂τ.\nb)Show that the finite difference equation for the PDE (3.2) has the form\n    W^{ℓ+1}_j = α W^ℓ_{j−1} + β W^ℓ_j + γ W^ℓ_{j+1}     (3.3)\nand find the coefficients α, β and γ.\nc)A student claims that as the initial conditions are at expiry and the time stepping is from expiry at t_m = T back to t_0 = 0, equation (3.3) represents an implicit method so there are no restrictions on the values for Δτ and Δy that can be used. Is this correct? Justify your answer.\niv)The current asset price at t = 4 is S₀ = X e^{y₀}. \na)Give an approximation for the option Delta Δ.\nb)Give an approximation for the option Gamma Γ.",
    "steps": [
      {
        "step": 1,
        "desc": "Define the central difference approximation for the first derivative ∂W/∂y at point (y_j, τ_ℓ).",
        "expr": "∂W/∂y ≈ (W^ℓ_{j+1} - W^ℓ_{j-1}) / (2Δy)",
        "value": null
      },
      {
        "step": 2,
        "desc": "Define the central difference approximation for the second derivative ∂²W/∂y² at point (y_j, τ_ℓ).",
        "expr": "∂²W/∂y² ≈ (W^ℓ_{j+1} - 2W^ℓ_j + W^ℓ_{j-1}) / (Δy)²",
        "value": null
      },
      {
        "step": "final",
        "desc": "Provide the central difference approximations for both derivatives.",
        "expr": {
          "first_derivative": "∂W/∂y ≈ (W^ℓ_{j+1} - W^ℓ_{j-1}) / (2Δy)",
          "second_derivative": "∂²W/∂y² ≈ (W^ℓ_{j+1} - 2W^ℓ_j + W^ℓ_{j-1}) / (Δy)²"
        },
        "value": null
      }
    ]
  },
  {
    "qid": "Problemfive",
    "subid": "5iiiaB",
    "subquestion": "forward difference approximation of O(Δτ) for the partial derivative ∂W/∂τ.",
    "full_question": "The value V(S, t) of an option on an underlying asset with price S at time t satisfies the Black–Scholes PDE\n∂V/∂t + rS ∂V/∂S + (σ²/2) S² ∂²V/∂S² = rV          (3.1)\nfor 0 < S < ∞ and 0 < t < T. Assume the risk-free interest rate r and the volatility σ are known positive constants.\nAt expiry T, the payoff of an “exotic” option with strikes 0 < K₁ < K₂ is\n    f(S) =   0            if S < K₁\n           S − K₁        if K₁ ≤ S ≤ K₂\n           K₂ − K₁       if S > K₂.\ni) Carefully explain what the “initial” conditions are for this problem.\nii) The change of variables to log-moneyness y and time to expiry τ is\n    y = log(S/X)       and       τ = T − t,\nwhere X is a positive constant. This gives W(y, τ) = V(S, t).\na) Find expressions for\n    ∂W/∂τ,     ∂W/∂y,     ∂²W/∂y²\nin terms of the partial derivatives of V(S, t).\nb) Show that the Black and Scholes PDE (3.1) is equivalent to\n    -∂W/∂τ + (r − σ²/2) ∂W/∂y + (σ²/2) ∂²W/∂y² = rW        (3.2)\nin terms of the log-moneyness y and the time to expiry τ.\nc) What are the initial conditions for the transformed problem?\niii)Let y_max > 0 and consider the domain y ∈ [−y_max, y_max] and τ ∈ [0, T].\nConsider the grid (y_j, τ_ℓ) where\n    y_j = −y_max + jΔy,      j = 0, 1, 2, ..., 2(n+1)\n    τ_ℓ = ℓΔτ,               ℓ = 0, 1, 2, ..., m\n    Δy = y_max / (n + 1),    Δτ = T / m\na)Let W^ℓ_j ≈ W(y_j, τ_ℓ) denote the approximate solution. At the time to expiry τ_ℓ and log-moneyness y_j give:\nA) central difference approximations of O((Δy)²) for the partial derivatives ∂W/∂y and ∂²W/∂y².\nB) forward difference approximation of O(Δτ) for the partial derivative ∂W/∂τ.\nb)Show that the finite difference equation for the PDE (3.2) has the form\n    W^{ℓ+1}_j = α W^ℓ_{j−1} + β W^ℓ_j + γ W^ℓ_{j+1}     (3.3)\nand find the coefficients α, β and γ.\nc)A student claims that as the initial conditions are at expiry and the time stepping is from expiry at t_m = T back to t_0 = 0, equation (3.3) represents an implicit method so there are no restrictions on the values for Δτ and Δy that can be used. Is this correct? Justify your answer.\niv)The current asset price at t = 5 is S₀ = X e^{y₀}. \na)Give an approximation for the option Delta Δ.\nb)Give an approximation for the option Gamma Γ.",
    "steps": [
      {
        "step": 1,
        "desc": "Identify the forward difference formula for the first derivative with respect to time",
        "expr": "∂W/∂τ ≈ (W(y_j, τ_ℓ+1) - W(y_j, τ_ℓ)) / Δτ",
        "value": null
      },
      {
        "step": "final",
        "desc": "Apply the forward difference approximation to the partial derivative ∂W/∂τ",
        "expr": "∂W/∂τ ≈ (W^{ℓ+1}_j - W^ℓ_j) / Δτ",
        "value": null
      }
    ]
  },
  {
    "qid": "Problemfive",
    "subid": "5iiib",
    "subquestion": "Show that the finite difference equation for the PDE (3.2) has the form\n    W^{ℓ+1}_j = α W^ℓ_{j−1} + β W^ℓ_j + γ W^ℓ_{j+1}     (3.3)\nand find the coefficients α, β and γ.",
    "full_question": "The value V(S, t) of an option on an underlying asset with price S at time t satisfies the Black–Scholes PDE\n∂V/∂t + rS ∂V/∂S + (σ²/2) S² ∂²V/∂S² = rV          (3.1)\nfor 0 < S < ∞ and 0 < t < T. Assume the risk-free interest rate r and the volatility σ are known positive constants.\nAt expiry T, the payoff of an “exotic” option with strikes 0 < K₁ < K₂ is\n    f(S) =   0            if S < K₁\n           S − K₁        if K₁ ≤ S ≤ K₂\n           K₂ − K₁       if S > K₂.\ni) Carefully explain what the “initial” conditions are for this problem.\nii) The change of variables to log-moneyness y and time to expiry τ is\n    y = log(S/X)       and       τ = T − t,\nwhere X is a positive constant. This gives W(y, τ) = V(S, t).\na) Find expressions for\n    ∂W/∂τ,     ∂W/∂y,     ∂²W/∂y²\nin terms of the partial derivatives of V(S, t).\nb) Show that the Black and Scholes PDE (3.1) is equivalent to\n    -∂W/∂τ + (r − σ²/2) ∂W/∂y + (σ²/2) ∂²W/∂y² = rW        (3.2)\nin terms of the log-moneyness y and the time to expiry τ.\nc) What are the initial conditions for the transformed problem?\niii)Let y_max > 0 and consider the domain y ∈ [−y_max, y_max] and τ ∈ [0, T].\nConsider the grid (y_j, τ_ℓ) where\n    y_j = −y_max + jΔy,      j = 0, 1, 2, ..., 2(n+1)\n    τ_ℓ = ℓΔτ,               ℓ = 0, 1, 2, ..., m\n    Δy = y_max / (n + 1),    Δτ = T / m\na)Let W^ℓ_j ≈ W(y_j, τ_ℓ) denote the approximate solution. At the time to expiry τ_ℓ and log-moneyness y_j give:\nA) central difference approximations of O((Δy)²) for the partial derivatives ∂W/∂y and ∂²W/∂y².\nB) forward difference approximation of O(Δτ) for the partial derivative ∂W/∂τ.\nb)Show that the finite difference equation for the PDE (3.2) has the form\n    W^{ℓ+1}_j = α W^ℓ_{j−1} + β W^ℓ_j + γ W^ℓ_{j+1}     (3.3)\nand find the coefficients α, β and γ.\nc)A student claims that as the initial conditions are at expiry and the time stepping is from expiry at t_m = T back to t_0 = 0, equation (3.3) represents an implicit method so there are no restrictions on the values for Δτ and Δy that can be used. Is this correct? Justify your answer.\niv)The current asset price at t = 6 is S₀ = X e^{y₀}. \na)Give an approximation for the option Delta Δ.\nb)Give an approximation for the option Gamma Γ.",
    "steps": [
      {
        "step": 1,
        "desc": "Start with the central difference approximation for ∂W/∂y at (y_j, τ_ℓ)",
        "expr": "∂W/∂y ≈ (W^ℓ_{j+1} - W^ℓ_{j-1}) / (2Δy)",
        "value": null
      },
      {
        "step": 2,
        "desc": "Start with the central difference approximation for ∂²W/∂y² at (y_j, τ_ℓ)",
        "expr": "∂²W/∂y² ≈ (W^ℓ_{j+1} - 2W^ℓ_j + W^ℓ_{j-1}) / (Δy)²",
        "value": null
      },
      {
        "step": 3,
        "desc": "Start with the forward difference approximation for ∂W/∂τ at (y_j, τ_ℓ)",
        "expr": "∂W/∂τ ≈ (W^{ℓ+1}_j - W^ℓ_j) / Δτ",
        "value": null
      },
      {
        "step": 4,
        "desc": "Substitute the finite difference approximations into the PDE (3.2)",
        "expr": "-(W^{ℓ+1}_j - W^ℓ_j) / Δτ + (r - σ²/2) (W^ℓ_{j+1} - W^ℓ_{j-1}) / (2Δy) + (σ²/2) (W^ℓ_{j+1} - 2W^ℓ_j + W^ℓ_{j-1}) / (Δy)² = rW^ℓ_j",
        "value": null
      },
      {
        "step": 5,
        "desc": "Rearrange the equation to solve for W^{ℓ+1}_j",
        "expr": "W^{ℓ+1}_j = W^ℓ_j + Δτ[(r - σ²/2) (W^ℓ_{j+1} - W^ℓ_{j-1}) / (2Δy) + (σ²/2) (W^ℓ_{j+1} - 2W^ℓ_j + W^ℓ_{j-1}) / (Δy)² - rW^ℓ_j]",
        "value": null
      },
      {
        "step": 6,
        "desc": "Collect terms to match the form W^{ℓ+1}_j = α W^ℓ_{j−1} + β W^ℓ_j + γ W^ℓ_{j+1}",
        "expr": "W^{ℓ+1}_j = [Δτ((r - σ²/2) / (2Δy) + (σ²/2) / (Δy)²)] W^ℓ_{j-1} + [1 + Δτ(-2(σ²/2) / (Δy)² - r)] W^ℓ_j + [Δτ(-(r - σ²/2) / (2Δy) + (σ²/2) / (Δy)²)] W^ℓ_{j+1}",
        "value": null
      },
      {
        "step": "final",
        "desc": "Identify coefficients α, β, and γ",
        "expr": "α = Δτ((r - σ²/2) / (2Δy) + (σ²/2) / (Δy)²), β = 1 + Δτ(-2(σ²/2) / (Δy)² - r), γ = Δτ(-(r - σ²/2) / (2Δy) + (σ²/2) / (Δy)²)",
        "value": {
          "α": "Δτ((r - σ²/2) / (2Δy) + (σ²/2) / (Δy)²)",
          "β": "1 + Δτ(-2(σ²/2) / (Δy)² - r)",
          "γ": "Δτ(-(r - σ²/2) / (2Δy) + (σ²/2) / (Δy)²)"
        }
      }
    ]
  },
  {
    "qid": "Problemfive",
    "subid": "5iiiic",
    "subquestion": "A student claims that as the initial conditions are at expiry and the time stepping is from expiry at t_m = T back to t_0 = 0, equation (3.3) represents an implicit method so there are no restrictions on the values for Δτ and Δy that can be used. Is this correct? Justify your answer.",
    "full_question": "The value V(S, t) of an option on an underlying asset with price S at time t satisfies the Black–Scholes PDE\n∂V/∂t + rS ∂V/∂S + (σ²/2) S² ∂²V/∂S² = rV          (3.1)\nfor 0 < S < ∞ and 0 < t < T. Assume the risk-free interest rate r and the volatility σ are known positive constants.\nAt expiry T, the payoff of an “exotic” option with strikes 0 < K₁ < K₂ is\n    f(S) =   0            if S < K₁\n           S − K₁        if K₁ ≤ S ≤ K₂\n           K₂ − K₁       if S > K₂.\ni) Carefully explain what the “initial” conditions are for this problem.\nii) The change of variables to log-moneyness y and time to expiry τ is\n    y = log(S/X)       and       τ = T − t,\nwhere X is a positive constant. This gives W(y, τ) = V(S, t).\na) Find expressions for\n    ∂W/∂τ,     ∂W/∂y,     ∂²W/∂y²\nin terms of the partial derivatives of V(S, t).\nb) Show that the Black and Scholes PDE (3.1) is equivalent to\n    -∂W/∂τ + (r − σ²/2) ∂W/∂y + (σ²/2) ∂²W/∂y² = rW        (3.2)\nin terms of the log-moneyness y and the time to expiry τ.\nc) What are the initial conditions for the transformed problem?\niii)Let y_max > 0 and consider the domain y ∈ [−y_max, y_max] and τ ∈ [0, T].\nConsider the grid (y_j, τ_ℓ) where\n    y_j = −y_max + jΔy,      j = 0, 1, 2, ..., 2(n+1)\n    τ_ℓ = ℓΔτ,               ℓ = 0, 1, 2, ..., m\n    Δy = y_max / (n + 1),    Δτ = T / m\na)Let W^ℓ_j ≈ W(y_j, τ_ℓ) denote the approximate solution. At the time to expiry τ_ℓ and log-moneyness y_j give:\nA) central difference approximations of O((Δy)²) for the partial derivatives ∂W/∂y and ∂²W/∂y².\nB) forward difference approximation of O(Δτ) for the partial derivative ∂W/∂τ.\nb)Show that the finite difference equation for the PDE (3.2) has the form\n    W^{ℓ+1}_j = α W^ℓ_{j−1} + β W^ℓ_j + γ W^ℓ_{j+1}     (3.3)\nand find the coefficients α, β and γ.\nc)A student claims that as the initial conditions are at expiry and the time stepping is from expiry at t_m = T back to t_0 = 0, equation (3.3) represents an implicit method so there are no restrictions on the values for Δτ and Δy that can be used. Is this correct? Justify your answer.\niv)The current asset price at t = 7 is S₀ = X e^{y₀}. \na)Give an approximation for the option Delta Δ.\nb)Give an approximation for the option Gamma Γ.",
    "steps": [
      {
        "step": 1,
        "desc": "Identify the nature of the finite difference method used in equation (3.3).",
        "expr": "W^{ℓ+1}_j = α W^ℓ_{j−1} + β W^ℓ_j + γ W^ℓ_{j+1}",
        "value": "Explicit method"
      },
      {
        "step": 2,
        "desc": "Determine the time-stepping direction in the problem.",
        "expr": "τ_ℓ = ℓΔτ, ℓ = 0, 1, 2, ..., m",
        "value": "Backward in time"
      },
      {
        "step": 3,
        "desc": "Assess the stability condition for explicit methods.",
        "expr": "Stability condition for explicit methods",
        "value": "Δτ and Δy restrictions"
      },
      {
        "step": 4,
        "desc": "Evaluate the student's claim about the method being implicit.",
        "expr": "Implicit method",
        "value": "Incorrect claim"
      },
      {
        "step": "final",
        "desc": "Conclude whether the student's claim is correct.",
        "expr": "Restrictions on Δτ and Δy",
        "value": "Restrictions exist; claim is incorrect"
      }
    ]
  },
  {
    "qid": "Problemfive",
    "subid": "5iva",
    "subquestion": "Give an approximation for the option Delta Δ.",
    "full_question": "The value V(S, t) of an option on an underlying asset with price S at time t satisfies the Black–Scholes PDE\n∂V/∂t + rS ∂V/∂S + (σ²/2) S² ∂²V/∂S² = rV          (3.1)\nfor 0 < S < ∞ and 0 < t < T. Assume the risk-free interest rate r and the volatility σ are known positive constants.\nAt expiry T, the payoff of an “exotic” option with strikes 0 < K₁ < K₂ is\n    f(S) =   0            if S < K₁\n           S − K₁        if K₁ ≤ S ≤ K₂\n           K₂ − K₁       if S > K₂.\ni) Carefully explain what the “initial” conditions are for this problem.\nii) The change of variables to log-moneyness y and time to expiry τ is\n    y = log(S/X)       and       τ = T − t,\nwhere X is a positive constant. This gives W(y, τ) = V(S, t).\na) Find expressions for\n    ∂W/∂τ,     ∂W/∂y,     ∂²W/∂y²\nin terms of the partial derivatives of V(S, t).\nb) Show that the Black and Scholes PDE (3.1) is equivalent to\n    -∂W/∂τ + (r − σ²/2) ∂W/∂y + (σ²/2) ∂²W/∂y² = rW        (3.2)\nin terms of the log-moneyness y and the time to expiry τ.\nc) What are the initial conditions for the transformed problem?\niii)Let y_max > 0 and consider the domain y ∈ [−y_max, y_max] and τ ∈ [0, T].\nConsider the grid (y_j, τ_ℓ) where\n    y_j = −y_max + jΔy,      j = 0, 1, 2, ..., 2(n+1)\n    τ_ℓ = ℓΔτ,               ℓ = 0, 1, 2, ..., m\n    Δy = y_max / (n + 1),    Δτ = T / m\na)Let W^ℓ_j ≈ W(y_j, τ_ℓ) denote the approximate solution. At the time to expiry τ_ℓ and log-moneyness y_j give:\nA) central difference approximations of O((Δy)²) for the partial derivatives ∂W/∂y and ∂²W/∂y².\nB) forward difference approximation of O(Δτ) for the partial derivative ∂W/∂τ.\nb)Show that the finite difference equation for the PDE (3.2) has the form\n    W^{ℓ+1}_j = α W^ℓ_{j−1} + β W^ℓ_j + γ W^ℓ_{j+1}     (3.3)\nand find the coefficients α, β and γ.\nc)A student claims that as the initial conditions are at expiry and the time stepping is from expiry at t_m = T back to t_0 = 0, equation (3.3) represents an implicit method so there are no restrictions on the values for Δτ and Δy that can be used. Is this correct? Justify your answer.\niv)The current asset price at t = 8 is S₀ = X e^{y₀}. \na)Give an approximation for the option Delta Δ.\nb)Give an approximation for the option Gamma Γ.",
    "steps": [
      {
        "step": 1,
        "desc": "Identify the definition of Delta in terms of the option value V(S, t)",
        "expr": "Δ = ∂V/∂S",
        "value": null
      },
      {
        "step": 2,
        "desc": "Express V(S, t) in terms of W(y, τ) using the change of variables",
        "expr": "V(S, t) = W(y, τ)",
        "value": null
      },
      {
        "step": 3,
        "desc": "Express S in terms of y and X",
        "expr": "S = X e^y",
        "value": null
      },
      {
        "step": 4,
        "desc": "Use the chain rule to express ∂V/∂S in terms of ∂W/∂y",
        "expr": "∂V/∂S = (∂W/∂y) * (∂y/∂S)",
        "value": null
      },
      {
        "step": 5,
        "desc": "Calculate ∂y/∂S using y = log(S/X)",
        "expr": "∂y/∂S = 1/S",
        "value": null
      },
      {
        "step": 6,
        "desc": "Substitute ∂y/∂S into the expression for ∂V/∂S",
        "expr": "∂V/∂S = (∂W/∂y) * (1/S)",
        "value": null
      },
      {
        "step": 7,
        "desc": "Approximate ∂W/∂y using central difference at y = y₀",
        "expr": "(∂W/∂y) ≈ (W(y₀ + Δy, τ) - W(y₀ - Δy, τ)) / (2Δy)",
        "value": null
      },
      {
        "step": "final",
        "desc": "Substitute the approximation of ∂W/∂y into the expression for Delta",
        "expr": "Δ ≈ ((W(y₀ + Δy, τ) - W(y₀ - Δy, τ)) / (2Δy)) * (1/S₀)",
        "value": null
      }
    ]
  },
  {
    "qid": "Problemfive",
    "subid": "5ivb",
    "subquestion": "Give an approximation for the option Gamma Γ.",
    "full_question": "The value V(S, t) of an option on an underlying asset with price S at time t satisfies the Black–Scholes PDE\n∂V/∂t + rS ∂V/∂S + (σ²/2) S² ∂²V/∂S² = rV          (3.1)\nfor 0 < S < ∞ and 0 < t < T. Assume the risk-free interest rate r and the volatility σ are known positive constants.\nAt expiry T, the payoff of an “exotic” option with strikes 0 < K₁ < K₂ is\n    f(S) =   0            if S < K₁\n           S − K₁        if K₁ ≤ S ≤ K₂\n           K₂ − K₁       if S > K₂.\ni) Carefully explain what the “initial” conditions are for this problem.\nii) The change of variables to log-moneyness y and time to expiry τ is\n    y = log(S/X)       and       τ = T − t,\nwhere X is a positive constant. This gives W(y, τ) = V(S, t).\na) Find expressions for\n    ∂W/∂τ,     ∂W/∂y,     ∂²W/∂y²\nin terms of the partial derivatives of V(S, t).\nb) Show that the Black and Scholes PDE (3.1) is equivalent to\n    -∂W/∂τ + (r − σ²/2) ∂W/∂y + (σ²/2) ∂²W/∂y² = rW        (3.2)\nin terms of the log-moneyness y and the time to expiry τ.\nc) What are the initial conditions for the transformed problem?\niii)Let y_max > 0 and consider the domain y ∈ [−y_max, y_max] and τ ∈ [0, T].\nConsider the grid (y_j, τ_ℓ) where\n    y_j = −y_max + jΔy,      j = 0, 1, 2, ..., 2(n+1)\n    τ_ℓ = ℓΔτ,               ℓ = 0, 1, 2, ..., m\n    Δy = y_max / (n + 1),    Δτ = T / m\na)Let W^ℓ_j ≈ W(y_j, τ_ℓ) denote the approximate solution. At the time to expiry τ_ℓ and log-moneyness y_j give:\nA) central difference approximations of O((Δy)²) for the partial derivatives ∂W/∂y and ∂²W/∂y².\nB) forward difference approximation of O(Δτ) for the partial derivative ∂W/∂τ.\nb)Show that the finite difference equation for the PDE (3.2) has the form\n    W^{ℓ+1}_j = α W^ℓ_{j−1} + β W^ℓ_j + γ W^ℓ_{j+1}     (3.3)\nand find the coefficients α, β and γ.\nc)A student claims that as the initial conditions are at expiry and the time stepping is from expiry at t_m = T back to t_0 = 0, equation (3.3) represents an implicit method so there are no restrictions on the values for Δτ and Δy that can be used. Is this correct? Justify your answer.\niv)The current asset price at t = 9 is S₀ = X e^{y₀}. \na)Give an approximation for the option Delta Δ.\nb)Give an approximation for the option Gamma Γ.",
    "steps": [
      {
        "step": 1,
        "desc": "Identify the expression for Gamma in terms of W",
        "expr": "Γ = ∂²V/∂S² = ∂²W/∂y² * (1/S²)",
        "value": null
      },
      {
        "step": 2,
        "desc": "Use central difference approximation for ∂²W/∂y²",
        "expr": "∂²W/∂y² ≈ (W^ℓ_{j+1} - 2W^ℓ_j + W^ℓ_{j-1}) / (Δy)²",
        "value": null
      },
      {
        "step": 3,
        "desc": "Substitute the central difference approximation into the expression for Gamma",
        "expr": "Γ ≈ (W^ℓ_{j+1} - 2W^ℓ_j + W^ℓ_{j-1}) / (S₀² * (Δy)²)",
        "value": null
      },
      {
        "step": "final",
        "desc": "Provide the final approximation for Gamma",
        "expr": "Γ ≈ (W^ℓ_{j+1} - 2W^ℓ_j + W^ℓ_{j-1}) / (S₀² * (Δy)²)",
        "value": null
      }
    ]
  },
  {
    "qid": "Problemsix",
    "subid": "6ia",
    "subquestion": "Define the corresponding cumulative distribution function (cdf) P.",
    "full_question": "i)Consider the expected value\n    E[h] = ∫₀^∞ h(x)p(x) dx,\nwhere p: ℝ → ℝ is a probability density function (pdf) with p(x) = 0 for all x < 0 and p(x) > 0 for all x > 0.\na) Define the corresponding cumulative distribution function (cdf) P.\nb) What properties does P possess?\nc) Use the cdf P to transform the expected value E[h] into an integral over [0, 1].\nii) Consider estimating the d-dimensional variance\n    Var[f] = E[(f − μ)²] = ∫_{[0,1]^d} (f(x) − μ)² p(x) dx,        (4.1)\nwhere p : [0,1]^d → ℝ is a probability density function (pdf) and μ = E[f] is known.\nA 'low-discrepancy' point set {x₁, ..., x_N} has\n    D^*(x₁,...,x_N) ≤ c_d * (log N)^{d−1} / N,                   (4.2)\nwhere c_d is a positive constant which does not depend on N.\nThe Koksma–Hlawka inequality is:\n    | ∫_{[0,1]^d} f(x) dx − (1/N) Σ_{k=1}^N f(x_k) | ≤ V(f) D^*(x₁,...,x_N).   (4.3)\na) Explain what the star discrepancy D^*(x₁,...,x_N) is.\nb) Outline the key steps in a Monte-Carlo method to estimate (4.1).\nc) Compare the integration errors when using a Monte-Carlo method with using a “low-discrepancy” point set.\nd) Consider a problem with d = 20 and N = 10²⁰.\nA) Evaluate (log N)^{d−1} and N^{1/2}.\nB) What are the implications for using a “low-discrepancy” point set satisfying (4.2)?\ne) Outline the key ideas in using a function g which approximates f² in a variance reduction technique to estimate Var[f].\niii) In the CEV model a process S_t follows the SDE\n    dS_t / S_t = μ dt + σ S_t^{γ−1} dW_t,       t ∈ (0, T],      (4.4)\nwhere W_t is a Wiener process, μ, σ, γ are positive constants, and S₀ is given.\na) Derive an expression for S_{t+dt} from (4.4).\nb) What are the key properties of a Wiener process W_t?\nc) Let the time interval [0, T] be discretized by:\n    t_i = iΔt,    i = 0,...,m,     Δt = T / m.\nWrite down the formula for a discrete approximation Ŝ_i ≈ S_{t_i},  i = 1,...,m of the CEV process (4.4).",
    "steps": [
      {
        "step": 1,
        "desc": "Identify the definition of a cumulative distribution function (cdf) for a probability density function (pdf) p(x).",
        "expr": "P(x) = ∫_{-∞}^x p(t) dt",
        "value": null
      },
      {
        "step": 2,
        "desc": "Since p(x) = 0 for all x < 0, the lower limit of integration can be changed from -∞ to 0.",
        "expr": "P(x) = ∫_{0}^x p(t) dt",
        "value": null
      },
      {
        "step": "final",
        "desc": "Define the cumulative distribution function (cdf) P for the given pdf p(x).",
        "expr": "P(x) = ∫_{0}^x p(t) dt",
        "value": "P(x) = ∫_{0}^x p(t) dt"
      }
    ]
  },
  {
    "qid": "Problemsix",
    "subid": "6ib",
    "subquestion": "What properties does P possess?",
    "full_question": "i)Consider the expected value\n    E[h] = ∫₀^∞ h(x)p(x) dx,\nwhere p: ℝ → ℝ is a probability density function (pdf) with p(x) = 0 for all x < 0 and p(x) > 0 for all x > 0.\na) Define the corresponding cumulative distribution function (cdf) P.\nb) What properties does P possess?\nc) Use the cdf P to transform the expected value E[h] into an integral over [0, 1].\nii) Consider estimating the d-dimensional variance\n    Var[f] = E[(f − μ)²] = ∫_{[0,1]^d} (f(x) − μ)² p(x) dx,        (4.1)\nwhere p : [0,1]^d → ℝ is a probability density function (pdf) and μ = E[f] is known.\nA 'low-discrepancy' point set {x₁, ..., x_N} has\n    D^*(x₁,...,x_N) ≤ c_d * (log N)^{d−1} / N,                   (4.2)\nwhere c_d is a positive constant which does not depend on N.\nThe Koksma–Hlawka inequality is:\n    | ∫_{[0,1]^d} f(x) dx − (1/N) Σ_{k=1}^N f(x_k) | ≤ V(f) D^*(x₁,...,x_N).   (4.3)\na) Explain what the star discrepancy D^*(x₁,...,x_N) is.\nb) Outline the key steps in a Monte-Carlo method to estimate (4.1).\nc) Compare the integration errors when using a Monte-Carlo method with using a “low-discrepancy” point set.\nd) Consider a problem with d = 20 and N = 10²⁰.\nA) Evaluate (log N)^{d−1} and N^{1/2}.\nB) What are the implications for using a “low-discrepancy” point set satisfying (4.2)?\ne) Outline the key ideas in using a function g which approximates f² in a variance reduction technique to estimate Var[f].\niii) In the CEV model a process S_t follows the SDE\n    dS_t / S_t = μ dt + σ S_t^{γ−1} dW_t,       t ∈ (0, T],      (4.4)\nwhere W_t is a Wiener process, μ, σ, γ are positive constants, and S₀ is given.\na) Derive an expression for S_{t+dt} from (4.4).\nb) What are the key properties of a Wiener process W_t?\nc) Let the time interval [0, T] be discretized by:\n    t_i = iΔt,    i = 0,...,m,     Δt = T / m.\nWrite down the formula for a discrete approximation Ŝ_i ≈ S_{t_i},  i = 1,...,m of the CEV process (4.5).",
    "steps": [
      {
        "step": 1,
        "desc": "Define the cumulative distribution function (cdf) P for the probability density function (pdf) p.",
        "expr": "P(x) = ∫_{0}^{x} p(t) dt",
        "value": null
      },
      {
        "step": 2,
        "desc": "Identify the range of P(x) based on the properties of a cdf.",
        "expr": "0 ≤ P(x) ≤ 1",
        "value": null
      },
      {
        "step": 3,
        "desc": "Determine the behavior of P(x) as x approaches 0 from the right.",
        "expr": "P(0) = 0",
        "value": null
      },
      {
        "step": 4,
        "desc": "Determine the behavior of P(x) as x approaches infinity.",
        "expr": "P(∞) = 1",
        "value": null
      },
      {
        "step": 5,
        "desc": "Establish the non-decreasing property of P(x).",
        "expr": "P(x_1) ≤ P(x_2) for x_1 < x_2",
        "value": null
      },
      {
        "step": 6,
        "desc": "Identify the right-continuity property of P(x).",
        "expr": "P(x) is right-continuous",
        "value": null
      },
      {
        "step": "final",
        "desc": "Summarize the properties of the cumulative distribution function P.",
        "expr": null,
        "value": "P(x) is a non-decreasing, right-continuous function with P(0) = 0 and P(∞) = 1, and it maps to the interval [0, 1]."
      }
    ]
  },
  {
    "qid": "Problemsix",
    "subid": "6ic",
    "subquestion": "Use the cdf P to transform the expected value E[h] into an integral over [0, 1].",
    "full_question": "i)Consider the expected value\n    E[h] = ∫₀^∞ h(x)p(x) dx,\nwhere p: ℝ → ℝ is a probability density function (pdf) with p(x) = 0 for all x < 0 and p(x) > 0 for all x > 0.\na) Define the corresponding cumulative distribution function (cdf) P.\nb) What properties does P possess?\nc) Use the cdf P to transform the expected value E[h] into an integral over [0, 1].\nii) Consider estimating the d-dimensional variance\n    Var[f] = E[(f − μ)²] = ∫_{[0,1]^d} (f(x) − μ)² p(x) dx,        (4.1)\nwhere p : [0,1]^d → ℝ is a probability density function (pdf) and μ = E[f] is known.\nA 'low-discrepancy' point set {x₁, ..., x_N} has\n    D^*(x₁,...,x_N) ≤ c_d * (log N)^{d−1} / N,                   (4.2)\nwhere c_d is a positive constant which does not depend on N.\nThe Koksma–Hlawka inequality is:\n    | ∫_{[0,1]^d} f(x) dx − (1/N) Σ_{k=1}^N f(x_k) | ≤ V(f) D^*(x₁,...,x_N).   (4.3)\na) Explain what the star discrepancy D^*(x₁,...,x_N) is.\nb) Outline the key steps in a Monte-Carlo method to estimate (4.1).\nc) Compare the integration errors when using a Monte-Carlo method with using a “low-discrepancy” point set.\nd) Consider a problem with d = 20 and N = 10²⁰.\nA) Evaluate (log N)^{d−1} and N^{1/2}.\nB) What are the implications for using a “low-discrepancy” point set satisfying (4.2)?\ne) Outline the key ideas in using a function g which approximates f² in a variance reduction technique to estimate Var[f].\niii) In the CEV model a process S_t follows the SDE\n    dS_t / S_t = μ dt + σ S_t^{γ−1} dW_t,       t ∈ (0, T],      (4.4)\nwhere W_t is a Wiener process, μ, σ, γ are positive constants, and S₀ is given.\na) Derive an expression for S_{t+dt} from (4.4).\nb) What are the key properties of a Wiener process W_t?\nc) Let the time interval [0, T] be discretized by:\n    t_i = iΔt,    i = 0,...,m,     Δt = T / m.\nWrite down the formula for a discrete approximation Ŝ_i ≈ S_{t_i},  i = 1,...,m of the CEV process (4.6).",
    "steps": [
      {
        "step": 1,
        "desc": "Define the cumulative distribution function (cdf) P corresponding to the pdf p.",
        "expr": "P(x) = ∫₀^x p(t) dt",
        "value": null
      },
      {
        "step": 2,
        "desc": "Use the cdf P to perform a change of variables in the integral for E[h].",
        "expr": "Let u = P(x), then du = p(x) dx",
        "value": null
      },
      {
        "step": 3,
        "desc": "Determine the limits of integration for the new variable u.",
        "expr": "u = P(0) to u = P(∞)",
        "value": "0 to 1"
      },
      {
        "step": 4,
        "desc": "Express the expected value E[h] in terms of the new variable u.",
        "expr": "E[h] = ∫₀¹ h(P⁻¹(u)) du",
        "value": null
      },
      {
        "step": "final",
        "desc": "The expected value E[h] is transformed into an integral over [0, 1].",
        "expr": "E[h] = ∫₀¹ h(P⁻¹(u)) du",
        "value": null
      }
    ]
  },
  {
    "qid": "Problemsix",
    "subid": "6iia",
    "subquestion": "Explain what the star discrepancy D^*(x₁,...,x_N) is.",
    "full_question": "i)Consider the expected value\n    E[h] = ∫₀^∞ h(x)p(x) dx,\nwhere p: ℝ → ℝ is a probability density function (pdf) with p(x) = 0 for all x < 0 and p(x) > 0 for all x > 0.\na) Define the corresponding cumulative distribution function (cdf) P.\nb) What properties does P possess?\nc) Use the cdf P to transform the expected value E[h] into an integral over [0, 1].\nii) Consider estimating the d-dimensional variance\n    Var[f] = E[(f − μ)²] = ∫_{[0,1]^d} (f(x) − μ)² p(x) dx,        (4.1)\nwhere p : [0,1]^d → ℝ is a probability density function (pdf) and μ = E[f] is known.\nA 'low-discrepancy' point set {x₁, ..., x_N} has\n    D^*(x₁,...,x_N) ≤ c_d * (log N)^{d−1} / N,                   (4.2)\nwhere c_d is a positive constant which does not depend on N.\nThe Koksma–Hlawka inequality is:\n    | ∫_{[0,1]^d} f(x) dx − (1/N) Σ_{k=1}^N f(x_k) | ≤ V(f) D^*(x₁,...,x_N).   (4.3)\na) Explain what the star discrepancy D^*(x₁,...,x_N) is.\nb) Outline the key steps in a Monte-Carlo method to estimate (4.1).\nc) Compare the integration errors when using a Monte-Carlo method with using a “low-discrepancy” point set.\nd) Consider a problem with d = 20 and N = 10²⁰.\nA) Evaluate (log N)^{d−1} and N^{1/2}.\nB) What are the implications for using a “low-discrepancy” point set satisfying (4.2)?\ne) Outline the key ideas in using a function g which approximates f² in a variance reduction technique to estimate Var[f].\niii) In the CEV model a process S_t follows the SDE\n    dS_t / S_t = μ dt + σ S_t^{γ−1} dW_t,       t ∈ (0, T],      (4.4)\nwhere W_t is a Wiener process, μ, σ, γ are positive constants, and S₀ is given.\na) Derive an expression for S_{t+dt} from (4.4).\nb) What are the key properties of a Wiener process W_t?\nc) Let the time interval [0, T] be discretized by:\n    t_i = iΔt,    i = 0,...,m,     Δt = T / m.\nWrite down the formula for a discrete approximation Ŝ_i ≈ S_{t_i},  i = 1,...,m of the CEV process (4.7).",
    "steps": [
      {
        "step": 1,
        "desc": "Define star discrepancy D^*(x₁,...,x_N) as a measure of uniformity of a point set in [0,1]^d.",
        "expr": "D^*(x₁,...,x_N) = sup_{B ∈ J} |(1/N) Σ_{k=1}^N 1_{x_k ∈ B} - λ(B)|",
        "value": null
      },
      {
        "step": 2,
        "desc": "Identify J as the set of all subintervals of [0,1]^d of the form [0,u) = [0,u₁) × ... × [0,u_d) with u ∈ [0,1]^d.",
        "expr": "J = {[0,u) | u ∈ [0,1]^d}",
        "value": null
      },
      {
        "step": 3,
        "desc": "Define λ(B) as the Lebesgue measure of the interval B.",
        "expr": "λ(B) = u₁ * u₂ * ... * u_d",
        "value": null
      },
      {
        "step": 4,
        "desc": "Explain that D^*(x₁,...,x_N) quantifies the maximum deviation between the empirical distribution of the point set and the uniform distribution.",
        "expr": null,
        "value": null
      },
      {
        "step": "final",
        "desc": "Conclude that a lower star discrepancy indicates a more uniformly distributed point set.",
        "expr": null,
        "value": null
      }
    ]
  },
  {
    "qid": "Problemsix",
    "subid": "6iib",
    "subquestion": "Outline the key steps in a Monte-Carlo method to estimate (4.1).",
    "full_question": "i)Consider the expected value\n    E[h] = ∫₀^∞ h(x)p(x) dx,\nwhere p: ℝ → ℝ is a probability density function (pdf) with p(x) = 0 for all x < 0 and p(x) > 0 for all x > 0.\na) Define the corresponding cumulative distribution function (cdf) P.\nb) What properties does P possess?\nc) Use the cdf P to transform the expected value E[h] into an integral over [0, 1].\nii) Consider estimating the d-dimensional variance\n    Var[f] = E[(f − μ)²] = ∫_{[0,1]^d} (f(x) − μ)² p(x) dx,        (4.1)\nwhere p : [0,1]^d → ℝ is a probability density function (pdf) and μ = E[f] is known.\nA 'low-discrepancy' point set {x₁, ..., x_N} has\n    D^*(x₁,...,x_N) ≤ c_d * (log N)^{d−1} / N,                   (4.2)\nwhere c_d is a positive constant which does not depend on N.\nThe Koksma–Hlawka inequality is:\n    | ∫_{[0,1]^d} f(x) dx − (1/N) Σ_{k=1}^N f(x_k) | ≤ V(f) D^*(x₁,...,x_N).   (4.3)\na) Explain what the star discrepancy D^*(x₁,...,x_N) is.\nb) Outline the key steps in a Monte-Carlo method to estimate (4.1).\nc) Compare the integration errors when using a Monte-Carlo method with using a “low-discrepancy” point set.\nd) Consider a problem with d = 20 and N = 10²⁰.\nA) Evaluate (log N)^{d−1} and N^{1/2}.\nB) What are the implications for using a “low-discrepancy” point set satisfying (4.2)?\ne) Outline the key ideas in using a function g which approximates f² in a variance reduction technique to estimate Var[f].\niii) In the CEV model a process S_t follows the SDE\n    dS_t / S_t = μ dt + σ S_t^{γ−1} dW_t,       t ∈ (0, T],      (4.4)\nwhere W_t is a Wiener process, μ, σ, γ are positive constants, and S₀ is given.\na) Derive an expression for S_{t+dt} from (4.4).\nb) What are the key properties of a Wiener process W_t?\nc) Let the time interval [0, T] be discretized by:\n    t_i = iΔt,    i = 0,...,m,     Δt = T / m.\nWrite down the formula for a discrete approximation Ŝ_i ≈ S_{t_i},  i = 1,...,m of the CEV process (4.8).",
    "steps": [
      {
        "step": 1,
        "desc": "Define the function to be integrated, which is the squared difference from the mean.",
        "expr": "g(x) = (f(x) - μ)^2",
        "value": null
      },
      {
        "step": 2,
        "desc": "Generate N random points x_k uniformly distributed over the domain [0,1]^d.",
        "expr": "{x_1, x_2, ..., x_N} ~ U([0,1]^d)",
        "value": null
      },
      {
        "step": 3,
        "desc": "Evaluate the function g at each of the N random points.",
        "expr": "g(x_k) for k = 1, 2, ..., N",
        "value": null
      },
      {
        "step": 4,
        "desc": "Compute the average of the function values obtained in the previous step.",
        "expr": "(1/N) Σ_{k=1}^N g(x_k)",
        "value": null
      },
      {
        "step": 5,
        "desc": "Estimate the integral as the average computed in the previous step.",
        "expr": "Var[f] ≈ (1/N) Σ_{k=1}^N g(x_k)",
        "value": null
      },
      {
        "step": "final",
        "desc": "Return the estimated variance as the final result.",
        "expr": "Var[f]",
        "value": null
      }
    ]
  },
  {
    "qid": "Problemsix",
    "subid": "6iiic",
    "subquestion": "Compare the integration errors when using a Monte-Carlo method with using a “low-discrepancy” point set.",
    "full_question": "i)Consider the expected value\n    E[h] = ∫₀^∞ h(x)p(x) dx,\nwhere p: ℝ → ℝ is a probability density function (pdf) with p(x) = 0 for all x < 0 and p(x) > 0 for all x > 0.\na) Define the corresponding cumulative distribution function (cdf) P.\nb) What properties does P possess?\nc) Use the cdf P to transform the expected value E[h] into an integral over [0, 1].\nii) Consider estimating the d-dimensional variance\n    Var[f] = E[(f − μ)²] = ∫_{[0,1]^d} (f(x) − μ)² p(x) dx,        (4.1)\nwhere p : [0,1]^d → ℝ is a probability density function (pdf) and μ = E[f] is known.\nA 'low-discrepancy' point set {x₁, ..., x_N} has\n    D^*(x₁,...,x_N) ≤ c_d * (log N)^{d−1} / N,                   (4.2)\nwhere c_d is a positive constant which does not depend on N.\nThe Koksma–Hlawka inequality is:\n    | ∫_{[0,1]^d} f(x) dx − (1/N) Σ_{k=1}^N f(x_k) | ≤ V(f) D^*(x₁,...,x_N).   (4.3)\na) Explain what the star discrepancy D^*(x₁,...,x_N) is.\nb) Outline the key steps in a Monte-Carlo method to estimate (4.1).\nc) Compare the integration errors when using a Monte-Carlo method with using a “low-discrepancy” point set.\nd) Consider a problem with d = 20 and N = 10²⁰.\nA) Evaluate (log N)^{d−1} and N^{1/2}.\nB) What are the implications for using a “low-discrepancy” point set satisfying (4.2)?\ne) Outline the key ideas in using a function g which approximates f² in a variance reduction technique to estimate Var[f].\niii) In the CEV model a process S_t follows the SDE\n    dS_t / S_t = μ dt + σ S_t^{γ−1} dW_t,       t ∈ (0, T],      (4.4)\nwhere W_t is a Wiener process, μ, σ, γ are positive constants, and S₀ is given.\na) Derive an expression for S_{t+dt} from (4.4).\nb) What are the key properties of a Wiener process W_t?\nc) Let the time interval [0, T] be discretized by:\n    t_i = iΔt,    i = 0,...,m,     Δt = T / m.\nWrite down the formula for a discrete approximation Ŝ_i ≈ S_{t_i},  i = 1,...,m of the CEV process (4.9).",
    "steps": [
      {
        "step": 1,
        "desc": "Define the integration error for the Monte-Carlo method",
        "expr": "E_MC = |∫_{[0,1]^d} f(x) dx - (1/N) Σ_{k=1}^N f(x_k)|",
        "value": null
      },
      {
        "step": 2,
        "desc": "Define the integration error for the low-discrepancy point set using Koksma-Hlawka inequality",
        "expr": "E_LD = V(f) D^*(x_1,...,x_N)",
        "value": null
      },
      {
        "step": 3,
        "desc": "Express the Monte-Carlo error in terms of variance and sample size",
        "expr": "E_MC ≈ σ(f) / √N",
        "value": null
      },
      {
        "step": 4,
        "desc": "Express the low-discrepancy error using the star discrepancy bound",
        "expr": "E_LD ≤ V(f) c_d (log N)^{d-1} / N",
        "value": null
      },
      {
        "step": 5,
        "desc": "Compare the asymptotic behavior of the errors",
        "expr": "E_MC: O(1/√N), E_LD: O((log N)^{d-1}/N)",
        "value": null
      },
      {
        "step": "final",
        "desc": "Conclude that low-discrepancy point sets can achieve lower integration error than Monte-Carlo for large N and moderate d",
        "expr": null,
        "value": null
      }
    ]
  },
  {
    "qid": "Problemsix",
    "subid": "6iidA",
    "subquestion": "Evaluate (log N)^{d−1} and N^{1/2}.",
    "full_question": "i)Consider the expected value\n    E[h] = ∫₀^∞ h(x)p(x) dx,\nwhere p: ℝ → ℝ is a probability density function (pdf) with p(x) = 0 for all x < 0 and p(x) > 0 for all x > 0.\na) Define the corresponding cumulative distribution function (cdf) P.\nb) What properties does P possess?\nc) Use the cdf P to transform the expected value E[h] into an integral over [0, 1].\nii) Consider estimating the d-dimensional variance\n    Var[f] = E[(f − μ)²] = ∫_{[0,1]^d} (f(x) − μ)² p(x) dx,        (4.1)\nwhere p : [0,1]^d → ℝ is a probability density function (pdf) and μ = E[f] is known.\nA 'low-discrepancy' point set {x₁, ..., x_N} has\n    D^*(x₁,...,x_N) ≤ c_d * (log N)^{d−1} / N,                   (4.2)\nwhere c_d is a positive constant which does not depend on N.\nThe Koksma–Hlawka inequality is:\n    | ∫_{[0,1]^d} f(x) dx − (1/N) Σ_{k=1}^N f(x_k) | ≤ V(f) D^*(x₁,...,x_N).   (4.3)\na) Explain what the star discrepancy D^*(x₁,...,x_N) is.\nb) Outline the key steps in a Monte-Carlo method to estimate (4.1).\nc) Compare the integration errors when using a Monte-Carlo method with using a “low-discrepancy” point set.\nd) Consider a problem with d = 20 and N = 10²⁰.\nA) Evaluate (log N)^{d−1} and N^{1/2}.\nB) What are the implications for using a “low-discrepancy” point set satisfying (4.2)?\ne) Outline the key ideas in using a function g which approximates f² in a variance reduction technique to estimate Var[f].\niii) In the CEV model a process S_t follows the SDE\n    dS_t / S_t = μ dt + σ S_t^{γ−1} dW_t,       t ∈ (0, T],      (4.4)\nwhere W_t is a Wiener process, μ, σ, γ are positive constants, and S₀ is given.\na) Derive an expression for S_{t+dt} from (4.4).\nb) What are the key properties of a Wiener process W_t?\nc) Let the time interval [0, T] be discretized by:\n    t_i = iΔt,    i = 0,...,m,     Δt = T / m.\nWrite down the formula for a discrete approximation Ŝ_i ≈ S_{t_i},  i = 1,...,m of the CEV process (4.10).",
    "steps": [
      {
        "step": 1,
        "desc": "Calculate log N",
        "expr": "log(10^20)",
        "value": 20
      },
      {
        "step": 2,
        "desc": "Calculate (log N)^(d-1)",
        "expr": "(20)^(20-1)",
        "value": 104857600000000000000000000
      },
      {
        "step": 3,
        "desc": "Calculate N^(1/2)",
        "expr": "(10^20)^(1/2)",
        "value": 10000000000
      }
    ]
  },
  {
    "qid": "Problemsix",
    "subid": "6iidB",
    "subquestion": "What are the implications for using a “low-discrepancy” point set satisfying (4.2)?",
    "full_question": "i)Consider the expected value\n    E[h] = ∫₀^∞ h(x)p(x) dx,\nwhere p: ℝ → ℝ is a probability density function (pdf) with p(x) = 0 for all x < 0 and p(x) > 0 for all x > 0.\na) Define the corresponding cumulative distribution function (cdf) P.\nb) What properties does P possess?\nc) Use the cdf P to transform the expected value E[h] into an integral over [0, 1].\nii) Consider estimating the d-dimensional variance\n    Var[f] = E[(f − μ)²] = ∫_{[0,1]^d} (f(x) − μ)² p(x) dx,        (4.1)\nwhere p : [0,1]^d → ℝ is a probability density function (pdf) and μ = E[f] is known.\nA 'low-discrepancy' point set {x₁, ..., x_N} has\n    D^*(x₁,...,x_N) ≤ c_d * (log N)^{d−1} / N,                   (4.2)\nwhere c_d is a positive constant which does not depend on N.\nThe Koksma–Hlawka inequality is:\n    | ∫_{[0,1]^d} f(x) dx − (1/N) Σ_{k=1}^N f(x_k) | ≤ V(f) D^*(x₁,...,x_N).   (4.3)\na) Explain what the star discrepancy D^*(x₁,...,x_N) is.\nb) Outline the key steps in a Monte-Carlo method to estimate (4.1).\nc) Compare the integration errors when using a Monte-Carlo method with using a “low-discrepancy” point set.\nd) Consider a problem with d = 20 and N = 10²⁰.\nA) Evaluate (log N)^{d−1} and N^{1/2}.\nB) What are the implications for using a “low-discrepancy” point set satisfying (4.2)?\ne) Outline the key ideas in using a function g which approximates f² in a variance reduction technique to estimate Var[f].\niii) In the CEV model a process S_t follows the SDE\n    dS_t / S_t = μ dt + σ S_t^{γ−1} dW_t,       t ∈ (0, T],      (4.4)\nwhere W_t is a Wiener process, μ, σ, γ are positive constants, and S₀ is given.\na) Derive an expression for S_{t+dt} from (4.4).\nb) What are the key properties of a Wiener process W_t?\nc) Let the time interval [0, T] be discretized by:\n    t_i = iΔt,    i = 0,...,m,     Δt = T / m.\nWrite down the formula for a discrete approximation Ŝ_i ≈ S_{t_i},  i = 1,...,m of the CEV process (4.11).",
    "steps": [
      {
        "step": 1,
        "desc": "Identify the expression for star discrepancy D^*(x₁,...,x_N) from the given inequality",
        "expr": "D^*(x₁,...,x_N) ≤ c_d * (log N)^{d−1} / N",
        "value": null
      },
      {
        "step": 2,
        "desc": "Evaluate (log N)^{d−1} for d = 20 and N = 10^20",
        "expr": "(log(10^20))^{19}",
        "value": "20^{19}"
      },
      {
        "step": 3,
        "desc": "Evaluate N^{1/2} for N = 10^20",
        "expr": "(10^20)^{1/2}",
        "value": "10^{10}"
      },
      {
        "step": 4,
        "desc": "Compare (log N)^{d−1} and N^{1/2} to understand the implications",
        "expr": "20^{19} vs 10^{10}",
        "value": "20^{19} is much larger than 10^{10}"
      },
      {
        "step": 5,
        "desc": "Determine the implications for using a low-discrepancy point set",
        "expr": null,
        "value": "Using a low-discrepancy point set is beneficial as it provides a smaller error bound compared to Monte Carlo, especially in high dimensions like d=20."
      }
    ]
  },
  {
    "qid": "Problemsix",
    "subid": "6iie",
    "subquestion": "Outline the key ideas in using a function g which approximates f² in a variance reduction technique to estimate Var[f].",
    "full_question": "i)Consider the expected value\n    E[h] = ∫₀^∞ h(x)p(x) dx,\nwhere p: ℝ → ℝ is a probability density function (pdf) with p(x) = 0 for all x < 0 and p(x) > 0 for all x > 0.\na) Define the corresponding cumulative distribution function (cdf) P.\nb) What properties does P possess?\nc) Use the cdf P to transform the expected value E[h] into an integral over [0, 1].\nii) Consider estimating the d-dimensional variance\n    Var[f] = E[(f − μ)²] = ∫_{[0,1]^d} (f(x) − μ)² p(x) dx,        (4.1)\nwhere p : [0,1]^d → ℝ is a probability density function (pdf) and μ = E[f] is known.\nA 'low-discrepancy' point set {x₁, ..., x_N} has\n    D^*(x₁,...,x_N) ≤ c_d * (log N)^{d−1} / N,                   (4.2)\nwhere c_d is a positive constant which does not depend on N.\nThe Koksma–Hlawka inequality is:\n    | ∫_{[0,1]^d} f(x) dx − (1/N) Σ_{k=1}^N f(x_k) | ≤ V(f) D^*(x₁,...,x_N).   (4.3)\na) Explain what the star discrepancy D^*(x₁,...,x_N) is.\nb) Outline the key steps in a Monte-Carlo method to estimate (4.1).\nc) Compare the integration errors when using a Monte-Carlo method with using a “low-discrepancy” point set.\nd) Consider a problem with d = 20 and N = 10²⁰.\nA) Evaluate (log N)^{d−1} and N^{1/2}.\nB) What are the implications for using a “low-discrepancy” point set satisfying (4.2)?\ne) Outline the key ideas in using a function g which approximates f² in a variance reduction technique to estimate Var[f].\niii) In the CEV model a process S_t follows the SDE\n    dS_t / S_t = μ dt + σ S_t^{γ−1} dW_t,       t ∈ (0, T],      (4.4)\nwhere W_t is a Wiener process, μ, σ, γ are positive constants, and S₀ is given.\na) Derive an expression for S_{t+dt} from (4.4).\nb) What are the key properties of a Wiener process W_t?\nc) Let the time interval [0, T] be discretized by:\n    t_i = iΔt,    i = 0,...,m,     Δt = T / m.\nWrite down the formula for a discrete approximation Ŝ_i ≈ S_{t_i},  i = 1,...,m of the CEV process (4.12).",
    "steps": [
      {
        "step": 1,
        "desc": "Identify the variance expression to be estimated",
        "expr": "Var[f] = E[(f - μ)^2]",
        "value": null
      },
      {
        "step": 2,
        "desc": "Recognize that direct estimation of Var[f] can be inefficient",
        "expr": null,
        "value": null
      },
      {
        "step": 3,
        "desc": "Introduce a function g that approximates f^2",
        "expr": "g(x) ≈ f(x)^2",
        "value": null
      },
      {
        "step": 4,
        "desc": "Decompose the variance expression using g",
        "expr": "Var[f] = E[f^2] - μ^2",
        "value": null
      },
      {
        "step": 5,
        "desc": "Use g to approximate E[f^2]",
        "expr": "E[f^2] ≈ E[g]",
        "value": null
      },
      {
        "step": 6,
        "desc": "Estimate E[g] using a numerical method",
        "expr": "E[g] ≈ (1/N) Σ_{k=1}^N g(x_k)",
        "value": null
      },
      {
        "step": 7,
        "desc": "Compute the variance using the approximation",
        "expr": "Var[f] ≈ E[g] - μ^2",
        "value": null
      },
      {
        "step": "final",
        "desc": "Conclude with the variance estimate using variance reduction",
        "expr": null,
        "value": "Var[f] ≈ (1/N) Σ_{k=1}^N g(x_k) - μ^2"
      }
    ]
  },
  {
    "qid": "Problemsix",
    "subid": "6iiia",
    "subquestion": "Derive an expression for S_{t+dt} from (4.4).",
    "full_question": "i)Consider the expected value\n    E[h] = ∫₀^∞ h(x)p(x) dx,\nwhere p: ℝ → ℝ is a probability density function (pdf) with p(x) = 0 for all x < 0 and p(x) > 0 for all x > 0.\na) Define the corresponding cumulative distribution function (cdf) P.\nb) What properties does P possess?\nc) Use the cdf P to transform the expected value E[h] into an integral over [0, 1].\nii) Consider estimating the d-dimensional variance\n    Var[f] = E[(f − μ)²] = ∫_{[0,1]^d} (f(x) − μ)² p(x) dx,        (4.1)\nwhere p : [0,1]^d → ℝ is a probability density function (pdf) and μ = E[f] is known.\nA 'low-discrepancy' point set {x₁, ..., x_N} has\n    D^*(x₁,...,x_N) ≤ c_d * (log N)^{d−1} / N,                   (4.2)\nwhere c_d is a positive constant which does not depend on N.\nThe Koksma–Hlawka inequality is:\n    | ∫_{[0,1]^d} f(x) dx − (1/N) Σ_{k=1}^N f(x_k) | ≤ V(f) D^*(x₁,...,x_N).   (4.3)\na) Explain what the star discrepancy D^*(x₁,...,x_N) is.\nb) Outline the key steps in a Monte-Carlo method to estimate (4.1).\nc) Compare the integration errors when using a Monte-Carlo method with using a “low-discrepancy” point set.\nd) Consider a problem with d = 20 and N = 10²⁰.\nA) Evaluate (log N)^{d−1} and N^{1/2}.\nB) What are the implications for using a “low-discrepancy” point set satisfying (4.2)?\ne) Outline the key ideas in using a function g which approximates f² in a variance reduction technique to estimate Var[f].\niii) In the CEV model a process S_t follows the SDE\n    dS_t / S_t = μ dt + σ S_t^{γ−1} dW_t,       t ∈ (0, T],      (4.4)\nwhere W_t is a Wiener process, μ, σ, γ are positive constants, and S₀ is given.\na) Derive an expression for S_{t+dt} from (4.4).\nb) What are the key properties of a Wiener process W_t?\nc) Let the time interval [0, T] be discretized by:\n    t_i = iΔt,    i = 0,...,m,     Δt = T / m.\nWrite down the formula for a discrete approximation Ŝ_i ≈ S_{t_i},  i = 1,...,m of the CEV process (4.13).",
    "steps": [
      {
        "step": 1,
        "desc": "Start with the given stochastic differential equation (SDE) for the CEV model.",
        "expr": "dS_t / S_t = μ dt + σ S_t^{γ−1} dW_t",
        "value": null
      },
      {
        "step": 2,
        "desc": "Rearrange the SDE to express dS_t.",
        "expr": "dS_t = S_t (μ dt + σ S_t^{γ−1} dW_t)",
        "value": null
      },
      {
        "step": 3,
        "desc": "Integrate both sides from t to t+dt to find S_{t+dt}.",
        "expr": "S_{t+dt} = S_t + ∫_t^{t+dt} S_u μ du + ∫_t^{t+dt} σ S_u^γ dW_u",
        "value": null
      },
      {
        "step": 4,
        "desc": "Approximate the integrals over the small interval [t, t+dt].",
        "expr": "S_{t+dt} ≈ S_t + S_t μ dt + σ S_t^γ (W_{t+dt} - W_t)",
        "value": null
      },
      {
        "step": "final",
        "desc": "Combine terms to express S_{t+dt} in terms of S_t, μ, σ, γ, dt, and dW_t.",
        "expr": "S_{t+dt} = S_t (1 + μ dt + σ S_t^{γ-1} dW_t)",
        "value": null
      }
    ]
  },
  {
    "qid": "Problemsix",
    "subid": "6iiib",
    "subquestion": "What are the key properties of a Wiener process W_t?",
    "full_question": "i)Consider the expected value\n    E[h] = ∫₀^∞ h(x)p(x) dx,\nwhere p: ℝ → ℝ is a probability density function (pdf) with p(x) = 0 for all x < 0 and p(x) > 0 for all x > 0.\na) Define the corresponding cumulative distribution function (cdf) P.\nb) What properties does P possess?\nc) Use the cdf P to transform the expected value E[h] into an integral over [0, 1].\nii) Consider estimating the d-dimensional variance\n    Var[f] = E[(f − μ)²] = ∫_{[0,1]^d} (f(x) − μ)² p(x) dx,        (4.1)\nwhere p : [0,1]^d → ℝ is a probability density function (pdf) and μ = E[f] is known.\nA 'low-discrepancy' point set {x₁, ..., x_N} has\n    D^*(x₁,...,x_N) ≤ c_d * (log N)^{d−1} / N,                   (4.2)\nwhere c_d is a positive constant which does not depend on N.\nThe Koksma–Hlawka inequality is:\n    | ∫_{[0,1]^d} f(x) dx − (1/N) Σ_{k=1}^N f(x_k) | ≤ V(f) D^*(x₁,...,x_N).   (4.3)\na) Explain what the star discrepancy D^*(x₁,...,x_N) is.\nb) Outline the key steps in a Monte-Carlo method to estimate (4.1).\nc) Compare the integration errors when using a Monte-Carlo method with using a “low-discrepancy” point set.\nd) Consider a problem with d = 20 and N = 10²⁰.\nA) Evaluate (log N)^{d−1} and N^{1/2}.\nB) What are the implications for using a “low-discrepancy” point set satisfying (4.2)?\ne) Outline the key ideas in using a function g which approximates f² in a variance reduction technique to estimate Var[f].\niii) In the CEV model a process S_t follows the SDE\n    dS_t / S_t = μ dt + σ S_t^{γ−1} dW_t,       t ∈ (0, T],      (4.4)\nwhere W_t is a Wiener process, μ, σ, γ are positive constants, and S₀ is given.\na) Derive an expression for S_{t+dt} from (4.4).\nb) What are the key properties of a Wiener process W_t?\nc) Let the time interval [0, T] be discretized by:\n    t_i = iΔt,    i = 0,...,m,     Δt = T / m.\nWrite down the formula for a discrete approximation Ŝ_i ≈ S_{t_i},  i = 1,...,m of the CEV process (4.14).",
    "steps": [
      {
        "step": 1,
        "desc": "Define the starting point of a Wiener process",
        "expr": "W_0 = 0",
        "value": "W_0 = 0"
      },
      {
        "step": 2,
        "desc": "State the independent increments property",
        "expr": "W_{t+s} - W_t",
        "value": "Independent of W_u for u <= t"
      },
      {
        "step": 3,
        "desc": "State the normal distribution of increments",
        "expr": "W_{t+s} - W_t ~ N(0, s)",
        "value": "Normal distribution with mean 0 and variance s"
      },
      {
        "step": 4,
        "desc": "State the continuity property",
        "expr": "W_t",
        "value": "Continuous function of t"
      },
      {
        "step": "final",
        "desc": "Summarize the key properties of a Wiener process",
        "expr": null,
        "value": "W_0 = 0, independent increments, normally distributed increments, continuous paths"
      }
    ]
  },
  {
    "qid": "Problemsix",
    "subid": "6iiic",
    "subquestion": "Let the time interval [0, T] be discretized by:\n    t_i = iΔt,    i = 0,...,m,     Δt = T / m.\nWrite down the formula for a discrete approximation Ŝ_i ≈ S_{t_i},  i = 1,...,m of the CEV process (4.4).",
    "full_question": "i)Consider the expected value\n    E[h] = ∫₀^∞ h(x)p(x) dx,\nwhere p: ℝ → ℝ is a probability density function (pdf) with p(x) = 0 for all x < 0 and p(x) > 0 for all x > 0.\na) Define the corresponding cumulative distribution function (cdf) P.\nb) What properties does P possess?\nc) Use the cdf P to transform the expected value E[h] into an integral over [0, 1].\nii) Consider estimating the d-dimensional variance\n    Var[f] = E[(f − μ)²] = ∫_{[0,1]^d} (f(x) − μ)² p(x) dx,        (4.1)\nwhere p : [0,1]^d → ℝ is a probability density function (pdf) and μ = E[f] is known.\nA 'low-discrepancy' point set {x₁, ..., x_N} has\n    D^*(x₁,...,x_N) ≤ c_d * (log N)^{d−1} / N,                   (4.2)\nwhere c_d is a positive constant which does not depend on N.\nThe Koksma–Hlawka inequality is:\n    | ∫_{[0,1]^d} f(x) dx − (1/N) Σ_{k=1}^N f(x_k) | ≤ V(f) D^*(x₁,...,x_N).   (4.3)\na) Explain what the star discrepancy D^*(x₁,...,x_N) is.\nb) Outline the key steps in a Monte-Carlo method to estimate (4.1).\nc) Compare the integration errors when using a Monte-Carlo method with using a “low-discrepancy” point set.\nd) Consider a problem with d = 20 and N = 10²⁰.\nA) Evaluate (log N)^{d−1} and N^{1/2}.\nB) What are the implications for using a “low-discrepancy” point set satisfying (4.2)?\ne) Outline the key ideas in using a function g which approximates f² in a variance reduction technique to estimate Var[f].\niii) In the CEV model a process S_t follows the SDE\n    dS_t / S_t = μ dt + σ S_t^{γ−1} dW_t,       t ∈ (0, T],      (4.4)\nwhere W_t is a Wiener process, μ, σ, γ are positive constants, and S₀ is given.\na) Derive an expression for S_{t+dt} from (4.4).\nb) What are the key properties of a Wiener process W_t?\nc) Let the time interval [0, T] be discretized by:\n    t_i = iΔt,    i = 0,...,m,     Δt = T / m.\nWrite down the formula for a discrete approximation Ŝ_i ≈ S_{t_i},  i = 1,...,m of the CEV process (4.15).",
    "steps": [
      {
        "step": 1,
        "desc": "Start with the SDE for the CEV model",
        "expr": "dS_t / S_t = μ dt + σ S_t^{γ−1} dW_t",
        "value": null
      },
      {
        "step": 2,
        "desc": "Discretize the time interval [0, T] with t_i = iΔt, Δt = T/m",
        "expr": "t_i = iΔt, Δt = T/m",
        "value": null
      },
      {
        "step": 3,
        "desc": "Approximate the SDE using Euler-Maruyama method",
        "expr": "S_{t+dt} ≈ S_t + S_t(μ dt + σ S_t^{γ−1} dW_t)",
        "value": null
      },
      {
        "step": 4,
        "desc": "Express the discrete approximation for S_{t_i}",
        "expr": "Ŝ_{i+1} = Ŝ_i + Ŝ_i(μ Δt + σ Ŝ_i^{γ−1} ΔW_i)",
        "value": null
      },
      {
        "step": 5,
        "desc": "Define the Wiener increment ΔW_i",
        "expr": "ΔW_i = W_{t_{i+1}} - W_{t_i} ~ N(0, Δt)",
        "value": null
      },
      {
        "step": "final",
        "desc": "Final discrete approximation formula for the CEV process",
        "expr": "Ŝ_{i+1} = Ŝ_i(1 + μ Δt) + σ Ŝ_i^γ ΔW_i",
        "value": null
      }
    ]
  },
  {
    "qid": "Problemone",
    "subid": "1ia",
    "subquestion": "Explain why the polynomial approximation does not agree with the interest rate data, for example at t₆ = 2.5, t₇ = 3 or t₈ = 3.5 years.",
    "full_question": "A deterministic interest rate model r(t) at time t ∈ [0, T] interpolates the m = 9 data values in Table 1. The data is stored in MATLAB in column vectors td and rd.\nTable: i = [1 2 3 4 5 6 7 8 9]\n       t_i (years) = [0.0 0.5 1.0 1.5 2.0 2.5 3.0 3.5 4.0]\n       r(t_i) (%)  = [3.5 3.25 4.1 4.5 4.2 3.3 3.2 3.05 4.12]\ni) An analyst decides to try to fit a polynomial of degree n = 5 with coefficients in the vector a to the interest rate data. They define the Vandermonde matrix A_ij = t_i^{j−1} for i = 1,...,m, j = 1,...,n + 1.\nSome of the MATLAB commands they use are:\n    a = A \\ rd;\n    sv = svd(A);\n    svmax = sv(1)     → 1.2235e+03\n    svmin = sv(end)   → 6.4320e−02\nThey then plot the data and the polynomial as in Figure 1.\na)Explain why the polynomial approximation does not agree with the interest rate data, for example at t₆ = 2.5, t₇ = 3 or t₈ = 3.5 years.\nb) What is the rank of the matrix A? Give reasons for your answer\nc)Estimate the condition number κ₂(A) of A.\nd)Estimate the relative change in the polynomial coefficients a if there is a one basis point (0.01 of a percent) decrease in the interest rate at some time t_i. What confidence do you have in the values of a?\nii) The analyst then decides to interpolate the data with cubic splines using\ntp = linspace(0, 4.5, 5001);\nrsp1 = spline(td, rd, tp);\nrsp2 = spline(td, [0 rd 0], tp);\nand adds these two splines to the plot in Figure 1.\na) Explain what a “cubic spline interpolant” is.\nb) Why do the two cubic spline interpolants predict very different esti\u0002mates for the interest rate at t = 4.5 years?\niii) Suppose that m ≥ n and that the rectangular matrix A ∈ ℝ^{m×n} has the singular value decomposition\n    A = U [Σ; 0] Vᵀ = Y Σ Vᵀ = Σ_{j=1}^n σ_j u_j v_jᵀ,\nwhere:\n    U = [Y Z] ∈ ℝ^{m×m},\n    Y = [u₁ u₂ ⋯ uₙ] ∈ ℝ^{m×n},\n    Z = [u_{n+1} ⋯ u_m] ∈ ℝ^{m×(m−n)},\n    Σ = diag(σ₁, σ₂, ..., σₙ) ∈ ℝ^{n×n},\n    V = [v₁ v₂ ⋯ vₙ] ∈ ℝ^{n×n},\nwith σ₁ ≥ σ₂ ≥ ⋯ ≥ σₙ ≥ 0.\niv) State the definition of an orthogonal matrix Q ∈ ℝ^{n×n}.\nv) Show that if Q is orthogonal then ∥Qx∥₂ = ∥x∥₂ for all x ∈ ℝⁿ. Hint: (∥x∥₂)² = xᵀx.\nvi) For b ∈ ℝᵐ and y = Vᵀx, show that ∥Ax − b∥₂ is minimized when ∥Σy − Yᵀb∥₂ is minimized.",
    "steps": [
      {
        "step": 1,
        "desc": "Identify the degree of the polynomial used for approximation",
        "expr": "n = 5",
        "value": 5
      },
      {
        "step": 2,
        "desc": "Determine the number of data points",
        "expr": "m = 9",
        "value": 9
      },
      {
        "step": 3,
        "desc": "Calculate the number of coefficients in the polynomial",
        "expr": "n + 1",
        "value": 6
      },
      {
        "step": 4,
        "desc": "Check if the polynomial degree is appropriate for the number of data points",
        "expr": "n + 1 < m",
        "value": true
      },
      {
        "step": 5,
        "desc": "Identify the potential issue with polynomial fitting",
        "expr": "Overfitting or underfitting",
        "value": "Underfitting"
      },
      {
        "step": 6,
        "desc": "Consider the condition number of the Vandermonde matrix",
        "expr": "κ₂(A) = svmax / svmin",
        "value": "1.2235e+03 / 6.4320e−02"
      },
      {
        "step": 7,
        "desc": "Compute the condition number",
        "expr": "κ₂(A)",
        "value": 19019.6
      },
      {
        "step": 8,
        "desc": "Assess the impact of a high condition number",
        "expr": "Sensitivity to data perturbations",
        "value": "High"
      },
      {
        "step": 9,
        "desc": "Conclude why the polynomial does not fit well at specific points",
        "expr": "High condition number and underfitting",
        "value": "Poor approximation"
      }
    ]
  },
  {
    "qid": "Problemone",
    "subid": "1ib",
    "subquestion": "What is the rank of the matrix A? Give reasons for your answer",
    "full_question": "A deterministic interest rate model r(t) at time t ∈ [0, T] interpolates the m = 9 data values in Table 1. The data is stored in MATLAB in column vectors td and rd.\nTable: i = [1 2 3 4 5 6 7 8 9]\n       t_i (years) = [0.0 0.5 1.0 1.5 2.0 2.5 3.0 3.5 4.0]\n       r(t_i) (%)  = [3.5 3.25 4.1 4.5 4.2 3.3 3.2 3.05 4.12]\ni) An analyst decides to try to fit a polynomial of degree n = 5 with coefficients in the vector a to the interest rate data. They define the Vandermonde matrix A_ij = t_i^{j−1} for i = 1,...,m, j = 1,...,n + 1.\nSome of the MATLAB commands they use are:\n    a = A \\ rd;\n    sv = svd(A);\n    svmax = sv(1)     → 1.2235e+03\n    svmin = sv(end)   → 6.4320e−02\nThey then plot the data and the polynomial as in Figure 1.\na)Explain why the polynomial approximation does not agree with the interest rate data, for example at t₆ = 2.5, t₇ = 3 or t₈ = 3.5 years.\nb) What is the rank of the matrix A? Give reasons for your answer\nc)Estimate the condition number κ₂(A) of A.\nd)Estimate the relative change in the polynomial coefficients a if there is a one basis point (0.01 of a percent) decrease in the interest rate at some time t_i. What confidence do you have in the values of a?\nii) The analyst then decides to interpolate the data with cubic splines using\ntp = linspace(0, 4.5, 5001);\nrsp1 = spline(td, rd, tp);\nrsp2 = spline(td, [0 rd 0], tp);\nand adds these two splines to the plot in Figure 1.\na) Explain what a “cubic spline interpolant” is.\nb) Why do the two cubic spline interpolants predict very different esti\u0002mates for the interest rate at t = 4.5 years?\niii) Suppose that m ≥ n and that the rectangular matrix A ∈ ℝ^{m×n} has the singular value decomposition\n    A = U [Σ; 0] Vᵀ = Y Σ Vᵀ = Σ_{j=1}^n σ_j u_j v_jᵀ,\nwhere:\n    U = [Y Z] ∈ ℝ^{m×m},\n    Y = [u₁ u₂ ⋯ uₙ] ∈ ℝ^{m×n},\n    Z = [u_{n+1} ⋯ u_m] ∈ ℝ^{m×(m−n)},\n    Σ = diag(σ₁, σ₂, ..., σₙ) ∈ ℝ^{n×n},\n    V = [v₁ v₂ ⋯ vₙ] ∈ ℝ^{n×n},\nwith σ₁ ≥ σ₂ ≥ ⋯ ≥ σₙ ≥ 1.\niv) State the definition of an orthogonal matrix Q ∈ ℝ^{n×n}.\nv) Show that if Q is orthogonal then ∥Qx∥₂ = ∥x∥₂ for all x ∈ ℝⁿ. Hint: (∥x∥₂)² = xᵀx.\nvi) For b ∈ ℝᵐ and y = Vᵀx, show that ∥Ax − b∥₂ is minimized when ∥Σy − Yᵀb∥₂ is minimized.",
    "steps": [
      {
        "step": 1,
        "desc": "Identify the dimensions of the Vandermonde matrix A",
        "expr": "A ∈ ℝ^{m×(n+1)}",
        "value": "A ∈ ℝ^{9×6}"
      },
      {
        "step": 2,
        "desc": "Determine the number of singular values of A",
        "expr": "number of singular values = min(m, n+1)",
        "value": 6
      },
      {
        "step": 3,
        "desc": "Check the non-zero singular values from the given svd results",
        "expr": "sv = [1.2235e+03, ..., 6.4320e−02]",
        "value": "All 6 singular values are non-zero"
      },
      {
        "step": "final",
        "desc": "Conclude the rank of the matrix A based on non-zero singular values",
        "expr": "rank(A) = number of non-zero singular values",
        "value": 6
      }
    ]
  },
  {
    "qid": "Problemone",
    "subid": "1ic",
    "subquestion": "Estimate the condition number κ₂(A) of A.",
    "full_question": "A deterministic interest rate model r(t) at time t ∈ [0, T] interpolates the m = 9 data values in Table 1. The data is stored in MATLAB in column vectors td and rd.\nTable: i = [1 2 3 4 5 6 7 8 9]\n       t_i (years) = [0.0 0.5 1.0 1.5 2.0 2.5 3.0 3.5 4.0]\n       r(t_i) (%)  = [3.5 3.25 4.1 4.5 4.2 3.3 3.2 3.05 4.12]\ni) An analyst decides to try to fit a polynomial of degree n = 5 with coefficients in the vector a to the interest rate data. They define the Vandermonde matrix A_ij = t_i^{j−1} for i = 1,...,m, j = 1,...,n + 1.\nSome of the MATLAB commands they use are:\n    a = A \\ rd;\n    sv = svd(A);\n    svmax = sv(1)     → 1.2235e+03\n    svmin = sv(end)   → 6.4320e−02\nThey then plot the data and the polynomial as in Figure 1.\na)Explain why the polynomial approximation does not agree with the interest rate data, for example at t₆ = 2.5, t₇ = 3 or t₈ = 3.5 years.\nb) What is the rank of the matrix A? Give reasons for your answer\nc)Estimate the condition number κ₂(A) of A.\nd)Estimate the relative change in the polynomial coefficients a if there is a one basis point (0.01 of a percent) decrease in the interest rate at some time t_i. What confidence do you have in the values of a?\nii) The analyst then decides to interpolate the data with cubic splines using\ntp = linspace(0, 4.5, 5001);\nrsp1 = spline(td, rd, tp);\nrsp2 = spline(td, [0 rd 0], tp);\nand adds these two splines to the plot in Figure 1.\na) Explain what a “cubic spline interpolant” is.\nb) Why do the two cubic spline interpolants predict very different esti\u0002mates for the interest rate at t = 4.5 years?\niii) Suppose that m ≥ n and that the rectangular matrix A ∈ ℝ^{m×n} has the singular value decomposition\n    A = U [Σ; 0] Vᵀ = Y Σ Vᵀ = Σ_{j=1}^n σ_j u_j v_jᵀ,\nwhere:\n    U = [Y Z] ∈ ℝ^{m×m},\n    Y = [u₁ u₂ ⋯ uₙ] ∈ ℝ^{m×n},\n    Z = [u_{n+1} ⋯ u_m] ∈ ℝ^{m×(m−n)},\n    Σ = diag(σ₁, σ₂, ..., σₙ) ∈ ℝ^{n×n},\n    V = [v₁ v₂ ⋯ vₙ] ∈ ℝ^{n×n},\nwith σ₁ ≥ σ₂ ≥ ⋯ ≥ σₙ ≥ 2.\niv) State the definition of an orthogonal matrix Q ∈ ℝ^{n×n}.\nv) Show that if Q is orthogonal then ∥Qx∥₂ = ∥x∥₂ for all x ∈ ℝⁿ. Hint: (∥x∥₂)² = xᵀx.\nvi) For b ∈ ℝᵐ and y = Vᵀx, show that ∥Ax − b∥₂ is minimized when ∥Σy − Yᵀb∥₂ is minimized.",
    "steps": [
      {
        "step": 1,
        "desc": "Identify the formula for the condition number κ₂(A) using singular values.",
        "expr": "κ₂(A) = σ_max / σ_min",
        "value": null
      },
      {
        "step": 2,
        "desc": "Retrieve the maximum singular value σ_max from the given data.",
        "expr": "σ_max = svmax",
        "value": "1.2235e+03"
      },
      {
        "step": 3,
        "desc": "Retrieve the minimum singular value σ_min from the given data.",
        "expr": "σ_min = svmin",
        "value": "6.4320e−02"
      },
      {
        "step": 4,
        "desc": "Calculate the condition number κ₂(A) using the formula and the singular values.",
        "expr": "κ₂(A) = σ_max / σ_min",
        "value": "1.2235e+03 / 6.4320e−02"
      },
      {
        "step": "final",
        "desc": "Compute the final value of the condition number κ₂(A).",
        "expr": "κ₂(A)",
        "value": "1.9021e+04"
      }
    ]
  },
  {
    "qid": "Problemone",
    "subid": "1id",
    "subquestion": "Estimate the relative change in the polynomial coefficients a if there is a one basis point (0.01 of a percent) decrease in the interest rate at some time t_i. What confidence do you have in the values of a?",
    "full_question": "A deterministic interest rate model r(t) at time t ∈ [0, T] interpolates the m = 9 data values in Table 1. The data is stored in MATLAB in column vectors td and rd.\nTable: i = [1 2 3 4 5 6 7 8 9]\n       t_i (years) = [0.0 0.5 1.0 1.5 2.0 2.5 3.0 3.5 4.0]\n       r(t_i) (%)  = [3.5 3.25 4.1 4.5 4.2 3.3 3.2 3.05 4.12]\ni) An analyst decides to try to fit a polynomial of degree n = 5 with coefficients in the vector a to the interest rate data. They define the Vandermonde matrix A_ij = t_i^{j−1} for i = 1,...,m, j = 1,...,n + 1.\nSome of the MATLAB commands they use are:\n    a = A \\ rd;\n    sv = svd(A);\n    svmax = sv(1)     → 1.2235e+03\n    svmin = sv(end)   → 6.4320e−02\nThey then plot the data and the polynomial as in Figure 1.\na)Explain why the polynomial approximation does not agree with the interest rate data, for example at t₆ = 2.5, t₇ = 3 or t₈ = 3.5 years.\nb) What is the rank of the matrix A? Give reasons for your answer\nc)Estimate the condition number κ₂(A) of A.\nd)Estimate the relative change in the polynomial coefficients a if there is a one basis point (0.01 of a percent) decrease in the interest rate at some time t_i. What confidence do you have in the values of a?\nii) The analyst then decides to interpolate the data with cubic splines using\ntp = linspace(0, 4.5, 5001);\nrsp1 = spline(td, rd, tp);\nrsp2 = spline(td, [0 rd 0], tp);\nand adds these two splines to the plot in Figure 1.\na) Explain what a “cubic spline interpolant” is.\nb) Why do the two cubic spline interpolants predict very different esti\u0002mates for the interest rate at t = 4.5 years?\niii) Suppose that m ≥ n and that the rectangular matrix A ∈ ℝ^{m×n} has the singular value decomposition\n    A = U [Σ; 0] Vᵀ = Y Σ Vᵀ = Σ_{j=1}^n σ_j u_j v_jᵀ,\nwhere:\n    U = [Y Z] ∈ ℝ^{m×m},\n    Y = [u₁ u₂ ⋯ uₙ] ∈ ℝ^{m×n},\n    Z = [u_{n+1} ⋯ u_m] ∈ ℝ^{m×(m−n)},\n    Σ = diag(σ₁, σ₂, ..., σₙ) ∈ ℝ^{n×n},\n    V = [v₁ v₂ ⋯ vₙ] ∈ ℝ^{n×n},\nwith σ₁ ≥ σ₂ ≥ ⋯ ≥ σₙ ≥ 3.\niv) State the definition of an orthogonal matrix Q ∈ ℝ^{n×n}.\nv) Show that if Q is orthogonal then ∥Qx∥₂ = ∥x∥₂ for all x ∈ ℝⁿ. Hint: (∥x∥₂)² = xᵀx.\nvi) For b ∈ ℝᵐ and y = Vᵀx, show that ∥Ax − b∥₂ is minimized when ∥Σy − Yᵀb∥₂ is minimized.",
    "steps": [
      {
        "step": 1,
        "desc": "Calculate the condition number kappa_2(A) using the singular values.",
        "expr": "kappa_2(A) = svmax / svmin",
        "value": 19017.8
      },
      {
        "step": 2,
        "desc": "Estimate the relative change in the coefficients a due to a small change in rd.",
        "expr": "relative_change_a = kappa_2(A) * relative_change_rd",
        "value": "0.01 * 19017.8"
      },
      {
        "step": 3,
        "desc": "Compute the relative change in rd due to a one basis point decrease.",
        "expr": "relative_change_rd = 0.01 / rd_i",
        "value": "0.01 / 3.3"
      },
      {
        "step": 4,
        "desc": "Calculate the relative change in a using the condition number and relative change in rd.",
        "expr": "relative_change_a = 19017.8 * (0.01 / 3.3)",
        "value": 57.628
      },
      {
        "step": "final",
        "desc": "Conclude the confidence in the values of a based on the relative change.",
        "expr": "Confidence in a is low due to high sensitivity.",
        "value": "Low"
      }
    ]
  },
  {
    "qid": "Problemone",
    "subid": "1iia",
    "subquestion": "Explain what a “cubic spline interpolant” is.",
    "full_question": "A deterministic interest rate model r(t) at time t ∈ [0, T] interpolates the m = 9 data values in Table 1. The data is stored in MATLAB in column vectors td and rd.\nTable: i = [1 2 3 4 5 6 7 8 9]\n       t_i (years) = [0.0 0.5 1.0 1.5 2.0 2.5 3.0 3.5 4.0]\n       r(t_i) (%)  = [3.5 3.25 4.1 4.5 4.2 3.3 3.2 3.05 4.12]\ni) An analyst decides to try to fit a polynomial of degree n = 5 with coefficients in the vector a to the interest rate data. They define the Vandermonde matrix A_ij = t_i^{j−1} for i = 1,...,m, j = 1,...,n + 1.\nSome of the MATLAB commands they use are:\n    a = A \\ rd;\n    sv = svd(A);\n    svmax = sv(1)     → 1.2235e+03\n    svmin = sv(end)   → 6.4320e−02\nThey then plot the data and the polynomial as in Figure 1.\na)Explain why the polynomial approximation does not agree with the interest rate data, for example at t₆ = 2.5, t₇ = 3 or t₈ = 3.5 years.\nb) What is the rank of the matrix A? Give reasons for your answer\nc)Estimate the condition number κ₂(A) of A.\nd)Estimate the relative change in the polynomial coefficients a if there is a one basis point (0.01 of a percent) decrease in the interest rate at some time t_i. What confidence do you have in the values of a?\nii) The analyst then decides to interpolate the data with cubic splines using\ntp = linspace(0, 4.5, 5001);\nrsp1 = spline(td, rd, tp);\nrsp2 = spline(td, [0 rd 0], tp);\nand adds these two splines to the plot in Figure 1.\na) Explain what a “cubic spline interpolant” is.\nb) Why do the two cubic spline interpolants predict very different esti\u0002mates for the interest rate at t = 4.5 years?\niii) Suppose that m ≥ n and that the rectangular matrix A ∈ ℝ^{m×n} has the singular value decomposition\n    A = U [Σ; 0] Vᵀ = Y Σ Vᵀ = Σ_{j=1}^n σ_j u_j v_jᵀ,\nwhere:\n    U = [Y Z] ∈ ℝ^{m×m},\n    Y = [u₁ u₂ ⋯ uₙ] ∈ ℝ^{m×n},\n    Z = [u_{n+1} ⋯ u_m] ∈ ℝ^{m×(m−n)},\n    Σ = diag(σ₁, σ₂, ..., σₙ) ∈ ℝ^{n×n},\n    V = [v₁ v₂ ⋯ vₙ] ∈ ℝ^{n×n},\nwith σ₁ ≥ σ₂ ≥ ⋯ ≥ σₙ ≥ 4.\niv) State the definition of an orthogonal matrix Q ∈ ℝ^{n×n}.\nv) Show that if Q is orthogonal then ∥Qx∥₂ = ∥x∥₂ for all x ∈ ℝⁿ. Hint: (∥x∥₂)² = xᵀx.\nvi) For b ∈ ℝᵐ and y = Vᵀx, show that ∥Ax − b∥₂ is minimized when ∥Σy − Yᵀb∥₂ is minimized.",
    "steps": [
      {
        "step": 1,
        "desc": "Define a cubic spline interpolant",
        "expr": "S(x)",
        "value": "A piecewise-defined function"
      },
      {
        "step": 2,
        "desc": "Specify the intervals for the spline",
        "expr": "[t_i, t_{i+1}]",
        "value": "Intervals between data points"
      },
      {
        "step": 3,
        "desc": "Define the cubic polynomial for each interval",
        "expr": "S_i(x) = a_i + b_i(x - t_i) + c_i(x - t_i)^2 + d_i(x - t_i)^3",
        "value": "Cubic polynomial for each interval"
      },
      {
        "step": 4,
        "desc": "Ensure continuity at each data point",
        "expr": "S_i(t_{i+1}) = S_{i+1}(t_{i+1})",
        "value": "Continuity condition"
      },
      {
        "step": 5,
        "desc": "Ensure smoothness at each data point",
        "expr": "S_i'(t_{i+1}) = S_{i+1}'(t_{i+1})",
        "value": "First derivative continuity"
      },
      {
        "step": 6,
        "desc": "Ensure curvature continuity at each data point",
        "expr": "S_i''(t_{i+1}) = S_{i+1}''(t_{i+1})",
        "value": "Second derivative continuity"
      },
      {
        "step": 7,
        "desc": "Specify boundary conditions",
        "expr": "S''(t_1) = 0, S''(t_m) = 0",
        "value": "Natural spline boundary conditions"
      },
      {
        "step": "final",
        "desc": "Summarize the cubic spline interpolant",
        "expr": "S(x)",
        "value": "A smooth, piecewise cubic polynomial function that interpolates the data"
      }
    ]
  },
  {
    "qid": "Problemone",
    "subid": "1iib",
    "subquestion": "Why do the two cubic spline interpolants predict very different esti\u0002mates for the interest rate at t = 4.5 years?",
    "full_question": "A deterministic interest rate model r(t) at time t ∈ [0, T] interpolates the m = 9 data values in Table 1. The data is stored in MATLAB in column vectors td and rd.\nTable: i = [1 2 3 4 5 6 7 8 9]\n       t_i (years) = [0.0 0.5 1.0 1.5 2.0 2.5 3.0 3.5 4.0]\n       r(t_i) (%)  = [3.5 3.25 4.1 4.5 4.2 3.3 3.2 3.05 4.12]\ni) An analyst decides to try to fit a polynomial of degree n = 5 with coefficients in the vector a to the interest rate data. They define the Vandermonde matrix A_ij = t_i^{j−1} for i = 1,...,m, j = 1,...,n + 1.\nSome of the MATLAB commands they use are:\n    a = A \\ rd;\n    sv = svd(A);\n    svmax = sv(1)     → 1.2235e+03\n    svmin = sv(end)   → 6.4320e−02\nThey then plot the data and the polynomial as in Figure 1.\na)Explain why the polynomial approximation does not agree with the interest rate data, for example at t₆ = 2.5, t₇ = 3 or t₈ = 3.5 years.\nb) What is the rank of the matrix A? Give reasons for your answer\nc)Estimate the condition number κ₂(A) of A.\nd)Estimate the relative change in the polynomial coefficients a if there is a one basis point (0.01 of a percent) decrease in the interest rate at some time t_i. What confidence do you have in the values of a?\nii) The analyst then decides to interpolate the data with cubic splines using\ntp = linspace(0, 4.5, 5001);\nrsp1 = spline(td, rd, tp);\nrsp2 = spline(td, [0 rd 0], tp);\nand adds these two splines to the plot in Figure 1.\na) Explain what a “cubic spline interpolant” is.\nb) Why do the two cubic spline interpolants predict very different esti\u0002mates for the interest rate at t = 4.5 years?\niii) Suppose that m ≥ n and that the rectangular matrix A ∈ ℝ^{m×n} has the singular value decomposition\n    A = U [Σ; 0] Vᵀ = Y Σ Vᵀ = Σ_{j=1}^n σ_j u_j v_jᵀ,\nwhere:\n    U = [Y Z] ∈ ℝ^{m×m},\n    Y = [u₁ u₂ ⋯ uₙ] ∈ ℝ^{m×n},\n    Z = [u_{n+1} ⋯ u_m] ∈ ℝ^{m×(m−n)},\n    Σ = diag(σ₁, σ₂, ..., σₙ) ∈ ℝ^{n×n},\n    V = [v₁ v₂ ⋯ vₙ] ∈ ℝ^{n×n},\nwith σ₁ ≥ σ₂ ≥ ⋯ ≥ σₙ ≥ 5.\niv) State the definition of an orthogonal matrix Q ∈ ℝ^{n×n}.\nv) Show that if Q is orthogonal then ∥Qx∥₂ = ∥x∥₂ for all x ∈ ℝⁿ. Hint: (∥x∥₂)² = xᵀx.\nvi) For b ∈ ℝᵐ and y = Vᵀx, show that ∥Ax − b∥₂ is minimized when ∥Σy − Yᵀb∥₂ is minimized.",
    "steps": [
      {
        "step": 1,
        "desc": "Identify the boundary conditions for the first spline",
        "expr": "spline(td, rd, tp)",
        "value": "Natural spline with zero second derivatives at endpoints"
      },
      {
        "step": 2,
        "desc": "Identify the boundary conditions for the second spline",
        "expr": "spline(td, [0 rd 0], tp)",
        "value": "Clamped spline with zero first derivatives at endpoints"
      },
      {
        "step": 3,
        "desc": "Explain the effect of boundary conditions on spline behavior",
        "expr": "Different boundary conditions",
        "value": "Affect the shape and extrapolation of the spline"
      },
      {
        "step": 4,
        "desc": "Determine the impact on the estimate at t = 4.5",
        "expr": "Extrapolation behavior",
        "value": "Different due to boundary conditions"
      },
      {
        "step": "final",
        "desc": "Conclude why estimates differ at t = 4.5",
        "expr": "Boundary conditions",
        "value": "Lead to different extrapolated values"
      }
    ]
  },
  {
    "qid": "Problemone",
    "subid": "1iii",
    "subquestion": "Suppose that m ≥ n and that the rectangular matrix A ∈ ℝ^{m×n} has the singular value decomposition\n    A = U [Σ; 0] Vᵀ = Y Σ Vᵀ = Σ_{j=1}^n σ_j u_j v_jᵀ,\nwhere:\n    U = [Y Z] ∈ ℝ^{m×m},\n    Y = [u₁ u₂ ⋯ uₙ] ∈ ℝ^{m×n},\n    Z = [u_{n+1} ⋯ u_m] ∈ ℝ^{m×(m−n)},\n    Σ = diag(σ₁, σ₂, ..., σₙ) ∈ ℝ^{n×n},\n    V = [v₁ v₂ ⋯ vₙ] ∈ ℝ^{n×n},\nwith σ₁ ≥ σ₂ ≥ ⋯ ≥ σₙ ≥ 0.",
    "full_question": "A deterministic interest rate model r(t) at time t ∈ [0, T] interpolates the m = 9 data values in Table 1. The data is stored in MATLAB in column vectors td and rd.\nTable: i = [1 2 3 4 5 6 7 8 9]\n       t_i (years) = [0.0 0.5 1.0 1.5 2.0 2.5 3.0 3.5 4.0]\n       r(t_i) (%)  = [3.5 3.25 4.1 4.5 4.2 3.3 3.2 3.05 4.12]\ni) An analyst decides to try to fit a polynomial of degree n = 5 with coefficients in the vector a to the interest rate data. They define the Vandermonde matrix A_ij = t_i^{j−1} for i = 1,...,m, j = 1,...,n + 1.\nSome of the MATLAB commands they use are:\n    a = A \\ rd;\n    sv = svd(A);\n    svmax = sv(1)     → 1.2235e+03\n    svmin = sv(end)   → 6.4320e−02\nThey then plot the data and the polynomial as in Figure 1.\na)Explain why the polynomial approximation does not agree with the interest rate data, for example at t₆ = 2.5, t₇ = 3 or t₈ = 3.5 years.\nb) What is the rank of the matrix A? Give reasons for your answer\nc)Estimate the condition number κ₂(A) of A.\nd)Estimate the relative change in the polynomial coefficients a if there is a one basis point (0.01 of a percent) decrease in the interest rate at some time t_i. What confidence do you have in the values of a?\nii) The analyst then decides to interpolate the data with cubic splines using\ntp = linspace(0, 4.5, 5001);\nrsp1 = spline(td, rd, tp);\nrsp2 = spline(td, [0 rd 0], tp);\nand adds these two splines to the plot in Figure 1.\na) Explain what a “cubic spline interpolant” is.\nb) Why do the two cubic spline interpolants predict very different esti\u0002mates for the interest rate at t = 4.5 years?\niii) Suppose that m ≥ n and that the rectangular matrix A ∈ ℝ^{m×n} has the singular value decomposition\n    A = U [Σ; 0] Vᵀ = Y Σ Vᵀ = Σ_{j=1}^n σ_j u_j v_jᵀ,\nwhere:\n    U = [Y Z] ∈ ℝ^{m×m},\n    Y = [u₁ u₂ ⋯ uₙ] ∈ ℝ^{m×n},\n    Z = [u_{n+1} ⋯ u_m] ∈ ℝ^{m×(m−n)},\n    Σ = diag(σ₁, σ₂, ..., σₙ) ∈ ℝ^{n×n},\n    V = [v₁ v₂ ⋯ vₙ] ∈ ℝ^{n×n},\nwith σ₁ ≥ σ₂ ≥ ⋯ ≥ σₙ ≥ 6.\niv) State the definition of an orthogonal matrix Q ∈ ℝ^{n×n}.\nv) Show that if Q is orthogonal then ∥Qx∥₂ = ∥x∥₂ for all x ∈ ℝⁿ. Hint: (∥x∥₂)² = xᵀx.\nvi) For b ∈ ℝᵐ and y = Vᵀx, show that ∥Ax − b∥₂ is minimized when ∥Σy − Yᵀb∥₂ is minimized.",
    "steps": [
      {
        "step": 1,
        "desc": "Identify the given SVD of matrix A",
        "expr": "A = U [Σ; 0] Vᵀ",
        "value": null
      },
      {
        "step": 2,
        "desc": "Express A in terms of its singular value decomposition",
        "expr": "A = Y Σ Vᵀ",
        "value": null
      },
      {
        "step": 3,
        "desc": "Express A as a sum of rank-1 matrices",
        "expr": "A = Σ_{j=1}^n σ_j u_j v_jᵀ",
        "value": null
      },
      {
        "step": 4,
        "desc": "Identify the components of the SVD",
        "expr": "U = [Y Z], Y = [u₁ u₂ ⋯ uₙ], Z = [u_{n+1} ⋯ u_m], Σ = diag(σ₁, σ₂, ..., σₙ), V = [v₁ v₂ ⋯ vₙ]",
        "value": null
      },
      {
        "step": 5,
        "desc": "State the condition on singular values",
        "expr": "σ₁ ≥ σ₂ ≥ ⋯ ≥ σₙ ≥ 0",
        "value": null
      },
      {
        "step": "final",
        "desc": "Conclude the expression of A using SVD",
        "expr": "A = Σ_{j=1}^n σ_j u_j v_jᵀ",
        "value": null
      }
    ]
  },
  {
    "qid": "Problemone",
    "subid": "1iv",
    "subquestion": "State the definition of an orthogonal matrix Q ∈ ℝ^{n×n}.",
    "full_question": "A deterministic interest rate model r(t) at time t ∈ [0, T] interpolates the m = 9 data values in Table 1. The data is stored in MATLAB in column vectors td and rd.\nTable: i = [1 2 3 4 5 6 7 8 9]\n       t_i (years) = [0.0 0.5 1.0 1.5 2.0 2.5 3.0 3.5 4.0]\n       r(t_i) (%)  = [3.5 3.25 4.1 4.5 4.2 3.3 3.2 3.05 4.12]\ni) An analyst decides to try to fit a polynomial of degree n = 5 with coefficients in the vector a to the interest rate data. They define the Vandermonde matrix A_ij = t_i^{j−1} for i = 1,...,m, j = 1,...,n + 1.\nSome of the MATLAB commands they use are:\n    a = A \\ rd;\n    sv = svd(A);\n    svmax = sv(1)     → 1.2235e+03\n    svmin = sv(end)   → 6.4320e−02\nThey then plot the data and the polynomial as in Figure 1.\na)Explain why the polynomial approximation does not agree with the interest rate data, for example at t₆ = 2.5, t₇ = 3 or t₈ = 3.5 years.\nb) What is the rank of the matrix A? Give reasons for your answer\nc)Estimate the condition number κ₂(A) of A.\nd)Estimate the relative change in the polynomial coefficients a if there is a one basis point (0.01 of a percent) decrease in the interest rate at some time t_i. What confidence do you have in the values of a?\nii) The analyst then decides to interpolate the data with cubic splines using\ntp = linspace(0, 4.5, 5001);\nrsp1 = spline(td, rd, tp);\nrsp2 = spline(td, [0 rd 0], tp);\nand adds these two splines to the plot in Figure 1.\na) Explain what a “cubic spline interpolant” is.\nb) Why do the two cubic spline interpolants predict very different esti\u0002mates for the interest rate at t = 4.5 years?\niii) Suppose that m ≥ n and that the rectangular matrix A ∈ ℝ^{m×n} has the singular value decomposition\n    A = U [Σ; 0] Vᵀ = Y Σ Vᵀ = Σ_{j=1}^n σ_j u_j v_jᵀ,\nwhere:\n    U = [Y Z] ∈ ℝ^{m×m},\n    Y = [u₁ u₂ ⋯ uₙ] ∈ ℝ^{m×n},\n    Z = [u_{n+1} ⋯ u_m] ∈ ℝ^{m×(m−n)},\n    Σ = diag(σ₁, σ₂, ..., σₙ) ∈ ℝ^{n×n},\n    V = [v₁ v₂ ⋯ vₙ] ∈ ℝ^{n×n},\nwith σ₁ ≥ σ₂ ≥ ⋯ ≥ σₙ ≥ 7.\niv) State the definition of an orthogonal matrix Q ∈ ℝ^{n×n}.\nv) Show that if Q is orthogonal then ∥Qx∥₂ = ∥x∥₂ for all x ∈ ℝⁿ. Hint: (∥x∥₂)² = xᵀx.\nvi) For b ∈ ℝᵐ and y = Vᵀx, show that ∥Ax − b∥₂ is minimized when ∥Σy − Yᵀb∥₂ is minimized.",
    "steps": [
      {
        "step": 1,
        "desc": "Define an orthogonal matrix Q",
        "expr": "Q ∈ ℝ^{n×n}",
        "value": null
      },
      {
        "step": 2,
        "desc": "State the property of an orthogonal matrix",
        "expr": "QᵀQ = QQᵀ = I",
        "value": null
      },
      {
        "step": "final",
        "desc": "Conclude the definition of an orthogonal matrix",
        "expr": "Qᵀ = Q⁻¹",
        "value": null
      }
    ]
  },
  {
    "qid": "Problemone",
    "subid": "1v",
    "subquestion": "Show that if Q is orthogonal then ∥Qx∥₂ = ∥x∥₂ for all x ∈ ℝⁿ. Hint: (∥x∥₂)² = xᵀx.",
    "full_question": "A deterministic interest rate model r(t) at time t ∈ [0, T] interpolates the m = 9 data values in Table 1. The data is stored in MATLAB in column vectors td and rd.\nTable: i = [1 2 3 4 5 6 7 8 9]\n       t_i (years) = [0.0 0.5 1.0 1.5 2.0 2.5 3.0 3.5 4.0]\n       r(t_i) (%)  = [3.5 3.25 4.1 4.5 4.2 3.3 3.2 3.05 4.12]\ni) An analyst decides to try to fit a polynomial of degree n = 5 with coefficients in the vector a to the interest rate data. They define the Vandermonde matrix A_ij = t_i^{j−1} for i = 1,...,m, j = 1,...,n + 1.\nSome of the MATLAB commands they use are:\n    a = A \\ rd;\n    sv = svd(A);\n    svmax = sv(1)     → 1.2235e+03\n    svmin = sv(end)   → 6.4320e−02\nThey then plot the data and the polynomial as in Figure 1.\na)Explain why the polynomial approximation does not agree with the interest rate data, for example at t₆ = 2.5, t₇ = 3 or t₈ = 3.5 years.\nb) What is the rank of the matrix A? Give reasons for your answer\nc)Estimate the condition number κ₂(A) of A.\nd)Estimate the relative change in the polynomial coefficients a if there is a one basis point (0.01 of a percent) decrease in the interest rate at some time t_i. What confidence do you have in the values of a?\nii) The analyst then decides to interpolate the data with cubic splines using\ntp = linspace(0, 4.5, 5001);\nrsp1 = spline(td, rd, tp);\nrsp2 = spline(td, [0 rd 0], tp);\nand adds these two splines to the plot in Figure 1.\na) Explain what a “cubic spline interpolant” is.\nb) Why do the two cubic spline interpolants predict very different esti\u0002mates for the interest rate at t = 4.5 years?\niii) Suppose that m ≥ n and that the rectangular matrix A ∈ ℝ^{m×n} has the singular value decomposition\n    A = U [Σ; 0] Vᵀ = Y Σ Vᵀ = Σ_{j=1}^n σ_j u_j v_jᵀ,\nwhere:\n    U = [Y Z] ∈ ℝ^{m×m},\n    Y = [u₁ u₂ ⋯ uₙ] ∈ ℝ^{m×n},\n    Z = [u_{n+1} ⋯ u_m] ∈ ℝ^{m×(m−n)},\n    Σ = diag(σ₁, σ₂, ..., σₙ) ∈ ℝ^{n×n},\n    V = [v₁ v₂ ⋯ vₙ] ∈ ℝ^{n×n},\nwith σ₁ ≥ σ₂ ≥ ⋯ ≥ σₙ ≥ 8.\niv) State the definition of an orthogonal matrix Q ∈ ℝ^{n×n}.\nv) Show that if Q is orthogonal then ∥Qx∥₂ = ∥x∥₂ for all x ∈ ℝⁿ. Hint: (∥x∥₂)² = xᵀx.\nvi) For b ∈ ℝᵐ and y = Vᵀx, show that ∥Ax − b∥₂ is minimized when ∥Σy − Yᵀb∥₂ is minimized.",
    "steps": [
      {
        "step": 1,
        "desc": "Start with the definition of the 2-norm of a vector x",
        "expr": "∥x∥₂² = xᵀx",
        "value": null
      },
      {
        "step": 2,
        "desc": "Consider the vector Qx where Q is an orthogonal matrix",
        "expr": "∥Qx∥₂² = (Qx)ᵀ(Qx)",
        "value": null
      },
      {
        "step": 3,
        "desc": "Use the property of orthogonal matrices: QᵀQ = I",
        "expr": "(Qx)ᵀ(Qx) = xᵀQᵀQx",
        "value": null
      },
      {
        "step": 4,
        "desc": "Substitute QᵀQ with the identity matrix I",
        "expr": "xᵀQᵀQx = xᵀIx",
        "value": null
      },
      {
        "step": 5,
        "desc": "Simplify using the identity matrix property",
        "expr": "xᵀIx = xᵀx",
        "value": null
      },
      {
        "step": "final",
        "desc": "Conclude that ∥Qx∥₂ = ∥x∥₂ for all x ∈ ℝⁿ",
        "expr": "∥Qx∥₂² = ∥x∥₂²",
        "value": null
      }
    ]
  },
  {
    "qid": "Problemone",
    "subid": "1vi",
    "subquestion": "For b ∈ ℝᵐ and y = Vᵀx, show that ∥Ax − b∥₂ is minimized when ∥Σy − Yᵀb∥₂ is minimized.",
    "full_question": "A deterministic interest rate model r(t) at time t ∈ [0, T] interpolates the m = 9 data values in Table 1. The data is stored in MATLAB in column vectors td and rd.\nTable: i = [1 2 3 4 5 6 7 8 9]\n       t_i (years) = [0.0 0.5 1.0 1.5 2.0 2.5 3.0 3.5 4.0]\n       r(t_i) (%)  = [3.5 3.25 4.1 4.5 4.2 3.3 3.2 3.05 4.12]\ni) An analyst decides to try to fit a polynomial of degree n = 5 with coefficients in the vector a to the interest rate data. They define the Vandermonde matrix A_ij = t_i^{j−1} for i = 1,...,m, j = 1,...,n + 1.\nSome of the MATLAB commands they use are:\n    a = A \\ rd;\n    sv = svd(A);\n    svmax = sv(1)     → 1.2235e+03\n    svmin = sv(end)   → 6.4320e−02\nThey then plot the data and the polynomial as in Figure 1.\na)Explain why the polynomial approximation does not agree with the interest rate data, for example at t₆ = 2.5, t₇ = 3 or t₈ = 3.5 years.\nb) What is the rank of the matrix A? Give reasons for your answer\nc)Estimate the condition number κ₂(A) of A.\nd)Estimate the relative change in the polynomial coefficients a if there is a one basis point (0.01 of a percent) decrease in the interest rate at some time t_i. What confidence do you have in the values of a?\nii) The analyst then decides to interpolate the data with cubic splines using\ntp = linspace(0, 4.5, 5001);\nrsp1 = spline(td, rd, tp);\nrsp2 = spline(td, [0 rd 0], tp);\nand adds these two splines to the plot in Figure 1.\na) Explain what a “cubic spline interpolant” is.\nb) Why do the two cubic spline interpolants predict very different esti\u0002mates for the interest rate at t = 4.5 years?\niii) Suppose that m ≥ n and that the rectangular matrix A ∈ ℝ^{m×n} has the singular value decomposition\n    A = U [Σ; 0] Vᵀ = Y Σ Vᵀ = Σ_{j=1}^n σ_j u_j v_jᵀ,\nwhere:\n    U = [Y Z] ∈ ℝ^{m×m},\n    Y = [u₁ u₂ ⋯ uₙ] ∈ ℝ^{m×n},\n    Z = [u_{n+1} ⋯ u_m] ∈ ℝ^{m×(m−n)},\n    Σ = diag(σ₁, σ₂, ..., σₙ) ∈ ℝ^{n×n},\n    V = [v₁ v₂ ⋯ vₙ] ∈ ℝ^{n×n},\nwith σ₁ ≥ σ₂ ≥ ⋯ ≥ σₙ ≥ 9.\niv) State the definition of an orthogonal matrix Q ∈ ℝ^{n×n}.\nv) Show that if Q is orthogonal then ∥Qx∥₂ = ∥x∥₂ for all x ∈ ℝⁿ. Hint: (∥x∥₂)² = xᵀx.\nvi) For b ∈ ℝᵐ and y = Vᵀx, show that ∥Ax − b∥₂ is minimized when ∥Σy − Yᵀb∥₂ is minimized.",
    "steps": [
      {
        "step": 1,
        "desc": "Express Ax in terms of the SVD of A",
        "expr": "Ax = U [Σ; 0] Vᵀx",
        "value": null
      },
      {
        "step": 2,
        "desc": "Substitute y = Vᵀx into the expression for Ax",
        "expr": "Ax = U [Σ; 0] y",
        "value": null
      },
      {
        "step": 3,
        "desc": "Express the 2-norm of the difference Ax - b",
        "expr": "∥Ax - b∥₂ = ∥U [Σ; 0] y - b∥₂",
        "value": null
      },
      {
        "step": 4,
        "desc": "Use the orthogonality of U to simplify the expression",
        "expr": "∥Ax - b∥₂ = ∥[Σ; 0] y - Uᵀb∥₂",
        "value": null
      },
      {
        "step": 5,
        "desc": "Partition Uᵀb into components corresponding to Y and Z",
        "expr": "Uᵀb = [Yᵀb; Zᵀb]",
        "value": null
      },
      {
        "step": 6,
        "desc": "Express the norm in terms of the partitioned components",
        "expr": "∥[Σy; 0] - [Yᵀb; Zᵀb]∥₂ = ∥[Σy - Yᵀb; -Zᵀb]∥₂",
        "value": null
      },
      {
        "step": 7,
        "desc": "Use the property of 2-norm for block vectors",
        "expr": "∥[Σy - Yᵀb; -Zᵀb]∥₂ = √(∥Σy - Yᵀb∥₂² + ∥Zᵀb∥₂²)",
        "value": null
      },
      {
        "step": 8,
        "desc": "Minimize the expression by minimizing the first component",
        "expr": "∥Σy - Yᵀb∥₂",
        "value": null
      },
      {
        "step": "final",
        "desc": "Conclude that minimizing ∥Σy - Yᵀb∥₂ minimizes ∥Ax - b∥₂",
        "expr": null,
        "value": null
      }
    ]
  },
  {
    "qid": "Problemtwo",
    "subid": "2i",
    "subquestion": "i) Explain how to use MATLAB to estimate the exponential growth underlying the price of this asset (shown by the dashed curve) P_j ≈ α * exp(β * t_j)    for j = 0, ..., N-1.",
    "full_question": "A consultant wishes to model the weekly price data shown in the first plot of Figure 2.\nFigure 2: Price data, exponential fit and power spectrum.\nLet\n    N = 520,     T = 10,     Δt = T/N,\nand denote the jth price by P_j and the corresponding time (in years) by\n    t_j = j/52 = jΔt    for j = 0, 1, 2, ..., N-1.\n\nAssume that the data values are already stored in two N × 1 MATLAB arrays\nP = [P_0, P_1, ..., P_{N-1}]^T and t = [t_0, t_1, ..., t_{N-1}]^T.\n(Thus, P_j = P(j+1) and t_j = t(j+1).)\ni) Explain how to use MATLAB to estimate the exponential growth underlying the price of this asset (shown by the dashed curve) P_j ≈ α * exp(β * t_j)    for j = 0, ..., N-1.\nii) It is suspected there is a periodic component y; in the data. Let Pj= ae +yj, for j =0,...,N—1, using the values of a and 8 found in part i). The discrete Fourier transform is N-1 Tk = So yje PRIN for k =0,1,..., N-1. j=0 where i=(-1)^0.5\na) Show that GN—k = J, = complex conjugate of % for k=1,2,...,N—-1.\nb) Let n = 260 so that N = 2n. Show that\nYj =a + S- [a;, cos(2rkt;/T) + bj, sin(Qrkt ;/T)]\nk=l\nfor 7 = 0, 1, 2,..., N—1 and express the real coefficients ag, and by in\nterms of the (complex) transform %j,. You may assume the inversion\nformula\n{82\not ~ i2njk/N\nYj —_ N » YRE 7 .\nc) Define the power spectrum in terms of the Discrete Fourier Trans-\nform jy, fork =0,...,N—-1.\nd) Justify or refute the claim that the data in Figure 2 has both yearly\nand monthly cycles of roughly the same intensity.",
    "steps": [
      {
        "step": 1,
        "desc": "Take the natural logarithm of the price data to linearize the exponential model",
        "expr": "log(P_j) = log(α) + β * t_j",
        "value": null
      },
      {
        "step": 2,
        "desc": "Set up the linear regression problem in MATLAB",
        "expr": "Y = log(P), X = [ones(N, 1), t]",
        "value": null
      },
      {
        "step": 3,
        "desc": "Use MATLAB's backslash operator to solve for the linear regression coefficients",
        "expr": "[log(α); β] = X \\ Y",
        "value": null
      },
      {
        "step": 4,
        "desc": "Extract the coefficients from the regression result",
        "expr": "log_alpha = log(α), beta = β",
        "value": null
      },
      {
        "step": 5,
        "desc": "Compute the exponential growth parameters",
        "expr": "α = exp(log_alpha), β = beta",
        "value": null
      },
      {
        "step": "final",
        "desc": "Return the estimated parameters for the exponential growth model",
        "expr": "P_j ≈ α * exp(β * t_j)",
        "value": null
      }
    ]
  },
  {
    "qid": "Problemtwo",
    "subid": "2iia",
    "subquestion": "a) Show that GN—k = J, = complex conjugate of % for k=1,2,...,N—-1.",
    "full_question": "A consultant wishes to model the weekly price data shown in the first plot of Figure 2.\nFigure 2: Price data, exponential fit and power spectrum.\nLet\n    N = 520,     T = 10,     Δt = T/N,\nand denote the jth price by P_j and the corresponding time (in years) by\n    t_j = j/52 = jΔt    for j = 0, 1, 2, ..., N-1.\n\nAssume that the data values are already stored in two N × 1 MATLAB arrays\nP = [P_0, P_1, ..., P_{N-1}]^T and t = [t_0, t_1, ..., t_{N-1}]^T.\n(Thus, P_j = P(j+1) and t_j = t(j+1).)\ni) Explain how to use MATLAB to estimate the exponential growth underlying the price of this asset (shown by the dashed curve) P_j ≈ α * exp(β * t_j)    for j = 0, ..., N-1.\nii) It is suspected there is a periodic component y; in the data. Let Pj= ae +yj, for j =0,...,N—1, using the values of a and 8 found in part i). The discrete Fourier transform is N-1 Tk = So yje PRIN for k =0,1,..., N-1. j=0 where i=(-1)^0.5\na) Show that GN—k = J, = complex conjugate of % for k=1,2,...,N—-1.\nb) Let n = 260 so that N = 2n. Show that\nYj =a + S- [a;, cos(2rkt;/T) + bj, sin(Qrkt ;/T)]\nk=l\nfor 7 = 0, 1, 2,..., N—1 and express the real coefficients ag, and by in\nterms of the (complex) transform %j,. You may assume the inversion\nformula\n{82\not ~ i2njk/N\nYj —_ N » YRE 7 .\nc) Define the power spectrum in terms of the Discrete Fourier Trans-\nform jy, fork =0,...,N—-1.\nd) Justify or refute the claim that the data in Figure 3 has both yearly\nand monthly cycles of roughly the same intensity.",
    "steps": [
      {
        "step": 1,
        "desc": "Define the Discrete Fourier Transform (DFT) for the sequence y_j.",
        "expr": "T_k = sum(y_j * exp(-2 * pi * i * j * k / N), j=0 to N-1)",
        "value": null
      },
      {
        "step": 2,
        "desc": "Express the DFT for the (N-k)th term.",
        "expr": "T_{N-k} = sum(y_j * exp(-2 * pi * i * j * (N-k) / N), j=0 to N-1)",
        "value": null
      },
      {
        "step": 3,
        "desc": "Simplify the exponential term in T_{N-k}.",
        "expr": "exp(-2 * pi * i * j * (N-k) / N) = exp(-2 * pi * i * j) * exp(2 * pi * i * j * k / N)",
        "value": null
      },
      {
        "step": 4,
        "desc": "Use the periodicity property of the exponential function.",
        "expr": "exp(-2 * pi * i * j) = 1",
        "value": null
      },
      {
        "step": 5,
        "desc": "Substitute the periodicity result back into the expression for T_{N-k}.",
        "expr": "T_{N-k} = sum(y_j * exp(2 * pi * i * j * k / N), j=0 to N-1)",
        "value": null
      },
      {
        "step": 6,
        "desc": "Recognize that T_{N-k} is the complex conjugate of T_k.",
        "expr": "T_{N-k} = T_k^*",
        "value": null
      },
      {
        "step": "final",
        "desc": "Conclude that T_{N-k} is the complex conjugate of T_k for k=1,2,...,N-1.",
        "expr": "T_{N-k} = T_k^*",
        "value": null
      }
    ]
  },
  {
    "qid": "Problemtwo",
    "subid": "2iib",
    "subquestion": "b) Let n = 260 so that N = 2n. Show that\nYj =a + S- [a;, cos(2rkt;/T) + bj, sin(Qrkt ;/T)]\nk=l\nfor 7 = 0, 1, 2,..., N—1 and express the real coefficients ag, and by in\nterms of the (complex) transform %j,. You may assume the inversion\nformula\n{82\not ~ i2njk/N\nYj —_ N » YRE 7 .",
    "full_question": "A consultant wishes to model the weekly price data shown in the first plot of Figure 2.\nFigure 2: Price data, exponential fit and power spectrum.\nLet\n    N = 520,     T = 10,     Δt = T/N,\nand denote the jth price by P_j and the corresponding time (in years) by\n    t_j = j/52 = jΔt    for j = 0, 1, 2, ..., N-1.\n\nAssume that the data values are already stored in two N × 1 MATLAB arrays\nP = [P_0, P_1, ..., P_{N-1}]^T and t = [t_0, t_1, ..., t_{N-1}]^T.\n(Thus, P_j = P(j+1) and t_j = t(j+1).)\ni) Explain how to use MATLAB to estimate the exponential growth underlying the price of this asset (shown by the dashed curve) P_j ≈ α * exp(β * t_j)    for j = 0, ..., N-1.\nii) It is suspected there is a periodic component y; in the data. Let Pj= ae +yj, for j =0,...,N—1, using the values of a and 8 found in part i). The discrete Fourier transform is N-1 Tk = So yje PRIN for k =0,1,..., N-1. j=0 where i=(-1)^0.5\na) Show that GN—k = J, = complex conjugate of % for k=1,2,...,N—-1.\nb) Let n = 260 so that N = 2n. Show that\nYj =a + S- [a;, cos(2rkt;/T) + bj, sin(Qrkt ;/T)]\nk=l\nfor 7 = 0, 1, 2,..., N—1 and express the real coefficients ag, and by in\nterms of the (complex) transform %j,. You may assume the inversion\nformula\n{82\not ~ i2njk/N\nYj —_ N » YRE 7 .\nc) Define the power spectrum in terms of the Discrete Fourier Trans-\nform jy, fork =0,...,N—-1.\nd) Justify or refute the claim that the data in Figure 4 has both yearly\nand monthly cycles of roughly the same intensity.",
    "steps": [
      {
        "step": 1,
        "desc": "Start with the given inversion formula for the Discrete Fourier Transform (DFT).",
        "expr": "Y_j = \\frac{1}{N} \\sum_{k=0}^{N-1} T_k e^{i 2 \\pi jk / N}",
        "value": null
      },
      {
        "step": 2,
        "desc": "Express the exponential term using Euler's formula.",
        "expr": "e^{i 2 \\pi jk / N} = \\cos(2 \\pi jk / N) + i \\sin(2 \\pi jk / N)",
        "value": null
      },
      {
        "step": 3,
        "desc": "Substitute Euler's formula into the inversion formula.",
        "expr": "Y_j = \\frac{1}{N} \\sum_{k=0}^{N-1} T_k (\\cos(2 \\pi jk / N) + i \\sin(2 \\pi jk / N))",
        "value": null
      },
      {
        "step": 4,
        "desc": "Separate the real and imaginary parts of the sum.",
        "expr": "Y_j = \\frac{1}{N} \\sum_{k=0}^{N-1} (\\text{Re}(T_k) \\cos(2 \\pi jk / N) - \\text{Im}(T_k) \\sin(2 \\pi jk / N)) + i (\\text{Re}(T_k) \\sin(2 \\pi jk / N) + \\text{Im}(T_k) \\cos(2 \\pi jk / N))",
        "value": null
      },
      {
        "step": 5,
        "desc": "Since Y_j is real, the imaginary part must be zero.",
        "expr": "i (\\text{Re}(T_k) \\sin(2 \\pi jk / N) + \\text{Im}(T_k) \\cos(2 \\pi jk / N)) = 0",
        "value": null
      },
      {
        "step": 6,
        "desc": "Focus on the real part of the expression.",
        "expr": "Y_j = \\frac{1}{N} \\sum_{k=0}^{N-1} (\\text{Re}(T_k) \\cos(2 \\pi jk / N) - \\text{Im}(T_k) \\sin(2 \\pi jk / N))",
        "value": null
      },
      {
        "step": 7,
        "desc": "Express the real coefficients a_k and b_k in terms of T_k.",
        "expr": "a_k = \\frac{2}{N} \\text{Re}(T_k), \\quad b_k = -\\frac{2}{N} \\text{Im}(T_k)",
        "value": null
      },
      {
        "step": 8,
        "desc": "Substitute a_k and b_k into the expression for Y_j.",
        "expr": "Y_j = a + \\sum_{k=1}^{N/2-1} \\left[ a_k \\cos(2 \\pi jk / N) + b_k \\sin(2 \\pi jk / N) \\right]",
        "value": null
      },
      {
        "step": "final",
        "desc": "Final expression for Y_j with real coefficients a_k and b_k.",
        "expr": "Y_j = a + \\sum_{k=1}^{N/2-1} \\left[ \\frac{2}{N} \\text{Re}(T_k) \\cos(2 \\pi jk / N) - \\frac{2}{N} \\text{Im}(T_k) \\sin(2 \\pi jk / N) \\right]",
        "value": null
      }
    ]
  },
  {
    "qid": "Problemtwo",
    "subid": "2iic",
    "subquestion": "c) Define the power spectrum in terms of the Discrete Fourier Trans-\nform jy, fork =0,...,N—-1.",
    "full_question": "A consultant wishes to model the weekly price data shown in the first plot of Figure 2.\nFigure 2: Price data, exponential fit and power spectrum.\nLet\n    N = 520,     T = 10,     Δt = T/N,\nand denote the jth price by P_j and the corresponding time (in years) by\n    t_j = j/52 = jΔt    for j = 0, 1, 2, ..., N-1.\n\nAssume that the data values are already stored in two N × 1 MATLAB arrays\nP = [P_0, P_1, ..., P_{N-1}]^T and t = [t_0, t_1, ..., t_{N-1}]^T.\n(Thus, P_j = P(j+1) and t_j = t(j+1).)\ni) Explain how to use MATLAB to estimate the exponential growth underlying the price of this asset (shown by the dashed curve) P_j ≈ α * exp(β * t_j)    for j = 0, ..., N-1.\nii) It is suspected there is a periodic component y; in the data. Let Pj= ae +yj, for j =0,...,N—1, using the values of a and 8 found in part i). The discrete Fourier transform is N-1 Tk = So yje PRIN for k =0,1,..., N-1. j=0 where i=(-1)^0.5\na) Show that GN—k = J, = complex conjugate of % for k=1,2,...,N—-1.\nb) Let n = 260 so that N = 2n. Show that\nYj =a + S- [a;, cos(2rkt;/T) + bj, sin(Qrkt ;/T)]\nk=l\nfor 7 = 0, 1, 2,..., N—1 and express the real coefficients ag, and by in\nterms of the (complex) transform %j,. You may assume the inversion\nformula\n{82\not ~ i2njk/N\nYj —_ N » YRE 7 .\nc) Define the power spectrum in terms of the Discrete Fourier Trans-\nform jy, fork =0,...,N—-1.\nd) Justify or refute the claim that the data in Figure 5 has both yearly\nand monthly cycles of roughly the same intensity.",
    "steps": [
      {
        "step": 1,
        "desc": "Define the Discrete Fourier Transform (DFT) of the sequence y_j.",
        "expr": "Y_k = \\sum_{j=0}^{N-1} y_j e^{-i 2 \\pi k j / N}",
        "value": null
      },
      {
        "step": 2,
        "desc": "Define the power spectrum in terms of the DFT.",
        "expr": "P_k = |Y_k|^2",
        "value": null
      },
      {
        "step": "final",
        "desc": "The power spectrum is the squared magnitude of the DFT coefficients.",
        "expr": "P_k = Y_k \\overline{Y_k}",
        "value": null
      }
    ]
  },
  {
    "qid": "Problemtwo",
    "subid": "2iid",
    "subquestion": "d) Justify or refute the claim that the data in Figure 2 has both yearly\nand monthly cycles of roughly the same intensity.",
    "full_question": "A consultant wishes to model the weekly price data shown in the first plot of Figure 2.\nFigure 2: Price data, exponential fit and power spectrum.\nLet\n    N = 520,     T = 10,     Δt = T/N,\nand denote the jth price by P_j and the corresponding time (in years) by\n    t_j = j/52 = jΔt    for j = 0, 1, 2, ..., N-1.\n\nAssume that the data values are already stored in two N × 1 MATLAB arrays\nP = [P_0, P_1, ..., P_{N-1}]^T and t = [t_0, t_1, ..., t_{N-1}]^T.\n(Thus, P_j = P(j+1) and t_j = t(j+1).)\ni) Explain how to use MATLAB to estimate the exponential growth underlying the price of this asset (shown by the dashed curve) P_j ≈ α * exp(β * t_j)    for j = 0, ..., N-1.\nii) It is suspected there is a periodic component y; in the data. Let Pj= ae +yj, for j =0,...,N—1, using the values of a and 8 found in part i). The discrete Fourier transform is N-1 Tk = So yje PRIN for k =0,1,..., N-1. j=0 where i=(-1)^0.5\na) Show that GN—k = J, = complex conjugate of % for k=1,2,...,N—-1.\nb) Let n = 260 so that N = 2n. Show that\nYj =a + S- [a;, cos(2rkt;/T) + bj, sin(Qrkt ;/T)]\nk=l\nfor 7 = 0, 1, 2,..., N—1 and express the real coefficients ag, and by in\nterms of the (complex) transform %j,. You may assume the inversion\nformula\n{82\not ~ i2njk/N\nYj —_ N » YRE 7 .\nc) Define the power spectrum in terms of the Discrete Fourier Trans-\nform jy, fork =0,...,N—-1.\nd) Justify or refute the claim that the data in Figure 6 has both yearly\nand monthly cycles of roughly the same intensity.",
    "steps": [
      {
        "step": 1,
        "desc": "Identify the relevant frequencies for yearly and monthly cycles in the data.",
        "expr": "f_yearly = 1 year / T, f_monthly = 1 month / T",
        "value": "f_yearly = 1/10, f_monthly = 1/120"
      },
      {
        "step": 2,
        "desc": "Convert these frequencies to indices in the Discrete Fourier Transform (DFT) output.",
        "expr": "k_yearly = f_yearly * N, k_monthly = f_monthly * N",
        "value": "k_yearly = 52, k_monthly = 4.33"
      },
      {
        "step": 3,
        "desc": "Examine the power spectrum at these indices to determine the intensity of the cycles.",
        "expr": "Power_spectrum[k_yearly], Power_spectrum[k_monthly]",
        "value": "Power_spectrum[52], Power_spectrum[4]"
      },
      {
        "step": 4,
        "desc": "Compare the power spectrum values at the yearly and monthly indices.",
        "expr": "Compare Power_spectrum[52] and Power_spectrum[4]",
        "value": "Depends on actual data values"
      },
      {
        "step": "final",
        "desc": "Determine if the yearly and monthly cycles have roughly the same intensity based on the power spectrum comparison.",
        "expr": "Power_spectrum[52] ≈ Power_spectrum[4]",
        "value": "Justify or refute based on comparison"
      }
    ]
  },
  {
    "qid": "Problemthree",
    "subid": "3i",
    "subquestion": "What tests should you apply to check that a provided matrix C is a valid covariance matrix for use in calculating p(x)?",
    "full_question": "The random vector X = [X₁, X₂, ..., Xₙ]ᵀ ∈ ℝⁿ is normally distributed with mean μ = [μ₁, μ₂, ..., μₙ]ᵀ ∈ ℝⁿ and covariance matrix C ∈ ℝⁿˣⁿ. Thus, X has the probability density function\np(x) = exp(−(x − μ)ᵀ C⁻¹ (x − μ)/2) / √((2π)ⁿ det(C))  for x ∈ ℝⁿ.\ni)What tests should you apply to check that a provided matrix C is a valid covariance matrix for use in calculating p(x)?\nii)Explain how the Cholesky factorization C = RᵀR can be used to \na) evaluate √det(C) efficiently;\nb) evaluate p(x) efficiently.\niii) From now on, suppose for simplicity that n = 2, and consider the problem of evaluating the expected value of f(X₁, X₂),\nE[f(X₁, X₂)] = ∬ f(x₁, x₂)p(x₁, x₂) dx₁ dx₂ The standard normal pdf and cdf functions are:\nϕ(x) = 1/√(2π) · e^(−x²/2),   Φ(y) = ∫[−∞ to y] ϕ(x) dx\na) Show that the substitution x = μ + Rᵀy, where R is the Cholesky factor of C, gives p(x₁, x₂) = ϕ(y₁)ϕ(y₂) / (R₁₁ R₂₂)\nb) Transform the expected value to E[f(X₁, X₂)] = ∬[0 to 1] F(z₁, z₂) dz₁ dz₂ and find an expression for the function F.\nc) Consider now the Monte Carlo method.\nA) Briefly describe how you would use the Monte Carlo method to compute a numerical approximation to the integral (2).\nB) What can you say about the accuracy of the Monte Carlo method?\nC) How could you improve the accuracy of the Monte Carlo method?",
    "steps": [
      {
        "step": 1,
        "desc": "Check if C is a square matrix",
        "expr": "C ∈ ℝⁿˣⁿ",
        "value": "True or False"
      },
      {
        "step": 2,
        "desc": "Check if C is symmetric",
        "expr": "C = Cᵀ",
        "value": "True or False"
      },
      {
        "step": 3,
        "desc": "Check if C is positive semi-definite",
        "expr": "xᵀCx ≥ 0 for all x ∈ ℝⁿ",
        "value": "True or False"
      },
      {
        "step": "final",
        "desc": "Determine if C is a valid covariance matrix",
        "expr": "C is valid if all previous checks are True",
        "value": "True or False"
      }
    ]
  },
  {
    "qid": "Problemthree",
    "subid": "3iia",
    "subquestion": "evaluate √det(C) efficiently;",
    "full_question": "The random vector X = [X₁, X₂, ..., Xₙ]ᵀ ∈ ℝⁿ is normally distributed with mean μ = [μ₁, μ₂, ..., μₙ]ᵀ ∈ ℝⁿ and covariance matrix C ∈ ℝⁿˣⁿ. Thus, X has the probability density function\np(x) = exp(−(x − μ)ᵀ C⁻¹ (x − μ)/2) / √((2π)ⁿ det(C))  for x ∈ ℝⁿ.\ni)What tests should you apply to check that a provided matrix C is a valid covariance matrix for use in calculating p(x)?\nii)Explain how the Cholesky factorization C = RᵀR can be used to \na) evaluate √det(C) efficiently;\nb) evaluate p(x) efficiently.\niii) From now on, suppose for simplicity that n = 2, and consider the problem of evaluating the expected value of f(X₁, X₂),\nE[f(X₁, X₂)] = ∬ f(x₁, x₂)p(x₁, x₂) dx₁ dx₂ The standard normal pdf and cdf functions are:\nϕ(x) = 1/√(2π) · e^(−x²/2),   Φ(y) = ∫[−∞ to y] ϕ(x) dx\na) Show that the substitution x = μ + Rᵀy, where R is the Cholesky factor of C, gives p(x₁, x₂) = ϕ(y₁)ϕ(y₂) / (R₁₁ R₂₂)\nb) Transform the expected value to E[f(X₁, X₂)] = ∬[0 to 1] F(z₁, z₂) dz₁ dz₂ and find an expression for the function F.\nc) Consider now the Monte Carlo method.\nA) Briefly describe how you would use the Monte Carlo method to compute a numerical approximation to the integral (3).\nB) What can you say about the accuracy of the Monte Carlo method?\nC) How could you improve the accuracy of the Monte Carlo method?",
    "steps": [
      {
        "step": 1,
        "desc": "Perform Cholesky factorization of C to obtain R such that C = RᵀR",
        "expr": "C = RᵀR",
        "value": null
      },
      {
        "step": 2,
        "desc": "The determinant of C is the square of the determinant of R",
        "expr": "det(C) = (det(R))²",
        "value": null
      },
      {
        "step": 3,
        "desc": "The determinant of an upper triangular matrix R is the product of its diagonal elements",
        "expr": "det(R) = R₁₁ * R₂₂ * ... * Rₙₙ",
        "value": null
      },
      {
        "step": 4,
        "desc": "Compute the square root of the determinant of C using the determinant of R",
        "expr": "√det(C) = |det(R)|",
        "value": null
      },
      {
        "step": "final",
        "desc": "Efficiently evaluate √det(C) using the product of the diagonal elements of R",
        "expr": "√det(C) = |R₁₁ * R₂₂ * ... * Rₙₙ|",
        "value": null
      }
    ]
  },
  {
    "qid": "Problemthree",
    "subid": "3iib",
    "subquestion": "evaluate p(x) efficiently.",
    "full_question": "The random vector X = [X₁, X₂, ..., Xₙ]ᵀ ∈ ℝⁿ is normally distributed with mean μ = [μ₁, μ₂, ..., μₙ]ᵀ ∈ ℝⁿ and covariance matrix C ∈ ℝⁿˣⁿ. Thus, X has the probability density function\np(x) = exp(−(x − μ)ᵀ C⁻¹ (x − μ)/2) / √((2π)ⁿ det(C))  for x ∈ ℝⁿ.\ni)What tests should you apply to check that a provided matrix C is a valid covariance matrix for use in calculating p(x)?\nii)Explain how the Cholesky factorization C = RᵀR can be used to \na) evaluate √det(C) efficiently;\nb) evaluate p(x) efficiently.\niii) From now on, suppose for simplicity that n = 2, and consider the problem of evaluating the expected value of f(X₁, X₂),\nE[f(X₁, X₂)] = ∬ f(x₁, x₂)p(x₁, x₂) dx₁ dx₂ The standard normal pdf and cdf functions are:\nϕ(x) = 1/√(2π) · e^(−x²/2),   Φ(y) = ∫[−∞ to y] ϕ(x) dx\na) Show that the substitution x = μ + Rᵀy, where R is the Cholesky factor of C, gives p(x₁, x₂) = ϕ(y₁)ϕ(y₂) / (R₁₁ R₂₂)\nb) Transform the expected value to E[f(X₁, X₂)] = ∬[0 to 1] F(z₁, z₂) dz₁ dz₂ and find an expression for the function F.\nc) Consider now the Monte Carlo method.\nA) Briefly describe how you would use the Monte Carlo method to compute a numerical approximation to the integral (4).\nB) What can you say about the accuracy of the Monte Carlo method?\nC) How could you improve the accuracy of the Monte Carlo method?",
    "steps": [
      {
        "step": 1,
        "desc": "Check if C is a valid covariance matrix",
        "expr": "C is symmetric and positive definite",
        "value": null
      },
      {
        "step": 2,
        "desc": "Perform Cholesky factorization of C",
        "expr": "C = RᵀR",
        "value": null
      },
      {
        "step": 3,
        "desc": "Compute the inverse of C using Cholesky factor",
        "expr": "C⁻¹ = (Rᵀ)⁻¹ R⁻¹",
        "value": null
      },
      {
        "step": 4,
        "desc": "Compute the determinant of C using Cholesky factor",
        "expr": "det(C) = (R₁₁ R₂₂ ... Rₙₙ)²",
        "value": null
      },
      {
        "step": 5,
        "desc": "Compute the square root of the determinant",
        "expr": "√det(C) = R₁₁ R₂₂ ... Rₙₙ",
        "value": null
      },
      {
        "step": 6,
        "desc": "Compute the quadratic form using Cholesky factor",
        "expr": "(x - μ)ᵀ C⁻¹ (x - μ) = (yᵀy) where y = R⁻¹(x - μ)",
        "value": null
      },
      {
        "step": "final",
        "desc": "Evaluate p(x) using the computed values",
        "expr": "p(x) = exp(−yᵀy/2) / (√((2π)ⁿ) * (R₁₁ R₂₂ ... Rₙₙ))",
        "value": null
      }
    ]
  },
  {
    "qid": "Problemthree",
    "subid": "3iiia",
    "subquestion": "Show that the substitution x = μ + Rᵀy, where R is the Cholesky factor of C, gives p(x₁, x₂) = ϕ(y₁)ϕ(y₂) / (R₁₁ R₂₂)",
    "full_question": "The random vector X = [X₁, X₂, ..., Xₙ]ᵀ ∈ ℝⁿ is normally distributed with mean μ = [μ₁, μ₂, ..., μₙ]ᵀ ∈ ℝⁿ and covariance matrix C ∈ ℝⁿˣⁿ. Thus, X has the probability density function\np(x) = exp(−(x − μ)ᵀ C⁻¹ (x − μ)/2) / √((2π)ⁿ det(C))  for x ∈ ℝⁿ.\ni)What tests should you apply to check that a provided matrix C is a valid covariance matrix for use in calculating p(x)?\nii)Explain how the Cholesky factorization C = RᵀR can be used to \na) evaluate √det(C) efficiently;\nb) evaluate p(x) efficiently.\niii) From now on, suppose for simplicity that n = 2, and consider the problem of evaluating the expected value of f(X₁, X₂),\nE[f(X₁, X₂)] = ∬ f(x₁, x₂)p(x₁, x₂) dx₁ dx₂ The standard normal pdf and cdf functions are:\nϕ(x) = 1/√(2π) · e^(−x²/2),   Φ(y) = ∫[−∞ to y] ϕ(x) dx\na) Show that the substitution x = μ + Rᵀy, where R is the Cholesky factor of C, gives p(x₁, x₂) = ϕ(y₁)ϕ(y₂) / (R₁₁ R₂₂)\nb) Transform the expected value to E[f(X₁, X₂)] = ∬[0 to 1] F(z₁, z₂) dz₁ dz₂ and find an expression for the function F.\nc) Consider now the Monte Carlo method.\nA) Briefly describe how you would use the Monte Carlo method to compute a numerical approximation to the integral (5).\nB) What can you say about the accuracy of the Monte Carlo method?\nC) How could you improve the accuracy of the Monte Carlo method?",
    "steps": [
      {
        "step": 1,
        "desc": "Start with the substitution x = μ + Rᵀy",
        "expr": "x = μ + Rᵀy",
        "value": null
      },
      {
        "step": 2,
        "desc": "Express the transformation in terms of y",
        "expr": "y = (Rᵀ)⁻¹(x - μ)",
        "value": null
      },
      {
        "step": 3,
        "desc": "Substitute x = μ + Rᵀy into the expression for p(x)",
        "expr": "p(x) = exp(−(Rᵀy)ᵀ C⁻¹ (Rᵀy)/2) / √((2π)² det(C))",
        "value": null
      },
      {
        "step": 4,
        "desc": "Since C = RᵀR, C⁻¹ = (Rᵀ)⁻¹ R⁻¹",
        "expr": "C⁻¹ = (Rᵀ)⁻¹ R⁻¹",
        "value": null
      },
      {
        "step": 5,
        "desc": "Simplify the exponent using the property of the inverse",
        "expr": "(Rᵀy)ᵀ (Rᵀ)⁻¹ R⁻¹ (Rᵀy) = yᵀy",
        "value": null
      },
      {
        "step": 6,
        "desc": "Substitute back into the expression for p(x)",
        "expr": "p(x) = exp(−yᵀy/2) / √((2π)² det(C))",
        "value": null
      },
      {
        "step": 7,
        "desc": "Use the Cholesky factorization to express det(C)",
        "expr": "det(C) = (R₁₁ R₂₂)²",
        "value": null
      },
      {
        "step": 8,
        "desc": "Substitute det(C) into the expression for p(x)",
        "expr": "p(x) = exp(−yᵀy/2) / (2π R₁₁ R₂₂)",
        "value": null
      },
      {
        "step": 9,
        "desc": "Recognize the standard normal pdf ϕ(y)",
        "expr": "ϕ(y) = 1/√(2π) · e^(−y²/2)",
        "value": null
      },
      {
        "step": "final",
        "desc": "Express p(x) in terms of ϕ(y₁) and ϕ(y₂)",
        "expr": "p(x₁, x₂) = ϕ(y₁)ϕ(y₂) / (R₁₁ R₂₂)",
        "value": null
      }
    ]
  },
  {
    "qid": "Problemthree",
    "subid": "3iiib",
    "subquestion": "Transform the expected value to E[f(X₁, X₂)] = ∬[0 to 1] F(z₁, z₂) dz₁ dz₂ and find an expression for the function F.",
    "full_question": "The random vector X = [X₁, X₂, ..., Xₙ]ᵀ ∈ ℝⁿ is normally distributed with mean μ = [μ₁, μ₂, ..., μₙ]ᵀ ∈ ℝⁿ and covariance matrix C ∈ ℝⁿˣⁿ. Thus, X has the probability density function\np(x) = exp(−(x − μ)ᵀ C⁻¹ (x − μ)/2) / √((2π)ⁿ det(C))  for x ∈ ℝⁿ.\ni)What tests should you apply to check that a provided matrix C is a valid covariance matrix for use in calculating p(x)?\nii)Explain how the Cholesky factorization C = RᵀR can be used to \na) evaluate √det(C) efficiently;\nb) evaluate p(x) efficiently.\niii) From now on, suppose for simplicity that n = 2, and consider the problem of evaluating the expected value of f(X₁, X₂),\nE[f(X₁, X₂)] = ∬ f(x₁, x₂)p(x₁, x₂) dx₁ dx₂ The standard normal pdf and cdf functions are:\nϕ(x) = 1/√(2π) · e^(−x²/2),   Φ(y) = ∫[−∞ to y] ϕ(x) dx\na) Show that the substitution x = μ + Rᵀy, where R is the Cholesky factor of C, gives p(x₁, x₂) = ϕ(y₁)ϕ(y₂) / (R₁₁ R₂₂)\nb) Transform the expected value to E[f(X₁, X₂)] = ∬[0 to 1] F(z₁, z₂) dz₁ dz₂ and find an expression for the function F.\nc) Consider now the Monte Carlo method.\nA) Briefly describe how you would use the Monte Carlo method to compute a numerical approximation to the integral (6).\nB) What can you say about the accuracy of the Monte Carlo method?\nC) How could you improve the accuracy of the Monte Carlo method?",
    "steps": [
      {
        "step": 1,
        "desc": "Start with the transformation x = μ + Rᵀy, where R is the Cholesky factor of C.",
        "expr": "x = μ + Rᵀy",
        "value": null
      },
      {
        "step": 2,
        "desc": "Substitute x = μ + Rᵀy into the probability density function p(x).",
        "expr": "p(x) = ϕ(y₁)ϕ(y₂) / (R₁₁ R₂₂)",
        "value": null
      },
      {
        "step": 3,
        "desc": "Express the expected value E[f(X₁, X₂)] using the transformation.",
        "expr": "E[f(X₁, X₂)] = ∬ f(μ + Rᵀy) ϕ(y₁)ϕ(y₂) dy₁ dy₂",
        "value": null
      },
      {
        "step": 4,
        "desc": "Change variables from y to z using the standard normal CDF: z₁ = Φ(y₁), z₂ = Φ(y₂).",
        "expr": "z₁ = Φ(y₁), z₂ = Φ(y₂)",
        "value": null
      },
      {
        "step": 5,
        "desc": "Express y in terms of z using the inverse CDF: y₁ = Φ⁻¹(z₁), y₂ = Φ⁻¹(z₂).",
        "expr": "y₁ = Φ⁻¹(z₁), y₂ = Φ⁻¹(z₂)",
        "value": null
      },
      {
        "step": 6,
        "desc": "Substitute y = Φ⁻¹(z) into the expected value integral.",
        "expr": "E[f(X₁, X₂)] = ∬ f(μ + RᵀΦ⁻¹(z)) dz₁ dz₂",
        "value": null
      },
      {
        "step": "final",
        "desc": "Identify the function F(z₁, z₂) in the transformed expected value.",
        "expr": "F(z₁, z₂) = f(μ + RᵀΦ⁻¹(z))",
        "value": null
      }
    ]
  },
  {
    "qid": "Problemthree",
    "subid": "3iiicA",
    "subquestion": "Briefly describe how you would use the Monte Carlo method to compute a numerical approximation to the integral (2).",
    "full_question": "The random vector X = [X₁, X₂, ..., Xₙ]ᵀ ∈ ℝⁿ is normally distributed with mean μ = [μ₁, μ₂, ..., μₙ]ᵀ ∈ ℝⁿ and covariance matrix C ∈ ℝⁿˣⁿ. Thus, X has the probability density function\np(x) = exp(−(x − μ)ᵀ C⁻¹ (x − μ)/2) / √((2π)ⁿ det(C))  for x ∈ ℝⁿ.\ni)What tests should you apply to check that a provided matrix C is a valid covariance matrix for use in calculating p(x)?\nii)Explain how the Cholesky factorization C = RᵀR can be used to \na) evaluate √det(C) efficiently;\nb) evaluate p(x) efficiently.\niii) From now on, suppose for simplicity that n = 2, and consider the problem of evaluating the expected value of f(X₁, X₂),\nE[f(X₁, X₂)] = ∬ f(x₁, x₂)p(x₁, x₂) dx₁ dx₂ The standard normal pdf and cdf functions are:\nϕ(x) = 1/√(2π) · e^(−x²/2),   Φ(y) = ∫[−∞ to y] ϕ(x) dx\na) Show that the substitution x = μ + Rᵀy, where R is the Cholesky factor of C, gives p(x₁, x₂) = ϕ(y₁)ϕ(y₂) / (R₁₁ R₂₂)\nb) Transform the expected value to E[f(X₁, X₂)] = ∬[0 to 1] F(z₁, z₂) dz₁ dz₂ and find an expression for the function F.\nc) Consider now the Monte Carlo method.\nA) Briefly describe how you would use the Monte Carlo method to compute a numerical approximation to the integral (7).\nB) What can you say about the accuracy of the Monte Carlo method?\nC) How could you improve the accuracy of the Monte Carlo method?",
    "steps": [
      {
        "step": 1,
        "desc": "Generate a large number of random samples from the standard normal distribution for y1 and y2.",
        "expr": "y1, y2 ~ N(0, 1)",
        "value": null
      },
      {
        "step": 2,
        "desc": "Transform the samples using the Cholesky factor R to obtain samples for x1 and x2.",
        "expr": "x = μ + Rᵀy",
        "value": null
      },
      {
        "step": 3,
        "desc": "Evaluate the function f at each sample point (x1, x2).",
        "expr": "f(x1, x2)",
        "value": null
      },
      {
        "step": 4,
        "desc": "Compute the average of the function values to approximate the expected value.",
        "expr": "E[f(X1, X2)] ≈ (1/N) * Σ f(x1, x2)",
        "value": null
      },
      {
        "step": "final",
        "desc": "Return the computed average as the Monte Carlo approximation of the integral.",
        "expr": null,
        "value": "Monte Carlo approximation of E[f(X1, X2)]"
      }
    ]
  },
  {
    "qid": "Problemthree",
    "subid": "3iiicB",
    "subquestion": "What can you say about the accuracy of the Monte Carlo method?",
    "full_question": "The random vector X = [X₁, X₂, ..., Xₙ]ᵀ ∈ ℝⁿ is normally distributed with mean μ = [μ₁, μ₂, ..., μₙ]ᵀ ∈ ℝⁿ and covariance matrix C ∈ ℝⁿˣⁿ. Thus, X has the probability density function\np(x) = exp(−(x − μ)ᵀ C⁻¹ (x − μ)/2) / √((2π)ⁿ det(C))  for x ∈ ℝⁿ.\ni)What tests should you apply to check that a provided matrix C is a valid covariance matrix for use in calculating p(x)?\nii)Explain how the Cholesky factorization C = RᵀR can be used to \na) evaluate √det(C) efficiently;\nb) evaluate p(x) efficiently.\niii) From now on, suppose for simplicity that n = 2, and consider the problem of evaluating the expected value of f(X₁, X₂),\nE[f(X₁, X₂)] = ∬ f(x₁, x₂)p(x₁, x₂) dx₁ dx₂ The standard normal pdf and cdf functions are:\nϕ(x) = 1/√(2π) · e^(−x²/2),   Φ(y) = ∫[−∞ to y] ϕ(x) dx\na) Show that the substitution x = μ + Rᵀy, where R is the Cholesky factor of C, gives p(x₁, x₂) = ϕ(y₁)ϕ(y₂) / (R₁₁ R₂₂)\nb) Transform the expected value to E[f(X₁, X₂)] = ∬[0 to 1] F(z₁, z₂) dz₁ dz₂ and find an expression for the function F.\nc) Consider now the Monte Carlo method.\nA) Briefly describe how you would use the Monte Carlo method to compute a numerical approximation to the integral (8).\nB) What can you say about the accuracy of the Monte Carlo method?\nC) How could you improve the accuracy of the Monte Carlo method?",
    "steps": [
      {
        "step": 1,
        "desc": "Introduce the concept of the Monte Carlo method's accuracy.",
        "expr": "Accuracy = O(1/√N)",
        "value": null
      },
      {
        "step": 2,
        "desc": "Explain that the accuracy of the Monte Carlo method is determined by the standard error.",
        "expr": "Standard Error = σ/√N",
        "value": null
      },
      {
        "step": 3,
        "desc": "Define σ as the standard deviation of the function being integrated.",
        "expr": "σ = √(Var[f(X)])",
        "value": null
      },
      {
        "step": 4,
        "desc": "State that the accuracy improves with the number of samples N.",
        "expr": "Accuracy ∝ 1/√N",
        "value": null
      },
      {
        "step": 5,
        "desc": "Conclude that the Monte Carlo method converges slowly compared to other numerical methods.",
        "expr": "Convergence Rate = O(1/√N)",
        "value": null
      },
      {
        "step": "final",
        "desc": "Summarize that the accuracy of the Monte Carlo method is limited by the slow convergence rate, but it is independent of the dimensionality of the problem.",
        "expr": null,
        "value": null
      }
    ]
  },
  {
    "qid": "Problemthree",
    "subid": "3iiicC",
    "subquestion": "How could you improve the accuracy of the Monte Carlo method?",
    "full_question": "The random vector X = [X₁, X₂, ..., Xₙ]ᵀ ∈ ℝⁿ is normally distributed with mean μ = [μ₁, μ₂, ..., μₙ]ᵀ ∈ ℝⁿ and covariance matrix C ∈ ℝⁿˣⁿ. Thus, X has the probability density function\np(x) = exp(−(x − μ)ᵀ C⁻¹ (x − μ)/2) / √((2π)ⁿ det(C))  for x ∈ ℝⁿ.\ni)What tests should you apply to check that a provided matrix C is a valid covariance matrix for use in calculating p(x)?\nii)Explain how the Cholesky factorization C = RᵀR can be used to \na) evaluate √det(C) efficiently;\nb) evaluate p(x) efficiently.\niii) From now on, suppose for simplicity that n = 2, and consider the problem of evaluating the expected value of f(X₁, X₂),\nE[f(X₁, X₂)] = ∬ f(x₁, x₂)p(x₁, x₂) dx₁ dx₂ The standard normal pdf and cdf functions are:\nϕ(x) = 1/√(2π) · e^(−x²/2),   Φ(y) = ∫[−∞ to y] ϕ(x) dx\na) Show that the substitution x = μ + Rᵀy, where R is the Cholesky factor of C, gives p(x₁, x₂) = ϕ(y₁)ϕ(y₂) / (R₁₁ R₂₂)\nb) Transform the expected value to E[f(X₁, X₂)] = ∬[0 to 1] F(z₁, z₂) dz₁ dz₂ and find an expression for the function F.\nc) Consider now the Monte Carlo method.\nA) Briefly describe how you would use the Monte Carlo method to compute a numerical approximation to the integral (9).\nB) What can you say about the accuracy of the Monte Carlo method?\nC) How could you improve the accuracy of the Monte Carlo method?",
    "steps": [
      {
        "step": 1,
        "desc": "Identify variance reduction techniques to improve accuracy",
        "expr": null,
        "value": null
      },
      {
        "step": 2,
        "desc": "Implement antithetic variates to reduce variance",
        "expr": "X_i, -X_i",
        "value": null
      },
      {
        "step": 3,
        "desc": "Use control variates to reduce variance",
        "expr": "E[Y] = E[Y] + c(E[Z] - ̂E[Z])",
        "value": null
      },
      {
        "step": 4,
        "desc": "Apply importance sampling to focus on important regions",
        "expr": "E[f(X)] = ∫ f(x)w(x)p(x)dx",
        "value": null
      },
      {
        "step": 5,
        "desc": "Increase the number of samples to reduce standard error",
        "expr": "SE = σ/√n",
        "value": null
      },
      {
        "step": 6,
        "desc": "Use stratified sampling to ensure all regions are sampled",
        "expr": null,
        "value": null
      },
      {
        "step": "final",
        "desc": "Combine multiple techniques for optimal accuracy improvement",
        "expr": null,
        "value": null
      }
    ]
  },
  {
    "qid": "Problemfour",
    "subid": "4i",
    "subquestion": "Carefully explain what the 'initial' conditions are for this problem.",
    "full_question": "The value V(S, t) of an exotic option on an underlying asset with price S at time t satisfies the Black–Scholes PDE:\n∂V/∂t + rS ∂V/∂S + (1/2)σ²S² ∂²V/∂S² = rV\nfor 0 < S < ∞ and 0 < t < T. We assume r and σ are known positive constants.\n\nConsider pricing an exotic option with barrier B, strike price 0 < X < B and expiry T. If at any time t ∈ [0, T] the price S hits B, the option is exercised for payout B−X. Otherwise, it can only be exercised at t = T for right to buy at X.\ni) Carefully explain what the 'initial' conditions are for this problem.\nii) Carefully explain what the boundary conditions are for this problem.\niii) Set up a grid (S_j, t_ℓ) = (jΔS, ℓΔt) for j = 0,...,n+1 and ℓ = 0,...,m, where ΔS = B/(n+1), Δt = T/m. Let v_j^ℓ ≈ V(S_j, t_ℓ).\na) A) At time t_ℓ and value S_j, give central difference approximations of O(ΔS²) for partial derivatives ∂V/∂S and ∂²V/∂S².\n    B) Give a forward difference approximation of O(Δt) for ∂V/∂t.\nb) We want to use an implicit finite difference method to approximate v_j^ℓ.\n   A) Show that the finite difference equation has the form: α_j v_{j−1}^ℓ + β_j v_j^ℓ + γ_j v_{j+1}^ℓ = v_j^{ℓ+1}, and find α_j, β_j, γ_j.\n   B) What are the discrete “initial” conditions?\n   C) What are the discrete boundary conditions?\niv) Equation (4) has the form: A v^ℓ + b = v^{ℓ+1}, where v^ℓ = (v_1^ℓ, ..., v_n^ℓ)^T and b = (0, ..., 0, γ_n(B − X))^T.\n a) Define the entries a_{i,j} of matrix A = (a_{i,j}). What structure does A have?\n b) Is the matrix A sparse? Calculate its sparsity.\n c) How can the structure of the matrix A be exploited to make time\u0002stepping as efficient as possible?\n d)Provide an estimation of the number of flops needed to compute the vector v^0.",
    "steps": [
      {
        "step": 1,
        "desc": "Identify the nature of the option and its exercise conditions",
        "expr": "V(S, T) = max(S - X, 0) if S < B",
        "value": "V(S, T) = max(S - X, 0) if S < B"
      },
      {
        "step": 2,
        "desc": "Determine the payout if the barrier is hit before expiry",
        "expr": "V(S, t) = B - X if S = B",
        "value": "V(S, t) = B - X if S = B"
      },
      {
        "step": 3,
        "desc": "Define the initial condition at expiry for S < B",
        "expr": "V(S, T) = max(S - X, 0) for S < B",
        "value": "V(S, T) = max(S - X, 0) for S < B"
      },
      {
        "step": "final",
        "desc": "Summarize the initial condition for the problem",
        "expr": "V(S, T) = max(S - X, 0) for S < B; V(S, t) = B - X if S = B",
        "value": "V(S, T) = max(S - X, 0) for S < B; V(S, t) = B - X if S = B"
      }
    ]
  },
  {
    "qid": "Problemfour",
    "subid": "4ii",
    "subquestion": "Carefully explain what the boundary conditions are for this problem.",
    "full_question": "The value V(S, t) of an exotic option on an underlying asset with price S at time t satisfies the Black–Scholes PDE:\n∂V/∂t + rS ∂V/∂S + (1/2)σ²S² ∂²V/∂S² = rV\nfor 0 < S < ∞ and 0 < t < T. We assume r and σ are known positive constants.\n\nConsider pricing an exotic option with barrier B, strike price 0 < X < B and expiry T. If at any time t ∈ [0, T] the price S hits B, the option is exercised for payout B−X. Otherwise, it can only be exercised at t = T for right to buy at X.\ni) Carefully explain what the 'initial' conditions are for this problem.\nii) Carefully explain what the boundary conditions are for this problem.\niii) Set up a grid (S_j, t_ℓ) = (jΔS, ℓΔt) for j = 0,...,n+1 and ℓ = 0,...,m, where ΔS = B/(n+1), Δt = T/m. Let v_j^ℓ ≈ V(S_j, t_ℓ).\na) A) At time t_ℓ and value S_j, give central difference approximations of O(ΔS²) for partial derivatives ∂V/∂S and ∂²V/∂S².\n    B) Give a forward difference approximation of O(Δt) for ∂V/∂t.\nb) We want to use an implicit finite difference method to approximate v_j^ℓ.\n   A) Show that the finite difference equation has the form: α_j v_{j−1}^ℓ + β_j v_j^ℓ + γ_j v_{j+1}^ℓ = v_j^{ℓ+1}, and find α_j, β_j, γ_j.\n   B) What are the discrete “initial” conditions?\n   C) What are the discrete boundary conditions?\niv) Equation (4) has the form: A v^ℓ + b = v^{ℓ+1}, where v^ℓ = (v_1^ℓ, ..., v_n^ℓ)^T and b = (0, ..., 0, γ_n(B − X))^T.\n a) Define the entries a_{i,j} of matrix A = (a_{i,j}). What structure does A have?\n b) Is the matrix A sparse? Calculate its sparsity.\n c) How can the structure of the matrix A be exploited to make time\u0002stepping as efficient as possible?\n d)Provide an estimation of the number of flops needed to compute the vector v^1.",
    "steps": [
      {
        "step": 1,
        "desc": "Identify the boundary condition at S = 0",
        "expr": "V(0, t) = 0",
        "value": "V(0, t) = 0"
      },
      {
        "step": 2,
        "desc": "Identify the boundary condition at S = B",
        "expr": "V(B, t) = B - X",
        "value": "V(B, t) = B - X"
      },
      {
        "step": "final",
        "desc": "Summarize the boundary conditions",
        "expr": "V(0, t) = 0, V(B, t) = B - X",
        "value": "V(0, t) = 0, V(B, t) = B - X"
      }
    ]
  },
  {
    "qid": "Problemfour",
    "subid": "4iiiaA",
    "subquestion": "At time t_ℓ and value S_j, give central difference approximations of O(ΔS²) for partial derivatives ∂V/∂S and ∂²V/∂S².",
    "full_question": "The value V(S, t) of an exotic option on an underlying asset with price S at time t satisfies the Black–Scholes PDE:\n∂V/∂t + rS ∂V/∂S + (1/2)σ²S² ∂²V/∂S² = rV\nfor 0 < S < ∞ and 0 < t < T. We assume r and σ are known positive constants.\n\nConsider pricing an exotic option with barrier B, strike price 0 < X < B and expiry T. If at any time t ∈ [0, T] the price S hits B, the option is exercised for payout B−X. Otherwise, it can only be exercised at t = T for right to buy at X.\ni) Carefully explain what the 'initial' conditions are for this problem.\nii) Carefully explain what the boundary conditions are for this problem.\niii) Set up a grid (S_j, t_ℓ) = (jΔS, ℓΔt) for j = 0,...,n+1 and ℓ = 0,...,m, where ΔS = B/(n+1), Δt = T/m. Let v_j^ℓ ≈ V(S_j, t_ℓ).\na) A) At time t_ℓ and value S_j, give central difference approximations of O(ΔS²) for partial derivatives ∂V/∂S and ∂²V/∂S².\n    B) Give a forward difference approximation of O(Δt) for ∂V/∂t.\nb) We want to use an implicit finite difference method to approximate v_j^ℓ.\n   A) Show that the finite difference equation has the form: α_j v_{j−1}^ℓ + β_j v_j^ℓ + γ_j v_{j+1}^ℓ = v_j^{ℓ+1}, and find α_j, β_j, γ_j.\n   B) What are the discrete “initial” conditions?\n   C) What are the discrete boundary conditions?\niv) Equation (4) has the form: A v^ℓ + b = v^{ℓ+1}, where v^ℓ = (v_1^ℓ, ..., v_n^ℓ)^T and b = (0, ..., 0, γ_n(B − X))^T.\n a) Define the entries a_{i,j} of matrix A = (a_{i,j}). What structure does A have?\n b) Is the matrix A sparse? Calculate its sparsity.\n c) How can the structure of the matrix A be exploited to make time\u0002stepping as efficient as possible?\n d)Provide an estimation of the number of flops needed to compute the vector v^2.",
    "steps": [
      {
        "step": 1,
        "desc": "Define the central difference approximation for the first derivative ∂V/∂S at S_j",
        "expr": "(V(S_{j+1}, t_ℓ) - V(S_{j-1}, t_ℓ)) / (2ΔS)",
        "value": null
      },
      {
        "step": 2,
        "desc": "Define the central difference approximation for the second derivative ∂²V/∂S² at S_j",
        "expr": "(V(S_{j+1}, t_ℓ) - 2V(S_j, t_ℓ) + V(S_{j-1}, t_ℓ)) / (ΔS²)",
        "value": null
      },
      {
        "step": "final",
        "desc": "Provide the central difference approximations for both derivatives",
        "expr": {
          "∂V/∂S": "(V(S_{j+1}, t_ℓ) - V(S_{j-1}, t_ℓ)) / (2ΔS)",
          "∂²V/∂S²": "(V(S_{j+1}, t_ℓ) - 2V(S_j, t_ℓ) + V(S_{j-1}, t_ℓ)) / (ΔS²)"
        },
        "value": null
      }
    ]
  },
  {
    "qid": "Problemfour",
    "subid": "4iiiaB",
    "subquestion": "Give a forward difference approximation of O(Δt) for ∂V/∂t.",
    "full_question": "The value V(S, t) of an exotic option on an underlying asset with price S at time t satisfies the Black–Scholes PDE:\n∂V/∂t + rS ∂V/∂S + (1/2)σ²S² ∂²V/∂S² = rV\nfor 0 < S < ∞ and 0 < t < T. We assume r and σ are known positive constants.\n\nConsider pricing an exotic option with barrier B, strike price 0 < X < B and expiry T. If at any time t ∈ [0, T] the price S hits B, the option is exercised for payout B−X. Otherwise, it can only be exercised at t = T for right to buy at X.\ni) Carefully explain what the 'initial' conditions are for this problem.\nii) Carefully explain what the boundary conditions are for this problem.\niii) Set up a grid (S_j, t_ℓ) = (jΔS, ℓΔt) for j = 0,...,n+1 and ℓ = 0,...,m, where ΔS = B/(n+1), Δt = T/m. Let v_j^ℓ ≈ V(S_j, t_ℓ).\na) A) At time t_ℓ and value S_j, give central difference approximations of O(ΔS²) for partial derivatives ∂V/∂S and ∂²V/∂S².\n    B) Give a forward difference approximation of O(Δt) for ∂V/∂t.\nb) We want to use an implicit finite difference method to approximate v_j^ℓ.\n   A) Show that the finite difference equation has the form: α_j v_{j−1}^ℓ + β_j v_j^ℓ + γ_j v_{j+1}^ℓ = v_j^{ℓ+1}, and find α_j, β_j, γ_j.\n   B) What are the discrete “initial” conditions?\n   C) What are the discrete boundary conditions?\niv) Equation (4) has the form: A v^ℓ + b = v^{ℓ+1}, where v^ℓ = (v_1^ℓ, ..., v_n^ℓ)^T and b = (0, ..., 0, γ_n(B − X))^T.\n a) Define the entries a_{i,j} of matrix A = (a_{i,j}). What structure does A have?\n b) Is the matrix A sparse? Calculate its sparsity.\n c) How can the structure of the matrix A be exploited to make time\u0002stepping as efficient as possible?\n d)Provide an estimation of the number of flops needed to compute the vector v^3.",
    "steps": [
      {
        "step": 1,
        "desc": "Identify the forward difference formula for the time derivative",
        "expr": "\\frac{\\partial V}{\\partial t} \\approx \\frac{V(S_j, t_{\\ell+1}) - V(S_j, t_\\ell)}{\\Delta t}",
        "value": null
      },
      {
        "step": 2,
        "desc": "Substitute the grid notation into the forward difference formula",
        "expr": "\\frac{\\partial V}{\\partial t} \\approx \\frac{v_j^{\\ell+1} - v_j^\\ell}{\\Delta t}",
        "value": null
      },
      {
        "step": "final",
        "desc": "Provide the forward difference approximation for the time derivative",
        "expr": "\\frac{\\partial V}{\\partial t} \\approx \\frac{v_j^{\\ell+1} - v_j^\\ell}{\\Delta t}",
        "value": null
      }
    ]
  },
  {
    "qid": "Problemfour",
    "subid": "4iiibA",
    "subquestion": "Show that the finite difference equation has the form: α_j v_{j−1}^ℓ + β_j v_j^ℓ + γ_j v_{j+1}^ℓ = v_j^{ℓ+1}, and find α_j, β_j, γ_j.",
    "full_question": "The value V(S, t) of an exotic option on an underlying asset with price S at time t satisfies the Black–Scholes PDE:\n∂V/∂t + rS ∂V/∂S + (1/2)σ²S² ∂²V/∂S² = rV\nfor 0 < S < ∞ and 0 < t < T. We assume r and σ are known positive constants.\n\nConsider pricing an exotic option with barrier B, strike price 0 < X < B and expiry T. If at any time t ∈ [0, T] the price S hits B, the option is exercised for payout B−X. Otherwise, it can only be exercised at t = T for right to buy at X.\ni) Carefully explain what the 'initial' conditions are for this problem.\nii) Carefully explain what the boundary conditions are for this problem.\niii) Set up a grid (S_j, t_ℓ) = (jΔS, ℓΔt) for j = 0,...,n+1 and ℓ = 0,...,m, where ΔS = B/(n+1), Δt = T/m. Let v_j^ℓ ≈ V(S_j, t_ℓ).\na) A) At time t_ℓ and value S_j, give central difference approximations of O(ΔS²) for partial derivatives ∂V/∂S and ∂²V/∂S².\n    B) Give a forward difference approximation of O(Δt) for ∂V/∂t.\nb) We want to use an implicit finite difference method to approximate v_j^ℓ.\n   A) Show that the finite difference equation has the form: α_j v_{j−1}^ℓ + β_j v_j^ℓ + γ_j v_{j+1}^ℓ = v_j^{ℓ+1}, and find α_j, β_j, γ_j.\n   B) What are the discrete “initial” conditions?\n   C) What are the discrete boundary conditions?\niv) Equation (4) has the form: A v^ℓ + b = v^{ℓ+1}, where v^ℓ = (v_1^ℓ, ..., v_n^ℓ)^T and b = (0, ..., 0, γ_n(B − X))^T.\n a) Define the entries a_{i,j} of matrix A = (a_{i,j}). What structure does A have?\n b) Is the matrix A sparse? Calculate its sparsity.\n c) How can the structure of the matrix A be exploited to make time\u0002stepping as efficient as possible?\n d)Provide an estimation of the number of flops needed to compute the vector v^4.",
    "steps": [
      {
        "step": 1,
        "desc": "Start with the Black-Scholes PDE and apply finite difference approximations.",
        "expr": "∂V/∂t + rS ∂V/∂S + (1/2)σ²S² ∂²V/∂S² = rV",
        "value": null
      },
      {
        "step": 2,
        "desc": "Use central difference for ∂V/∂S at S_j.",
        "expr": "(V(S_{j+1}, t) - V(S_{j-1}, t)) / (2ΔS)",
        "value": null
      },
      {
        "step": 3,
        "desc": "Use central difference for ∂²V/∂S² at S_j.",
        "expr": "(V(S_{j+1}, t) - 2V(S_j, t) + V(S_{j-1}, t)) / (ΔS²)",
        "value": null
      },
      {
        "step": 4,
        "desc": "Use forward difference for ∂V/∂t at t_ℓ.",
        "expr": "(V(S_j, t_{ℓ+1}) - V(S_j, t_ℓ)) / Δt",
        "value": null
      },
      {
        "step": 5,
        "desc": "Substitute finite differences into the Black-Scholes PDE.",
        "expr": "(V(S_j, t_{ℓ+1}) - V(S_j, t_ℓ)) / Δt + rS_j (V(S_{j+1}, t_ℓ) - V(S_{j-1}, t_ℓ)) / (2ΔS) + (1/2)σ²S_j² (V(S_{j+1}, t_ℓ) - 2V(S_j, t_ℓ) + V(S_{j-1}, t_ℓ)) / (ΔS²) = rV(S_j, t_ℓ)",
        "value": null
      },
      {
        "step": 6,
        "desc": "Rearrange terms to isolate V(S_j, t_{ℓ+1}).",
        "expr": "V(S_j, t_{ℓ+1}) = V(S_j, t_ℓ) + Δt [rS_j (V(S_{j+1}, t_ℓ) - V(S_{j-1}, t_ℓ)) / (2ΔS) + (1/2)σ²S_j² (V(S_{j+1}, t_ℓ) - 2V(S_j, t_ℓ) + V(S_{j-1}, t_ℓ)) / (ΔS²) - rV(S_j, t_ℓ)]",
        "value": null
      },
      {
        "step": 7,
        "desc": "Identify coefficients α_j, β_j, γ_j for the implicit method.",
        "expr": "α_j = Δt [(1/2)σ²S_j² / (ΔS²) - rS_j / (2ΔS)], β_j = 1 - Δt [(1/2)σ²S_j² / (ΔS²) + r], γ_j = Δt [(1/2)σ²S_j² / (ΔS²) + rS_j / (2ΔS)]",
        "value": {
          "α_j": "Δt [(1/2)σ²S_j² / (ΔS²) - rS_j / (2ΔS)]",
          "β_j": "1 - Δt [(1/2)σ²S_j² / (ΔS²) + r]",
          "γ_j": "Δt [(1/2)σ²S_j² / (ΔS²) + rS_j / (2ΔS)]"
        }
      },
      {
        "step": "final",
        "desc": "The finite difference equation is in the form α_j v_{j−1}^ℓ + β_j v_j^ℓ + γ_j v_{j+1}^ℓ = v_j^{ℓ+1}.",
        "expr": "α_j v_{j−1}^ℓ + β_j v_j^ℓ + γ_j v_{j+1}^ℓ = v_j^{ℓ+1}",
        "value": {
          "α_j": "Δt [(1/2)σ²S_j² / (ΔS²) - rS_j / (2ΔS)]",
          "β_j": "1 - Δt [(1/2)σ²S_j² / (ΔS²) + r]",
          "γ_j": "Δt [(1/2)σ²S_j² / (ΔS²) + rS_j / (2ΔS)]"
        }
      }
    ]
  },
  {
    "qid": "Problemfour",
    "subid": "4iiibB",
    "subquestion": "What are the discrete “initial” conditions?",
    "full_question": "The value V(S, t) of an exotic option on an underlying asset with price S at time t satisfies the Black–Scholes PDE:\n∂V/∂t + rS ∂V/∂S + (1/2)σ²S² ∂²V/∂S² = rV\nfor 0 < S < ∞ and 0 < t < T. We assume r and σ are known positive constants.\n\nConsider pricing an exotic option with barrier B, strike price 0 < X < B and expiry T. If at any time t ∈ [0, T] the price S hits B, the option is exercised for payout B−X. Otherwise, it can only be exercised at t = T for right to buy at X.\ni) Carefully explain what the 'initial' conditions are for this problem.\nii) Carefully explain what the boundary conditions are for this problem.\niii) Set up a grid (S_j, t_ℓ) = (jΔS, ℓΔt) for j = 0,...,n+1 and ℓ = 0,...,m, where ΔS = B/(n+1), Δt = T/m. Let v_j^ℓ ≈ V(S_j, t_ℓ).\na) A) At time t_ℓ and value S_j, give central difference approximations of O(ΔS²) for partial derivatives ∂V/∂S and ∂²V/∂S².\n    B) Give a forward difference approximation of O(Δt) for ∂V/∂t.\nb) We want to use an implicit finite difference method to approximate v_j^ℓ.\n   A) Show that the finite difference equation has the form: α_j v_{j−1}^ℓ + β_j v_j^ℓ + γ_j v_{j+1}^ℓ = v_j^{ℓ+1}, and find α_j, β_j, γ_j.\n   B) What are the discrete “initial” conditions?\n   C) What are the discrete boundary conditions?\niv) Equation (4) has the form: A v^ℓ + b = v^{ℓ+1}, where v^ℓ = (v_1^ℓ, ..., v_n^ℓ)^T and b = (0, ..., 0, γ_n(B − X))^T.\n a) Define the entries a_{i,j} of matrix A = (a_{i,j}). What structure does A have?\n b) Is the matrix A sparse? Calculate its sparsity.\n c) How can the structure of the matrix A be exploited to make time\u0002stepping as efficient as possible?\n d)Provide an estimation of the number of flops needed to compute the vector v^5.",
    "steps": [
      {
        "step": 1,
        "desc": "Identify the initial condition for the option value at expiry time T.",
        "expr": "V(S, T) = max(B - X, S - X)",
        "value": null
      },
      {
        "step": 2,
        "desc": "Translate the initial condition into a discrete form at time step ℓ = m.",
        "expr": "v_j^m = max(B - X, S_j - X)",
        "value": null
      },
      {
        "step": "final",
        "desc": "Set the discrete initial conditions for all grid points j = 0, ..., n+1 at time step ℓ = m.",
        "expr": "v_j^m = max(B - X, jΔS - X)",
        "value": null
      }
    ]
  },
  {
    "qid": "Problemfour",
    "subid": "4iiibC",
    "subquestion": "What are the discrete boundary conditions?",
    "full_question": "The value V(S, t) of an exotic option on an underlying asset with price S at time t satisfies the Black–Scholes PDE:\n∂V/∂t + rS ∂V/∂S + (1/2)σ²S² ∂²V/∂S² = rV\nfor 0 < S < ∞ and 0 < t < T. We assume r and σ are known positive constants.\n\nConsider pricing an exotic option with barrier B, strike price 0 < X < B and expiry T. If at any time t ∈ [0, T] the price S hits B, the option is exercised for payout B−X. Otherwise, it can only be exercised at t = T for right to buy at X.\ni) Carefully explain what the 'initial' conditions are for this problem.\nii) Carefully explain what the boundary conditions are for this problem.\niii) Set up a grid (S_j, t_ℓ) = (jΔS, ℓΔt) for j = 0,...,n+1 and ℓ = 0,...,m, where ΔS = B/(n+1), Δt = T/m. Let v_j^ℓ ≈ V(S_j, t_ℓ).\na) A) At time t_ℓ and value S_j, give central difference approximations of O(ΔS²) for partial derivatives ∂V/∂S and ∂²V/∂S².\n    B) Give a forward difference approximation of O(Δt) for ∂V/∂t.\nb) We want to use an implicit finite difference method to approximate v_j^ℓ.\n   A) Show that the finite difference equation has the form: α_j v_{j−1}^ℓ + β_j v_j^ℓ + γ_j v_{j+1}^ℓ = v_j^{ℓ+1}, and find α_j, β_j, γ_j.\n   B) What are the discrete “initial” conditions?\n   C) What are the discrete boundary conditions?\niv) Equation (4) has the form: A v^ℓ + b = v^{ℓ+1}, where v^ℓ = (v_1^ℓ, ..., v_n^ℓ)^T and b = (0, ..., 0, γ_n(B − X))^T.\n a) Define the entries a_{i,j} of matrix A = (a_{i,j}). What structure does A have?\n b) Is the matrix A sparse? Calculate its sparsity.\n c) How can the structure of the matrix A be exploited to make time\u0002stepping as efficient as possible?\n d)Provide an estimation of the number of flops needed to compute the vector v^6.",
    "steps": [
      {
        "step": 1,
        "desc": "Identify the boundary condition at S = 0",
        "expr": "V(0, t) = 0",
        "value": "v_0^ℓ = 0"
      },
      {
        "step": 2,
        "desc": "Identify the boundary condition at S = B",
        "expr": "V(B, t) = B - X",
        "value": "v_{n+1}^ℓ = B - X"
      },
      {
        "step": "final",
        "desc": "State the discrete boundary conditions",
        "expr": "v_0^ℓ = 0, v_{n+1}^ℓ = B - X",
        "value": "v_0^ℓ = 0, v_{n+1}^ℓ = B - X"
      }
    ]
  },
  {
    "qid": "Problemfour",
    "subid": "4iva",
    "subquestion": "Define the entries a_{i,j} of matrix A = (a_{i,j}). What structure does A have?",
    "full_question": "The value V(S, t) of an exotic option on an underlying asset with price S at time t satisfies the Black–Scholes PDE:\n∂V/∂t + rS ∂V/∂S + (1/2)σ²S² ∂²V/∂S² = rV\nfor 0 < S < ∞ and 0 < t < T. We assume r and σ are known positive constants.\n\nConsider pricing an exotic option with barrier B, strike price 0 < X < B and expiry T. If at any time t ∈ [0, T] the price S hits B, the option is exercised for payout B−X. Otherwise, it can only be exercised at t = T for right to buy at X.\ni) Carefully explain what the 'initial' conditions are for this problem.\nii) Carefully explain what the boundary conditions are for this problem.\niii) Set up a grid (S_j, t_ℓ) = (jΔS, ℓΔt) for j = 0,...,n+1 and ℓ = 0,...,m, where ΔS = B/(n+1), Δt = T/m. Let v_j^ℓ ≈ V(S_j, t_ℓ).\na) A) At time t_ℓ and value S_j, give central difference approximations of O(ΔS²) for partial derivatives ∂V/∂S and ∂²V/∂S².\n    B) Give a forward difference approximation of O(Δt) for ∂V/∂t.\nb) We want to use an implicit finite difference method to approximate v_j^ℓ.\n   A) Show that the finite difference equation has the form: α_j v_{j−1}^ℓ + β_j v_j^ℓ + γ_j v_{j+1}^ℓ = v_j^{ℓ+1}, and find α_j, β_j, γ_j.\n   B) What are the discrete “initial” conditions?\n   C) What are the discrete boundary conditions?\niv) Equation (4) has the form: A v^ℓ + b = v^{ℓ+1}, where v^ℓ = (v_1^ℓ, ..., v_n^ℓ)^T and b = (0, ..., 0, γ_n(B − X))^T.\n a) Define the entries a_{i,j} of matrix A = (a_{i,j}). What structure does A have?\n b) Is the matrix A sparse? Calculate its sparsity.\n c) How can the structure of the matrix A be exploited to make time\u0002stepping as efficient as possible?\n d)Provide an estimation of the number of flops needed to compute the vector v^7.",
    "steps": [
      {
        "step": 1,
        "desc": "Identify the finite difference equation form",
        "expr": "α_j v_{j−1}^ℓ + β_j v_j^ℓ + γ_j v_{j+1}^ℓ = v_j^{ℓ+1}",
        "value": null
      },
      {
        "step": 2,
        "desc": "Express α_j, β_j, γ_j in terms of r, σ, ΔS, Δt",
        "expr": "α_j = -(1/2)σ²S_j²/ΔS² + rS_j/(2ΔS)",
        "value": null
      },
      {
        "step": 3,
        "desc": "Express β_j in terms of r, σ, ΔS, Δt",
        "expr": "β_j = 1/Δt + σ²S_j²/ΔS² + r",
        "value": null
      },
      {
        "step": 4,
        "desc": "Express γ_j in terms of r, σ, ΔS, Δt",
        "expr": "γ_j = -(1/2)σ²S_j²/ΔS² - rS_j/(2ΔS)",
        "value": null
      },
      {
        "step": 5,
        "desc": "Define the entries a_{i,j} of matrix A",
        "expr": "a_{i,i-1} = α_i, a_{i,i} = β_i, a_{i,i+1} = γ_i",
        "value": null
      },
      {
        "step": 6,
        "desc": "Determine the structure of matrix A",
        "expr": "A is a tridiagonal matrix",
        "value": null
      },
      {
        "step": "final",
        "desc": "Conclude the structure of matrix A",
        "expr": "A = tridiagonal(α_i, β_i, γ_i)",
        "value": "tridiagonal"
      }
    ]
  },
  {
    "qid": "Problemfour",
    "subid": "4ivb",
    "subquestion": "Is the matrix A sparse? Calculate its sparsity.",
    "full_question": "The value V(S, t) of an exotic option on an underlying asset with price S at time t satisfies the Black–Scholes PDE:\n∂V/∂t + rS ∂V/∂S + (1/2)σ²S² ∂²V/∂S² = rV\nfor 0 < S < ∞ and 0 < t < T. We assume r and σ are known positive constants.\n\nConsider pricing an exotic option with barrier B, strike price 0 < X < B and expiry T. If at any time t ∈ [0, T] the price S hits B, the option is exercised for payout B−X. Otherwise, it can only be exercised at t = T for right to buy at X.\ni) Carefully explain what the 'initial' conditions are for this problem.\nii) Carefully explain what the boundary conditions are for this problem.\niii) Set up a grid (S_j, t_ℓ) = (jΔS, ℓΔt) for j = 0,...,n+1 and ℓ = 0,...,m, where ΔS = B/(n+1), Δt = T/m. Let v_j^ℓ ≈ V(S_j, t_ℓ).\na) A) At time t_ℓ and value S_j, give central difference approximations of O(ΔS²) for partial derivatives ∂V/∂S and ∂²V/∂S².\n    B) Give a forward difference approximation of O(Δt) for ∂V/∂t.\nb) We want to use an implicit finite difference method to approximate v_j^ℓ.\n   A) Show that the finite difference equation has the form: α_j v_{j−1}^ℓ + β_j v_j^ℓ + γ_j v_{j+1}^ℓ = v_j^{ℓ+1}, and find α_j, β_j, γ_j.\n   B) What are the discrete “initial” conditions?\n   C) What are the discrete boundary conditions?\niv) Equation (4) has the form: A v^ℓ + b = v^{ℓ+1}, where v^ℓ = (v_1^ℓ, ..., v_n^ℓ)^T and b = (0, ..., 0, γ_n(B − X))^T.\n a) Define the entries a_{i,j} of matrix A = (a_{i,j}). What structure does A have?\n b) Is the matrix A sparse? Calculate its sparsity.\n c) How can the structure of the matrix A be exploited to make time\u0002stepping as efficient as possible?\n d)Provide an estimation of the number of flops needed to compute the vector v^8.",
    "steps": [
      {
        "step": 1,
        "desc": "Define the structure of matrix A based on the finite difference method.",
        "expr": "A = tridiagonal(α_j, β_j, γ_j)",
        "value": null
      },
      {
        "step": 2,
        "desc": "Determine the size of matrix A.",
        "expr": "A is (n x n)",
        "value": null
      },
      {
        "step": 3,
        "desc": "Calculate the number of non-zero elements in a tridiagonal matrix.",
        "expr": "3n - 2",
        "value": null
      },
      {
        "step": 4,
        "desc": "Calculate the total number of elements in matrix A.",
        "expr": "n^2",
        "value": null
      },
      {
        "step": 5,
        "desc": "Calculate the sparsity of matrix A.",
        "expr": "1 - (3n - 2) / n^2",
        "value": null
      },
      {
        "step": "final",
        "desc": "Compute the sparsity of matrix A.",
        "expr": "1 - (3n - 2) / n^2",
        "value": "1 - (3n - 2) / n^2"
      }
    ]
  },
  {
    "qid": "Problemfour",
    "subid": "4ivc",
    "subquestion": "How can the structure of the matrix A be exploited to make time\u0002stepping as efficient as possible?",
    "full_question": "The value V(S, t) of an exotic option on an underlying asset with price S at time t satisfies the Black–Scholes PDE:\n∂V/∂t + rS ∂V/∂S + (1/2)σ²S² ∂²V/∂S² = rV\nfor 0 < S < ∞ and 0 < t < T. We assume r and σ are known positive constants.\n\nConsider pricing an exotic option with barrier B, strike price 0 < X < B and expiry T. If at any time t ∈ [0, T] the price S hits B, the option is exercised for payout B−X. Otherwise, it can only be exercised at t = T for right to buy at X.\ni) Carefully explain what the 'initial' conditions are for this problem.\nii) Carefully explain what the boundary conditions are for this problem.\niii) Set up a grid (S_j, t_ℓ) = (jΔS, ℓΔt) for j = 0,...,n+1 and ℓ = 0,...,m, where ΔS = B/(n+1), Δt = T/m. Let v_j^ℓ ≈ V(S_j, t_ℓ).\na) A) At time t_ℓ and value S_j, give central difference approximations of O(ΔS²) for partial derivatives ∂V/∂S and ∂²V/∂S².\n    B) Give a forward difference approximation of O(Δt) for ∂V/∂t.\nb) We want to use an implicit finite difference method to approximate v_j^ℓ.\n   A) Show that the finite difference equation has the form: α_j v_{j−1}^ℓ + β_j v_j^ℓ + γ_j v_{j+1}^ℓ = v_j^{ℓ+1}, and find α_j, β_j, γ_j.\n   B) What are the discrete “initial” conditions?\n   C) What are the discrete boundary conditions?\niv) Equation (4) has the form: A v^ℓ + b = v^{ℓ+1}, where v^ℓ = (v_1^ℓ, ..., v_n^ℓ)^T and b = (0, ..., 0, γ_n(B − X))^T.\n a) Define the entries a_{i,j} of matrix A = (a_{i,j}). What structure does A have?\n b) Is the matrix A sparse? Calculate its sparsity.\n c) How can the structure of the matrix A be exploited to make time\u0002stepping as efficient as possible?\n d)Provide an estimation of the number of flops needed to compute the vector v^9.",
    "steps": [
      {
        "step": 1,
        "desc": "Identify the structure of matrix A",
        "expr": "A is a tridiagonal matrix",
        "value": null
      },
      {
        "step": 2,
        "desc": "Recognize the advantage of tridiagonal matrices",
        "expr": "Tridiagonal matrices allow for efficient solving of linear systems",
        "value": null
      },
      {
        "step": 3,
        "desc": "Choose an efficient algorithm for solving",
        "expr": "Use the Thomas algorithm (a specialized form of Gaussian elimination)",
        "value": null
      },
      {
        "step": 4,
        "desc": "Estimate the computational complexity",
        "expr": "O(n) operations for solving Ax = b using the Thomas algorithm",
        "value": null
      },
      {
        "step": "final",
        "desc": "Conclude the exploitation of matrix structure",
        "expr": "Use the Thomas algorithm to efficiently perform time-stepping",
        "value": null
      }
    ]
  },
  {
    "qid": "Problemfour",
    "subid": "4ivd",
    "subquestion": "Provide an estimation of the number of flops needed to compute the vector v^0.",
    "full_question": "The value V(S, t) of an exotic option on an underlying asset with price S at time t satisfies the Black–Scholes PDE:\n∂V/∂t + rS ∂V/∂S + (1/2)σ²S² ∂²V/∂S² = rV\nfor 0 < S < ∞ and 0 < t < T. We assume r and σ are known positive constants.\n\nConsider pricing an exotic option with barrier B, strike price 0 < X < B and expiry T. If at any time t ∈ [0, T] the price S hits B, the option is exercised for payout B−X. Otherwise, it can only be exercised at t = T for right to buy at X.\ni) Carefully explain what the 'initial' conditions are for this problem.\nii) Carefully explain what the boundary conditions are for this problem.\niii) Set up a grid (S_j, t_ℓ) = (jΔS, ℓΔt) for j = 0,...,n+1 and ℓ = 0,...,m, where ΔS = B/(n+1), Δt = T/m. Let v_j^ℓ ≈ V(S_j, t_ℓ).\na) A) At time t_ℓ and value S_j, give central difference approximations of O(ΔS²) for partial derivatives ∂V/∂S and ∂²V/∂S².\n    B) Give a forward difference approximation of O(Δt) for ∂V/∂t.\nb) We want to use an implicit finite difference method to approximate v_j^ℓ.\n   A) Show that the finite difference equation has the form: α_j v_{j−1}^ℓ + β_j v_j^ℓ + γ_j v_{j+1}^ℓ = v_j^{ℓ+1}, and find α_j, β_j, γ_j.\n   B) What are the discrete “initial” conditions?\n   C) What are the discrete boundary conditions?\niv) Equation (4) has the form: A v^ℓ + b = v^{ℓ+1}, where v^ℓ = (v_1^ℓ, ..., v_n^ℓ)^T and b = (0, ..., 0, γ_n(B − X))^T.\n a) Define the entries a_{i,j} of matrix A = (a_{i,j}). What structure does A have?\n b) Is the matrix A sparse? Calculate its sparsity.\n c) How can the structure of the matrix A be exploited to make time\u0002stepping as efficient as possible?\n d)Provide an estimation of the number of flops needed to compute the vector v^10.",
    "steps": [
      {
        "step": 1,
        "desc": "Determine the size of the vector v^0",
        "expr": "n",
        "value": "n"
      },
      {
        "step": 2,
        "desc": "Determine the number of non-zero entries per row in matrix A",
        "expr": "3",
        "value": 3
      },
      {
        "step": 3,
        "desc": "Calculate the number of flops for matrix-vector multiplication A * v^0",
        "expr": "2 * 3 * n",
        "value": "6n"
      },
      {
        "step": 4,
        "desc": "Calculate the number of flops for adding vector b to A * v^0",
        "expr": "n",
        "value": "n"
      },
      {
        "step": "final",
        "desc": "Total number of flops to compute v^0",
        "expr": "6n + n",
        "value": "7n"
      }
    ]
  },
  {
    "qid": "Problemone",
    "subid": null,
    "subquestion": "Determine whether the following function h on the region Ω₀ is convex, strictly convex, concave, strictly concave, or neither.\nh(x₁, x₂) = x₁² / x₂,  where  Ω₀ = { (x₁, x₂) ∈ ℝ²  |  x₂ > 0 }",
    "full_question": "Determine whether the following function h on the region Ω₀ is convex, strictly convex, concave, strictly concave, or neither.\nh(x₁, x₂) = x₁² / x₂,  where  Ω₀ = { (x₁, x₂) ∈ ℝ²  |  x₂ > 0 }",
    "steps": [
      {
        "step": 1,
        "desc": "Define the function h(x1, x2)",
        "expr": "h(x1, x2) = x1^2 / x2",
        "value": null
      },
      {
        "step": 2,
        "desc": "Compute the first partial derivative with respect to x1",
        "expr": "∂h/∂x1 = 2x1 / x2",
        "value": null
      },
      {
        "step": 3,
        "desc": "Compute the first partial derivative with respect to x2",
        "expr": "∂h/∂x2 = -x1^2 / x2^2",
        "value": null
      },
      {
        "step": 4,
        "desc": "Compute the second partial derivative with respect to x1",
        "expr": "∂²h/∂x1² = 2 / x2",
        "value": null
      },
      {
        "step": 5,
        "desc": "Compute the second partial derivative with respect to x2",
        "expr": "∂²h/∂x2² = 2x1^2 / x2^3",
        "value": null
      },
      {
        "step": 6,
        "desc": "Compute the mixed partial derivative",
        "expr": "∂²h/∂x1∂x2 = -2x1 / x2^2",
        "value": null
      },
      {
        "step": 7,
        "desc": "Form the Hessian matrix",
        "expr": "H = [[2/x2, -2x1/x2^2], [-2x1/x2^2, 2x1^2/x2^3]]",
        "value": null
      },
      {
        "step": 8,
        "desc": "Compute the determinant of the Hessian matrix",
        "expr": "det(H) = (2/x2)(2x1^2/x2^3) - (-2x1/x2^2)(-2x1/x2^2)",
        "value": null
      },
      {
        "step": 9,
        "desc": "Simplify the determinant expression",
        "expr": "det(H) = (4x1^2/x2^4) - (4x1^2/x2^4)",
        "value": "0"
      },
      {
        "step": 10,
        "desc": "Evaluate the sign of the second derivative ∂²h/∂x1²",
        "expr": "2/x2 > 0 for x2 > 0",
        "value": "positive"
      },
      {
        "step": "final",
        "desc": "Determine the convexity of the function",
        "expr": "h is convex but not strictly convex",
        "value": "convex"
      }
    ]
  },
  {
    "qid": "Problemtwo",
    "subid": "i",
    "subquestion": "i) Find the five stationary points of f on R^2.",
    "full_question": "Consider the problem of optimizing the function\nf(x) = x₁⁴ + 2x₂⁴ + 2x₁²x₂² − 2x₁² − 4x₂² + 2\non ℝ². The gradient and Hessian of f are given respectively by\n∇f(x) = 4 ( x₁(x₁² + x₂² − 1),  x₂(x₁² + 2x₂² − 2) )ᵀ,\n∇²f(x) = 4 × [ [3x₁² + x₂² − 1, 2x₁x₂]; [2x₁x₂, x₁² + 6x₂² − 2] ]\ni) Find the five stationary points of f on R^2.\nii) Identify, as far as possible using Hessian information, the five stationary points of f as (strict) local minimizers, (strict) local maximizers or saddle points, etc.\niii) Does the function f have a global maximizer on R^2? Give reasons for your answer.",
    "steps": [
      {
        "step": 1,
        "desc": "Set the gradient of f to zero to find stationary points",
        "expr": "∇f(x) = (0, 0)",
        "value": null
      },
      {
        "step": 2,
        "desc": "Set the first component of the gradient to zero",
        "expr": "4x₁(x₁² + x₂² - 1) = 0",
        "value": null
      },
      {
        "step": 3,
        "desc": "Solve the equation from step 2",
        "expr": "x₁ = 0 or x₁² + x₂² = 1",
        "value": null
      },
      {
        "step": 4,
        "desc": "Set the second component of the gradient to zero",
        "expr": "4x₂(x₁² + 2x₂² - 2) = 0",
        "value": null
      },
      {
        "step": 5,
        "desc": "Solve the equation from step 4",
        "expr": "x₂ = 0 or x₁² + 2x₂² = 2",
        "value": null
      },
      {
        "step": 6,
        "desc": "Combine solutions from steps 3 and 5",
        "expr": "x₁ = 0 and x₂ = 0",
        "value": "(0, 0)"
      },
      {
        "step": 7,
        "desc": "Combine solutions from steps 3 and 5",
        "expr": "x₁ = 0 and x₁² + 2x₂² = 2",
        "value": "(0, ±√1)"
      },
      {
        "step": 8,
        "desc": "Combine solutions from steps 3 and 5",
        "expr": "x₂ = 0 and x₁² + x₂² = 1",
        "value": "(±1, 0)"
      },
      {
        "step": 9,
        "desc": "Combine solutions from steps 3 and 5",
        "expr": "x₁² + x₂² = 1 and x₁² + 2x₂² = 2",
        "value": "(±√(2/3), ±√(1/3))"
      },
      {
        "step": "final",
        "desc": "List all stationary points",
        "expr": null,
        "value": [
          "(0, 0)",
          "(0, 1)",
          "(0, -1)",
          "(1, 0)",
          "(-1, 0)"
        ]
      }
    ]
  },
  {
    "qid": "Problemtwo",
    "subid": "ii",
    "subquestion": "ii) Identify, as far as possible using Hessian information, the five stationary points of f as (strict) local minimizers, (strict) local maximizers or saddle points, etc.",
    "full_question": "Consider the problem of optimizing the function\nf(x) = x₁⁴ + 2x₂⁴ + 2x₁²x₂² − 2x₁² − 4x₂² + 2\non ℝ². The gradient and Hessian of f are given respectively by\n∇f(x) = 4 ( x₁(x₁² + x₂² − 1),  x₂(x₁² + 2x₂² − 2) )ᵀ,\n∇²f(x) = 4 × [ [3x₁² + x₂² − 1, 2x₁x₂]; [2x₁x₂, x₁² + 6x₂² − 2] ]\ni) Find the five stationary points of f on R^2.\nii) Identify, as far as possible using Hessian information, the five stationary points of f as (strict) local minimizers, (strict) local maximizers or saddle points, etc.\niii) Does the function f have a global maximizer on R^3? Give reasons for your answer.",
    "steps": [
      {
        "step": 1,
        "desc": "List the stationary points found in part (i)",
        "expr": "(0, 0), (1, 0), (-1, 0), (0, 1), (0, -1)",
        "value": null
      },
      {
        "step": 2,
        "desc": "Evaluate the Hessian at (0, 0)",
        "expr": "∇²f(0, 0) = 4 * [[-1, 0], [0, -2]]",
        "value": "[[-4, 0], [0, -8]]"
      },
      {
        "step": 3,
        "desc": "Determine the nature of (0, 0) using eigenvalues",
        "expr": "Eigenvalues of [[-4, 0], [0, -8]]",
        "value": "Both negative, local maximizer"
      },
      {
        "step": 4,
        "desc": "Evaluate the Hessian at (1, 0)",
        "expr": "∇²f(1, 0) = 4 * [[2, 0], [0, -1]]",
        "value": "[[8, 0], [0, -4]]"
      },
      {
        "step": 5,
        "desc": "Determine the nature of (1, 0) using eigenvalues",
        "expr": "Eigenvalues of [[8, 0], [0, -4]]",
        "value": "Mixed signs, saddle point"
      },
      {
        "step": 6,
        "desc": "Evaluate the Hessian at (-1, 0)",
        "expr": "∇²f(-1, 0) = 4 * [[2, 0], [0, -1]]",
        "value": "[[8, 0], [0, -4]]"
      },
      {
        "step": 7,
        "desc": "Determine the nature of (-1, 0) using eigenvalues",
        "expr": "Eigenvalues of [[8, 0], [0, -4]]",
        "value": "Mixed signs, saddle point"
      },
      {
        "step": 8,
        "desc": "Evaluate the Hessian at (0, 1)",
        "expr": "∇²f(0, 1) = 4 * [[0, 0], [0, 4]]",
        "value": "[[0, 0], [0, 16]]"
      },
      {
        "step": 9,
        "desc": "Determine the nature of (0, 1) using eigenvalues",
        "expr": "Eigenvalues of [[0, 0], [0, 16]]",
        "value": "One zero, one positive, saddle point"
      },
      {
        "step": 10,
        "desc": "Evaluate the Hessian at (0, -1)",
        "expr": "∇²f(0, -1) = 4 * [[0, 0], [0, 4]]",
        "value": "[[0, 0], [0, 16]]"
      },
      {
        "step": 11,
        "desc": "Determine the nature of (0, -1) using eigenvalues",
        "expr": "Eigenvalues of [[0, 0], [0, 16]]",
        "value": "One zero, one positive, saddle point"
      },
      {
        "step": "final",
        "desc": "Summarize the nature of each stationary point",
        "expr": null,
        "value": "(0, 0) is a local maximizer; (1, 0) and (-1, 0) are saddle points; (0, 1) and (0, -1) are saddle points"
      }
    ]
  },
  {
    "qid": "Problemtwo",
    "subid": "iii",
    "subquestion": "iii) Does the function f have a global maximizer on R^2? Give reasons for your answer.",
    "full_question": "Consider the problem of optimizing the function\nf(x) = x₁⁴ + 2x₂⁴ + 2x₁²x₂² − 2x₁² − 4x₂² + 2\non ℝ². The gradient and Hessian of f are given respectively by\n∇f(x) = 4 ( x₁(x₁² + x₂² − 1),  x₂(x₁² + 2x₂² − 2) )ᵀ,\n∇²f(x) = 4 × [ [3x₁² + x₂² − 1, 2x₁x₂]; [2x₁x₂, x₁² + 6x₂² − 2] ]\ni) Find the five stationary points of f on R^2.\nii) Identify, as far as possible using Hessian information, the five stationary points of f as (strict) local minimizers, (strict) local maximizers or saddle points, etc.\niii) Does the function f have a global maximizer on R^4? Give reasons for your answer.",
    "steps": [
      {
        "step": 1,
        "desc": "Analyze the behavior of f(x) as x approaches infinity",
        "expr": "f(x) = x₁⁴ + 2x₂⁴ + 2x₁²x₂² − 2x₁² − 4x₂² + 2",
        "value": "As x₁ or x₂ approaches infinity, f(x) approaches infinity"
      },
      {
        "step": 2,
        "desc": "Check if f(x) is bounded above",
        "expr": "f(x) = x₁⁴ + 2x₂⁴ + 2x₁²x₂² − 2x₁² − 4x₂² + 2",
        "value": "f(x) is not bounded above"
      },
      {
        "step": "final",
        "desc": "Conclude about the existence of a global maximizer",
        "expr": "f(x) does not have a global maximizer on R²",
        "value": "No global maximizer"
      }
    ]
  },
  {
    "qid": "Problemthree",
    "subid": null,
    "subquestion": "Let A be a real (n × n) square matrix. Let a_ii and a_jj be the iᵗʰ and jᵗʰ diagonal elements of A respectively, where i, j ∈ {1, ..., n} and i ≠ j.\nUsing the definition of an indefinite matrix, show that if a_ii a_jj < 0, then A is indefinite.",
    "full_question": "Let A be a real (n × n) square matrix. Let a_ii and a_jj be the iᵗʰ and jᵗʰ diagonal elements of A respectively, where i, j ∈ {1, ..., n} and i ≠ j.\nUsing the definition of an indefinite matrix, show that if a_ii a_jj < 0, then A is indefinite.",
    "steps": [
      {
        "step": 1,
        "desc": "Define an indefinite matrix",
        "expr": "A is indefinite if there exist vectors x such that x^T A x > 0 and y such that y^T A y < 0",
        "value": null
      },
      {
        "step": 2,
        "desc": "Consider a 2x2 principal submatrix of A",
        "expr": "B = [[a_ii, a_ij], [a_ji, a_jj]]",
        "value": null
      },
      {
        "step": 3,
        "desc": "Choose a vector x for the submatrix B",
        "expr": "x = [1, 0]",
        "value": null
      },
      {
        "step": 4,
        "desc": "Compute x^T B x",
        "expr": "x^T B x = a_ii",
        "value": "a_ii"
      },
      {
        "step": 5,
        "desc": "Choose another vector y for the submatrix B",
        "expr": "y = [0, 1]",
        "value": null
      },
      {
        "step": 6,
        "desc": "Compute y^T B y",
        "expr": "y^T B y = a_jj",
        "value": "a_jj"
      },
      {
        "step": 7,
        "desc": "Check the signs of x^T B x and y^T B y",
        "expr": "a_ii > 0 and a_jj < 0 or a_ii < 0 and a_jj > 0",
        "value": null
      },
      {
        "step": 8,
        "desc": "Conclude that B is indefinite",
        "expr": "B is indefinite because it has both positive and negative quadratic forms",
        "value": null
      },
      {
        "step": "final",
        "desc": "Conclude that A is indefinite",
        "expr": "A is indefinite because it has an indefinite principal submatrix B",
        "value": null
      }
    ]
  },
  {
    "qid": "Problemfour",
    "subid": null,
    "subquestion": "Let C be an m × n matrix, d ∈ ℝᵐ, a ∈ ℝⁿ and r ∈ ℝ. Show that\nΩ = { x ∈ ℝⁿ :  ‖Cx − d‖ ≤ aᵀx + r }\nis a convex set for any norm ‖·‖ on ℝᵐ.\nState any properties of a norm that you use.",
    "full_question": "Let C be an m × n matrix, d ∈ ℝᵐ, a ∈ ℝⁿ and r ∈ ℝ. Show that\nΩ = { x ∈ ℝⁿ :  ‖Cx − d‖ ≤ aᵀx + r }\nis a convex set for any norm ‖·‖ on ℝᵐ.\nState any properties of a norm that you use.",
    "steps": [
      {
        "step": 1,
        "desc": "Define the set Ω and the condition for convexity",
        "expr": "Ω = { x ∈ ℝⁿ : ‖Cx − d‖ ≤ aᵀx + r }",
        "value": "Convex if ∀ x₁, x₂ ∈ Ω, ∀ θ ∈ [0, 1], θx₁ + (1-θ)x₂ ∈ Ω"
      },
      {
        "step": 2,
        "desc": "Assume x₁, x₂ ∈ Ω and θ ∈ [0, 1]",
        "expr": "x₁, x₂ ∈ Ω, θ ∈ [0, 1]",
        "value": null
      },
      {
        "step": 3,
        "desc": "Express the condition for x₁ and x₂ being in Ω",
        "expr": "‖Cx₁ − d‖ ≤ aᵀx₁ + r, ‖Cx₂ − d‖ ≤ aᵀx₂ + r",
        "value": null
      },
      {
        "step": 4,
        "desc": "Consider the point θx₁ + (1-θ)x₂",
        "expr": "y = θx₁ + (1-θ)x₂",
        "value": null
      },
      {
        "step": 5,
        "desc": "Apply the triangle inequality property of norms",
        "expr": "‖C(θx₁ + (1-θ)x₂) − d‖ ≤ θ‖Cx₁ − d‖ + (1-θ)‖Cx₂ − d‖",
        "value": null
      },
      {
        "step": 6,
        "desc": "Use the linearity of the inner product",
        "expr": "aᵀ(θx₁ + (1-θ)x₂) = θaᵀx₁ + (1-θ)aᵀx₂",
        "value": null
      },
      {
        "step": 7,
        "desc": "Combine inequalities to show y ∈ Ω",
        "expr": "‖C(θx₁ + (1-θ)x₂) − d‖ ≤ θ(aᵀx₁ + r) + (1-θ)(aᵀx₂ + r)",
        "value": null
      },
      {
        "step": 8,
        "desc": "Simplify the right-hand side",
        "expr": "θaᵀx₁ + (1-θ)aᵀx₂ + r",
        "value": null
      },
      {
        "step": "final",
        "desc": "Conclude that Ω is convex",
        "expr": "θx₁ + (1-θ)x₂ ∈ Ω",
        "value": "Ω is convex"
      }
    ]
  },
  {
    "qid": "Problemone",
    "subid": "i",
    "subquestion": "(i) Calculate the Newton direction s^(1) for h at x^(1).",
    "full_question": "Consider applying the basic Newton method to minimise the function\nh(x₁, x₂) = x₁² + x₂² − x₁x₂ + 3x₂ − 1 on ℝ²,\nstarting from the point x^(1) = (1, 1)ᵀ.\n\n(i) Calculate the Newton direction s^(1) for h at x^(1).\n(ii) Is the Newton direction s^(1) a descent direction for h at x^(1)? Give reasons.\n(iii) Find the next Newton iterate x^(2).\n(iv) Show that x^(2) is the unique global minimiser for h.",
    "steps": [
      {
        "step": 1,
        "desc": "Compute the gradient of h(x₁, x₂)",
        "expr": "∇h(x₁, x₂) = (2x₁ - x₂, 2x₂ - x₁ + 3)",
        "value": null
      },
      {
        "step": 2,
        "desc": "Evaluate the gradient at x^(1) = (1, 1)ᵀ",
        "expr": "∇h(1, 1) = (2*1 - 1, 2*1 - 1 + 3)",
        "value": "(1, 4)"
      },
      {
        "step": 3,
        "desc": "Compute the Hessian matrix of h(x₁, x₂)",
        "expr": "H(x₁, x₂) = [[2, -1], [-1, 2]]",
        "value": null
      },
      {
        "step": 4,
        "desc": "Evaluate the Hessian at x^(1) = (1, 1)ᵀ",
        "expr": "H(1, 1) = [[2, -1], [-1, 2]]",
        "value": "[[2, -1], [-1, 2]]"
      },
      {
        "step": 5,
        "desc": "Compute the Newton direction s^(1)",
        "expr": "s^(1) = -H(1, 1)⁻¹ * ∇h(1, 1)",
        "value": null
      },
      {
        "step": 6,
        "desc": "Calculate the inverse of the Hessian matrix",
        "expr": "H(1, 1)⁻¹ = 1/(2*2 - (-1)(-1)) * [[2, 1], [1, 2]]",
        "value": "[[2/3, 1/3], [1/3, 2/3]]"
      },
      {
        "step": 7,
        "desc": "Compute the product of the inverse Hessian and the gradient",
        "expr": "s^(1) = -[[2/3, 1/3], [1/3, 2/3]] * [1, 4]",
        "value": "[-2, -3]"
      },
      {
        "step": "final",
        "desc": "The Newton direction s^(1) for h at x^(1)",
        "expr": "s^(1)",
        "value": "[-2, -3]"
      }
    ]
  },
  {
    "qid": "Problemone",
    "subid": "ii",
    "subquestion": "(ii) Is the Newton direction s^(1) a descent direction for h at x^(1)? Give reasons.",
    "full_question": "Consider applying the basic Newton method to minimise the function\nh(x₁, x₂) = x₁² + x₂² − x₁x₂ + 3x₂ − 1 on ℝ²,\nstarting from the point x^(1) = (1, 1)ᵀ.\n\n(i) Calculate the Newton direction s^(1) for h at x^(1).\n(ii) Is the Newton direction s^(1) a descent direction for h at x^(1)? Give reasons.\n(iii) Find the next Newton iterate x^(2).\n(iv) Show that x^(3) is the unique global minimiser for h.",
    "steps": [
      {
        "step": 1,
        "desc": "Calculate the gradient of h at x^(1)",
        "expr": "∇h(x) = (2x₁ - x₂, 2x₂ - x₁ + 3)",
        "value": "(1, 4)"
      },
      {
        "step": 2,
        "desc": "Calculate the Hessian matrix of h",
        "expr": "H = [[2, -1], [-1, 2]]",
        "value": "[[2, -1], [-1, 2]]"
      },
      {
        "step": 3,
        "desc": "Calculate the Newton direction s^(1)",
        "expr": "s^(1) = -H^(-1) * ∇h(x^(1))",
        "value": "(-1, -1)"
      },
      {
        "step": 4,
        "desc": "Check if s^(1) is a descent direction",
        "expr": "∇h(x^(1)) ⋅ s^(1)",
        "value": "-5"
      },
      {
        "step": "final",
        "desc": "Determine if s^(1) is a descent direction",
        "expr": "∇h(x^(1)) ⋅ s^(1) < 0",
        "value": "True"
      }
    ]
  },
  {
    "qid": "Problemone",
    "subid": "iii",
    "subquestion": "(iii) Find the next Newton iterate x^(2).",
    "full_question": "Consider applying the basic Newton method to minimise the function\nh(x₁, x₂) = x₁² + x₂² − x₁x₂ + 3x₂ − 1 on ℝ²,\nstarting from the point x^(1) = (1, 1)ᵀ.\n\n(i) Calculate the Newton direction s^(1) for h at x^(1).\n(ii) Is the Newton direction s^(1) a descent direction for h at x^(1)? Give reasons.\n(iii) Find the next Newton iterate x^(2).\n(iv) Show that x^(4) is the unique global minimiser for h.",
    "steps": [
      {
        "step": 1,
        "desc": "Calculate the gradient of h at x^(1)",
        "expr": "∇h(x) = (2x₁ - x₂, 2x₂ - x₁ + 3)",
        "value": "(1, 4)"
      },
      {
        "step": 2,
        "desc": "Calculate the Hessian matrix of h",
        "expr": "H(x) = [[2, -1], [-1, 2]]",
        "value": "[[2, -1], [-1, 2]]"
      },
      {
        "step": 3,
        "desc": "Calculate the Newton direction s^(1)",
        "expr": "s^(1) = -H(x^(1))^(-1) * ∇h(x^(1))",
        "value": "(-1, -1)"
      },
      {
        "step": 4,
        "desc": "Calculate the next Newton iterate x^(2)",
        "expr": "x^(2) = x^(1) + s^(1)",
        "value": "(0, 0)"
      },
      {
        "step": "final",
        "desc": "The next Newton iterate x^(2)",
        "expr": "x^(2)",
        "value": "(0, 0)"
      }
    ]
  },
  {
    "qid": "Problemone",
    "subid": "iv",
    "subquestion": "(iv) Show that x^(2) is the unique global minimiser for h.",
    "full_question": "Consider applying the basic Newton method to minimise the function\nh(x₁, x₂) = x₁² + x₂² − x₁x₂ + 3x₂ − 1 on ℝ²,\nstarting from the point x^(1) = (1, 1)ᵀ.\n\n(i) Calculate the Newton direction s^(1) for h at x^(1).\n(ii) Is the Newton direction s^(1) a descent direction for h at x^(1)? Give reasons.\n(iii) Find the next Newton iterate x^(2).\n(iv) Show that x^(5) is the unique global minimiser for h.",
    "steps": [
      {
        "step": 1,
        "desc": "Calculate the gradient of h(x₁, x₂)",
        "expr": "∇h(x₁, x₂) = (2x₁ - x₂, 2x₂ - x₁ + 3)",
        "value": null
      },
      {
        "step": 2,
        "desc": "Calculate the Hessian matrix of h(x₁, x₂)",
        "expr": "H = [[2, -1], [-1, 2]]",
        "value": null
      },
      {
        "step": 3,
        "desc": "Set the gradient to zero to find critical points",
        "expr": "2x₁ - x₂ = 0, 2x₂ - x₁ + 3 = 0",
        "value": null
      },
      {
        "step": 4,
        "desc": "Solve the system of equations for critical points",
        "expr": "x₁ = 1, x₂ = -1",
        "value": "(1, -1)"
      },
      {
        "step": 5,
        "desc": "Evaluate the Hessian at the critical point",
        "expr": "H = [[2, -1], [-1, 2]]",
        "value": null
      },
      {
        "step": 6,
        "desc": "Check if the Hessian is positive definite",
        "expr": "det(H) = 3, leading principal minors > 0",
        "value": "positive definite"
      },
      {
        "step": "final",
        "desc": "Conclude that the critical point is a global minimiser",
        "expr": "x^(2) = (1, -1)",
        "value": "unique global minimiser"
      }
    ]
  },
  {
    "qid": "Problemtwo",
    "subid": null,
    "subquestion": "Consider the equality constrained optimization problem (P₁):\n    min_{x ∈ ℝ³} −x₁x₂x₃\n    s.t. x₁ + x₂ + x₃ − 40 = 0,\n         x₁ + x₂ − x₃ = 0.\n\nIt is given that x* = (10, 10, 20)ᵀ is a regular constrained stationary point for (P₁)\nwith Lagrange multipliers λ₁* = 150 and λ₂* = 50.\n\nUsing second-order sufficient optimality conditions, determine whether x* is a strict local minimiser.",
    "full_question": "Consider the equality constrained optimization problem (P₁):\n    min_{x ∈ ℝ³} −x₁x₂x₃\n    s.t. x₁ + x₂ + x₃ − 40 = 0,\n         x₁ + x₂ − x₃ = 0.\n\nIt is given that x* = (10, 10, 20)ᵀ is a regular constrained stationary point for (P₁)\nwith Lagrange multipliers λ₁* = 150 and λ₂* = 50.\n\nUsing second-order sufficient optimality conditions, determine whether x* is a strict local minimiser.",
    "steps": [
      {
        "step": 1,
        "desc": "Define the Lagrangian function L(x, λ)",
        "expr": "L(x, λ) = -x1*x2*x3 + λ1*(x1 + x2 + x3 - 40) + λ2*(x1 + x2 - x3)",
        "value": null
      },
      {
        "step": 2,
        "desc": "Compute the gradient of the Lagrangian with respect to x",
        "expr": "∇xL = (-(x2*x3) + λ1 + λ2, -(x1*x3) + λ1 + λ2, -(x1*x2) + λ1 - λ2)",
        "value": null
      },
      {
        "step": 3,
        "desc": "Evaluate the gradient at x* and λ*",
        "expr": "∇xL(x*, λ*) = (-(10*20) + 150 + 50, -(10*20) + 150 + 50, -(10*10) + 150 - 50)",
        "value": "(0, 0, 0)"
      },
      {
        "step": 4,
        "desc": "Compute the Hessian of the Lagrangian with respect to x",
        "expr": "∇²xxL = [[0, -x3, -x2], [-x3, 0, -x1], [-x2, -x1, 0]]",
        "value": null
      },
      {
        "step": 5,
        "desc": "Evaluate the Hessian at x*",
        "expr": "∇²xxL(x*) = [[0, -20, -10], [-20, 0, -10], [-10, -10, 0]]",
        "value": "[[0, -20, -10], [-20, 0, -10], [-10, -10, 0]]"
      },
      {
        "step": 6,
        "desc": "Define the constraint gradients",
        "expr": "∇g1 = (1, 1, 1), ∇g2 = (1, 1, -1)",
        "value": null
      },
      {
        "step": 7,
        "desc": "Form the matrix of constraint gradients",
        "expr": "A = [[1, 1, 1], [1, 1, -1]]",
        "value": "[[1, 1, 1], [1, 1, -1]]"
      },
      {
        "step": 8,
        "desc": "Compute the null space of A",
        "expr": "Z = null space of A",
        "value": "[[1, -1, 0], [0, 1, -1]]"
      },
      {
        "step": 9,
        "desc": "Compute the reduced Hessian Z^T * ∇²xxL * Z",
        "expr": "Z^T * ∇²xxL * Z",
        "value": "[[-20, 10], [10, -20]]"
      },
      {
        "step": 10,
        "desc": "Check positive definiteness of the reduced Hessian",
        "expr": "Eigenvalues of [[-20, 10], [10, -20]]",
        "value": "[-30, -10]"
      },
      {
        "step": "final",
        "desc": "Determine if x* is a strict local minimizer",
        "expr": "Since the reduced Hessian is not positive definite, x* is not a strict local minimizer.",
        "value": "x* is not a strict local minimizer"
      }
    ]
  },
  {
    "qid": "Problemthree",
    "subid": "i",
    "subquestion": "(i) Find a constrained stationary point z* of the problem (P₂).",
    "full_question": "Consider the convex optimization problem (P₂):\n    min_{x ∈ ℝ²} e^(−2(x₁+x₂))\n    subject to e^{x₁} + e^{x₂} − 4 ≤ 0.\n\n(i) Find a constrained stationary point z* of the problem (P₂).\n(ii) Is z* the only constrained stationary point for (P₂)? Give reasons.\n(iii) Explain why the constrained stationary point z* of part (i) is a global minimizer for the problem (P2).\n(iv) Stating clear reasons, show that z* of part (i) is the unique global minimizer for the problem (P2).",
    "steps": [
      {
        "step": 1,
        "desc": "Define the Lagrangian for the problem",
        "expr": "L(x, λ) = e^(-2(x₁+x₂)) + λ(e^{x₁} + e^{x₂} - 4)",
        "value": null
      },
      {
        "step": 2,
        "desc": "Compute the partial derivative of L with respect to x₁",
        "expr": "∂L/∂x₁ = -2e^(-2(x₁+x₂)) + λe^{x₁}",
        "value": null
      },
      {
        "step": 3,
        "desc": "Compute the partial derivative of L with respect to x₂",
        "expr": "∂L/∂x₂ = -2e^(-2(x₁+x₂)) + λe^{x₂}",
        "value": null
      },
      {
        "step": 4,
        "desc": "Set the partial derivatives to zero for stationarity",
        "expr": "-2e^(-2(x₁+x₂)) + λe^{x₁} = 0",
        "value": null
      },
      {
        "step": 5,
        "desc": "Set the partial derivatives to zero for stationarity",
        "expr": "-2e^(-2(x₁+x₂)) + λe^{x₂} = 0",
        "value": null
      },
      {
        "step": 6,
        "desc": "Solve the system of equations from steps 4 and 5",
        "expr": "λe^{x₁} = λe^{x₂}",
        "value": null
      },
      {
        "step": 7,
        "desc": "Conclude x₁ = x₂ from the system of equations",
        "expr": "x₁ = x₂",
        "value": null
      },
      {
        "step": 8,
        "desc": "Substitute x₁ = x₂ into the constraint",
        "expr": "2e^{x₁} - 4 = 0",
        "value": null
      },
      {
        "step": 9,
        "desc": "Solve for x₁",
        "expr": "e^{x₁} = 2",
        "value": null
      },
      {
        "step": 10,
        "desc": "Find x₁",
        "expr": "x₁ = ln(2)",
        "value": "ln(2)"
      },
      {
        "step": 11,
        "desc": "Find x₂ using x₁ = x₂",
        "expr": "x₂ = ln(2)",
        "value": "ln(2)"
      },
      {
        "step": "final",
        "desc": "Constrained stationary point z*",
        "expr": "z* = (ln(2), ln(2))",
        "value": "(ln(2), ln(2))"
      }
    ]
  },
  {
    "qid": "Problemthree",
    "subid": "ii",
    "subquestion": "(ii) Is z* the only constrained stationary point for (P₂)? Give reasons.",
    "full_question": "Consider the convex optimization problem (P₂):\n    min_{x ∈ ℝ²} e^(−2(x₁+x₂))\n    subject to e^{x₁} + e^{x₂} − 4 ≤ 0.\n\n(i) Find a constrained stationary point z* of the problem (P₂).\n(ii) Is z* the only constrained stationary point for (P₂)? Give reasons.\n(iii) Explain why the constrained stationary point z* of part (i) is a global minimizer for the problem (P2).\n(iv) Stating clear reasons, show that z* of part (i) is the unique global minimizer for the problem (P3).",
    "steps": [
      {
        "step": 1,
        "desc": "Identify the Lagrangian for the problem",
        "expr": "L(x, λ) = e^(-2(x₁+x₂)) + λ(e^{x₁} + e^{x₂} - 4)",
        "value": null
      },
      {
        "step": 2,
        "desc": "Compute the gradient of the Lagrangian with respect to x",
        "expr": "∇x L(x, λ) = [-2e^(-2(x₁+x₂)) + λe^{x₁}, -2e^(-2(x₁+x₂)) + λe^{x₂}]",
        "value": null
      },
      {
        "step": 3,
        "desc": "Set the gradient of the Lagrangian to zero for stationarity",
        "expr": "[-2e^(-2(x₁+x₂)) + λe^{x₁} = 0, -2e^(-2(x₁+x₂)) + λe^{x₂} = 0]",
        "value": null
      },
      {
        "step": 4,
        "desc": "Solve the system of equations for x₁ and x₂",
        "expr": "e^{x₁} = e^{x₂}",
        "value": null
      },
      {
        "step": 5,
        "desc": "Substitute e^{x₁} = e^{x₂} into the constraint",
        "expr": "2e^{x₁} - 4 = 0",
        "value": null
      },
      {
        "step": 6,
        "desc": "Solve for e^{x₁}",
        "expr": "e^{x₁} = 2",
        "value": null
      },
      {
        "step": 7,
        "desc": "Find x₁ and x₂",
        "expr": "x₁ = x₂ = ln(2)",
        "value": null
      },
      {
        "step": 8,
        "desc": "Verify if there are other solutions",
        "expr": "Check if other values satisfy both stationarity and constraint",
        "value": "No other solutions"
      },
      {
        "step": "final",
        "desc": "Conclude that z* is the only constrained stationary point",
        "expr": "z* = (ln(2), ln(2))",
        "value": "Unique constrained stationary point"
      }
    ]
  },
  {
    "qid": "Problemthree",
    "subid": "iii",
    "subquestion": "(iii) Explain why the constrained stationary point z* of part (i) is a global minimizer for the problem (P2).",
    "full_question": "Consider the convex optimization problem (P₂):\n    min_{x ∈ ℝ²} e^(−2(x₁+x₂))\n    subject to e^{x₁} + e^{x₂} − 4 ≤ 0.\n\n(i) Find a constrained stationary point z* of the problem (P₂).\n(ii) Is z* the only constrained stationary point for (P₂)? Give reasons.\n(iii) Explain why the constrained stationary point z* of part (i) is a global minimizer for the problem (P2).\n(iv) Stating clear reasons, show that z* of part (i) is the unique global minimizer for the problem (P4).",
    "steps": [
      {
        "step": 1,
        "desc": "Identify the objective function and constraint",
        "expr": "f(x) = e^{-2(x_1 + x_2)}, g(x) = e^{x_1} + e^{x_2} - 4",
        "value": null
      },
      {
        "step": 2,
        "desc": "Check the convexity of the objective function",
        "expr": "f(x) = e^{-2(x_1 + x_2)}",
        "value": "convex"
      },
      {
        "step": 3,
        "desc": "Check the convexity of the constraint function",
        "expr": "g(x) = e^{x_1} + e^{x_2} - 4",
        "value": "convex"
      },
      {
        "step": 4,
        "desc": "Determine the feasible region",
        "expr": "e^{x_1} + e^{x_2} <= 4",
        "value": "convex set"
      },
      {
        "step": 5,
        "desc": "Use the KKT conditions for optimality",
        "expr": "L(x, \\lambda) = e^{-2(x_1 + x_2)} + \\lambda (e^{x_1} + e^{x_2} - 4)",
        "value": null
      },
      {
        "step": 6,
        "desc": "Find the gradient of the Lagrangian",
        "expr": "∇L = [-2e^{-2(x_1 + x_2)} + \\lambda e^{x_1}, -2e^{-2(x_1 + x_2)} + \\lambda e^{x_2}]",
        "value": null
      },
      {
        "step": 7,
        "desc": "Solve the KKT conditions",
        "expr": "∇L = 0, \\lambda (e^{x_1} + e^{x_2} - 4) = 0, \\lambda >= 0",
        "value": "x_1 = x_2 = \\ln(2), \\lambda = 2e^{-2\\ln(2)}"
      },
      {
        "step": 8,
        "desc": "Verify the solution satisfies the constraint",
        "expr": "e^{x_1} + e^{x_2} = 2 + 2 = 4",
        "value": "satisfied"
      },
      {
        "step": "final",
        "desc": "Conclude that z* is a global minimizer",
        "expr": "z* = (\\ln(2), \\ln(2))",
        "value": "global minimizer"
      }
    ]
  },
  {
    "qid": "Problemthree",
    "subid": "iv",
    "subquestion": "(iv) Stating clear reasons, show that z* of part (i) is the unique global minimizer for the problem (P2).",
    "full_question": "Consider the convex optimization problem (P₂):\n    min_{x ∈ ℝ²} e^(−2(x₁+x₂))\n    subject to e^{x₁} + e^{x₂} − 4 ≤ 0.\n\n(i) Find a constrained stationary point z* of the problem (P₂).\n(ii) Is z* the only constrained stationary point for (P₂)? Give reasons.\n(iii) Explain why the constrained stationary point z* of part (i) is a global minimizer for the problem (P2).\n(iv) Stating clear reasons, show that z* of part (i) is the unique global minimizer for the problem (P5).",
    "steps": [
      {
        "step": 1,
        "desc": "Identify the objective function and constraint",
        "expr": "f(x) = e^{-2(x_1 + x_2)}, g(x) = e^{x_1} + e^{x_2} - 4",
        "value": null
      },
      {
        "step": 2,
        "desc": "Determine the feasible region defined by the constraint",
        "expr": "e^{x_1} + e^{x_2} <= 4",
        "value": null
      },
      {
        "step": 3,
        "desc": "Find the Lagrangian for the problem",
        "expr": "L(x, \\lambda) = e^{-2(x_1 + x_2)} + \\lambda (e^{x_1} + e^{x_2} - 4)",
        "value": null
      },
      {
        "step": 4,
        "desc": "Compute the gradient of the Lagrangian",
        "expr": "\\nabla L = (-2e^{-2(x_1 + x_2)} + \\lambda e^{x_1}, -2e^{-2(x_1 + x_2)} + \\lambda e^{x_2})",
        "value": null
      },
      {
        "step": 5,
        "desc": "Set the gradient of the Lagrangian to zero for stationarity",
        "expr": "-2e^{-2(x_1 + x_2)} + \\lambda e^{x_1} = 0, -2e^{-2(x_1 + x_2)} + \\lambda e^{x_2} = 0",
        "value": null
      },
      {
        "step": 6,
        "desc": "Solve the system of equations for x_1 and x_2",
        "expr": "e^{x_1} = e^{x_2}",
        "value": null
      },
      {
        "step": 7,
        "desc": "Use the constraint to find x_1 and x_2",
        "expr": "2e^{x_1} = 4",
        "value": null
      },
      {
        "step": 8,
        "desc": "Solve for x_1 and x_2",
        "expr": "x_1 = x_2 = \\ln(2)",
        "value": null
      },
      {
        "step": 9,
        "desc": "Verify that the point satisfies the KKT conditions",
        "expr": "x_1 = x_2 = \\ln(2), \\lambda = 2e^{-2(\\ln(2) + \\ln(2))} / e^{\\ln(2)}",
        "value": null
      },
      {
        "step": 10,
        "desc": "Check the second-order conditions for a minimum",
        "expr": "Hessian of L is positive semidefinite",
        "value": null
      },
      {
        "step": 11,
        "desc": "Conclude that z* is a global minimizer",
        "expr": "z* = (\\ln(2), \\ln(2))",
        "value": null
      },
      {
        "step": "final",
        "desc": "Conclude uniqueness due to convexity of the problem",
        "expr": "z* is the unique global minimizer",
        "value": null
      }
    ]
  }
]